<!doctype html>
<html lang="zh-TW" dir="ltr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.17">
<link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="OUCH1978@GITHUB RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="OUCH1978@GITHUB Atom Feed">
<link rel="preconnect" href="https://www.google-analytics.com">
<script>window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)},ga.l=+new Date,ga("create","UA-20523508-2","auto"),ga("set","anonymizeIp",!0),ga("send","pageview")</script>
<script async src="https://www.google-analytics.com/analytics.js"></script>
<link rel="search" type="application/opensearchdescription+xml" title="OUCH1978@GITHUB" href="/opensearch.xml">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.13.11/dist/katex.min.css" integrity="sha384-Um5gpz1odJg5Z4HAmzPtgZKdTBHZdw8S29IecapCSB31ligYPhHQZMIlWLYQGVoc" crossorigin="anonymous">
<link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@100;300;400;500;700;900&amp;display=swap" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/pangu/4.0.7/pangu.min.js" async></script>
<script src="/assets/enablePangu.js" async></script><title data-rh="true">透過 Visual Studio 2017 與 Appium 測試安卓手機上的行動版網頁 | OUCH1978@GITHUB</title><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://ouch1978.github.io/blog/2017-04-17-mobile-web-automation-testing-with-vs2017-and-appium"><meta data-rh="true" name="docusaurus_locale" content="zh-TW"><meta data-rh="true" name="docusaurus_tag" content="default"><meta data-rh="true" name="docsearch:language" content="zh-TW"><meta data-rh="true" name="docsearch:docusaurus_tag" content="default"><meta data-rh="true" property="og:title" content="透過 Visual Studio 2017 與 Appium 測試安卓手機上的行動版網頁 | OUCH1978@GITHUB"><meta data-rh="true" name="description" content="前言"><meta data-rh="true" property="og:description" content="前言"><meta data-rh="true" property="og:type" content="article"><meta data-rh="true" property="article:published_time" content="2017-04-17T00:00:00.000Z"><meta data-rh="true" property="article:author" content="https://github.com/ouch1978"><meta data-rh="true" property="article:tag" content="Visual Studio 2017,Automation Testing"><link data-rh="true" rel="icon" href="/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://ouch1978.github.io/blog/2017-04-17-mobile-web-automation-testing-with-vs2017-and-appium"><link data-rh="true" rel="alternate" href="https://ouch1978.github.io/blog/2017-04-17-mobile-web-automation-testing-with-vs2017-and-appium" hreflang="zh-TW"><link data-rh="true" rel="alternate" href="https://ouch1978.github.io/blog/2017-04-17-mobile-web-automation-testing-with-vs2017-and-appium" hreflang="x-default"><link data-rh="true" rel="preconnect" href="https://AG6O0X1DB7-dsn.algolia.net" crossorigin="anonymous"><link rel="stylesheet" href="/assets/css/styles.b68ec71b.css">
<link rel="preload" href="/assets/js/runtime~main.4df91c81.js" as="script">
<link rel="preload" href="/assets/js/main.60653464.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div role="region"><a href="#" class="skipToContent_ZgBM">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/logo.png" alt="Site Logo" class="themedImage_W2Cr themedImage--light_TfLj"><img src="/img/logo.png" alt="Site Logo" class="themedImage_W2Cr themedImage--dark_oUvU"></div><b class="navbar__title">OUCH1978@GITHUB</b></a><a class="navbar__item navbar__link" href="/docs/intro/docs-intro">文件庫</a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/blog">部落格</a></div><div class="navbar__items navbar__items--right"><a href="/slides" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">投影片</a><div class="toggle_S7eR toggle_TdHA toggleDisabled_f9M3"><div class="toggleButton_rCf9" role="button" tabindex="-1"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_v35p"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_nQuB"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></div><input type="checkbox" class="toggleScreenReader_g2nN" aria-label="Switch between dark and light mode (currently light mode)"></div><div class="searchBox_qEbK"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"></span></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper blog-wrapper blog-post-page"><div class="container margin-vert--lg"><div class="row"><main class="col col--9 col--offset-1" itemscope="" itemtype="http://schema.org/Blog"><div class="sc-gsDKAQ kqZFtN"><div class="row" style="margin:0px"><div class="col col--12 article__details"><article><header><h1 class="blogPostTitle_uMeh" itemprop="headline">透過 Visual Studio 2017 與 Appium 測試安卓手機上的行動版網頁</h1><div class="margin-top--md margin-bottom--sm row"><div class="col col--6 authorCol_FlmR"><div class="avatar margin-bottom--sm"><span class="avatar__photo-link avatar__photo"><a href="https://github.com/ouch1978" target="_blank" rel="noopener noreferrer"><img class="image_o0gy" src="https://avatars.githubusercontent.com/u/18132883?v=4" alt="Ouch Liu"></a></span><div class="avatar__intro" itemprop="author" itemscope="" itemtype="https://schema.org/Person"><div class="avatar__name"><a href="https://github.com/ouch1978" target="_blank" rel="noopener noreferrer" itemprop="url"><span itemprop="name">Ouch Liu</span></a></div><small class="avatar__subtitle" itemprop="description">不務正業的工程師</small></div></div></div></div></header><p class="single-post--date text--center"><svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="calendar-plus" class="svg-inline--fa fa-calendar-plus margin-right--md" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path fill="currentColor" d="M96 32C96 14.33 110.3 0 128 0C145.7 0 160 14.33 160 32V64H288V32C288 14.33 302.3 0 320 0C337.7 0 352 14.33 352 32V64H400C426.5 64 448 85.49 448 112V160H0V112C0 85.49 21.49 64 48 64H96V32zM448 464C448 490.5 426.5 512 400 512H48C21.49 512 0 490.5 0 464V192H448V464zM200 272V328H144C130.7 328 120 338.7 120 352C120 365.3 130.7 376 144 376H200V432C200 445.3 210.7 456 224 456C237.3 456 248 445.3 248 432V376H304C317.3 376 328 365.3 328 352C328 338.7 317.3 328 304 328H248V272C248 258.7 237.3 248 224 248C210.7 248 200 258.7 200 272z"></path></svg><time datetime="2017-04-17T00:00:00.000Z" itemprop="datePublished">2017年4月17日</time><br><br><svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="clock" class="svg-inline--fa fa-clock margin-right--md" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M256 512C114.6 512 0 397.4 0 256C0 114.6 114.6 0 256 0C397.4 0 512 114.6 512 256C512 397.4 397.4 512 256 512zM232 256C232 264 236 271.5 242.7 275.1L338.7 339.1C349.7 347.3 364.6 344.3 371.1 333.3C379.3 322.3 376.3 307.4 365.3 300L280 243.2V120C280 106.7 269.3 96 255.1 96C242.7 96 231.1 106.7 231.1 120L232 256z"></path></svg>預估閱讀時間： 9 分鐘</p><div class="text--center margin-bottom--xs padding-bottom--xs"><div class="post__tags-container margin-bottom--md"><svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="tags" class="svg-inline--fa fa-tags margin-right--md" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M472.8 168.4C525.1 221.4 525.1 306.6 472.8 359.6L360.8 472.9C351.5 482.3 336.3 482.4 326.9 473.1C317.4 463.8 317.4 448.6 326.7 439.1L438.6 325.9C472.5 291.6 472.5 236.4 438.6 202.1L310.9 72.87C301.5 63.44 301.6 48.25 311.1 38.93C320.5 29.61 335.7 29.7 344.1 39.13L472.8 168.4zM.0003 229.5V80C.0003 53.49 21.49 32 48 32H197.5C214.5 32 230.7 38.74 242.7 50.75L410.7 218.7C435.7 243.7 435.7 284.3 410.7 309.3L277.3 442.7C252.3 467.7 211.7 467.7 186.7 442.7L18.75 274.7C6.743 262.7 0 246.5 0 229.5L.0003 229.5zM112 112C94.33 112 80 126.3 80 144C80 161.7 94.33 176 112 176C129.7 176 144 161.7 144 144C144 126.3 129.7 112 112 112z"></path></svg><a class="post__tags margin-right--sm" style="font-size:0.75em;font-weight:500" href="/blog/tags/visual-studio-2017">Visual Studio 2017</a><a class="post__tags margin-horiz--sm" style="font-size:0.75em;font-weight:500" href="/blog/tags/automation-testing">Automation Testing</a></div></div><section class="sc-bdvvtL bPJbvM markdown"><h2 class="anchor anchorWithStickyNavbar_mojV" id="前言">前言<a class="hash-link" href="#前言" title="Direct link to heading">​</a></h2><p>在開發行動版網站的過程中，測試仍然是很重要的一環，但是基於需要測試的裝置種類繁多，所以往往讓人又愛又怕受傷害。</p><p>雖然說，可以透過 Selemium 搭配 Chrome 進行對不同裝置的自動化測試，但是，支援的裝置種類仍然有限，而且直接透過 Chrome 進行模擬，真實度也和真的在手機上進行測試有不小的差距。</p><p>另外，以企業的解決方案這個角度來看，如果能透過一個標準化的框架，使用大部份開發者原本就熟悉的工具及程式語言，就可以同時滿足行動裝置網站與原生 App 的測試，那就更有價值了。</p><p>在和 <a href="http://blackie1019.github.io/" target="_blank" rel="noopener noreferrer" title="強者我同事 - 小黑">強者我同事 - 小黑</a> 討論行動裝置上的網站和原生 App 測試相關的解決方案的時候，他提到了 Appium 這個測試框架。</p><blockquote><p>簡單來說，Appium 就是給行動裝置使用的 Selenium。</p></blockquote><p>基於上述幾個原因，我想試看看 Appium 是不是真的和 Selenium 之間的學習曲線是不是真的如其它人所說的那麼平緩。</p><p>附帶一提，Appium 的運作架構如下：</p><p><img loading="lazy" alt="image-00" src="/assets/images/00-the-architecture-of-appium-811a2bb80f9a5bcf6e11d6326b94c05b.png" title="Appium 的運作架構" width="1280" height="720"></p><h2 class="anchor anchorWithStickyNavbar_mojV" id="環境準備">環境準備<a class="hash-link" href="#環境準備" title="Direct link to heading">​</a></h2><p>在我們動手開始寫程式之前，得要先確認下列項目都已經安裝/設定好：</p><ul><li><p>安裝 Visual Studio 2017 的行動裝置相關開發功能(這樣才能使用 VS2017 附的安卓模擬器)</p></li><li><p>安裝 <a href="https://github.com/appium/appium-desktop/releases/latest" target="_blank" rel="noopener noreferrer" title="下載 Appium">Appium</a></p></li><li><p>安裝 <a href="https://github.com/appium/appium-desktop/releases/latest" target="_blank" rel="noopener noreferrer" title="下載 Java SDK">Java SDK</a></p></li><li><p>在 Windows 的系統變數中加入 <code>ANDROID_HOME</code>，並且將它指到 Android SDK 的安裝路徑(預設為 C:\Program Files (x86)\Android\android-sdk)</p></li><li><p>在 Windows 的系統變數中加入 <code>JAVA_HOME</code> ，並且並將它指定到 Java SDK 的 bin 資料夾</p><p><img loading="lazy" alt="image-01" src="/assets/images/01-set-android-home-and-java-home-29a0903914d2c23883db9eeab3bbbc14.png" title="設定 JAVA_HOME 路徑" width="618" height="585"></p></li><li><p>在 Windows 系統變數中的 Path 項目中加上以下幾個路徑：</p><ul><li><p>%JAVA_HOME%</p></li><li><p>%ANDROID_HOME%</p></li><li><p>%ANDROID_HOME%\tools\</p></li><li><p>%ANDROID_HOME%\platform-tools\</p><p><img loading="lazy" alt="image-02" src="/assets/images/02-add-paths-16a54cc265fbbe3e7031f1452c3e3f64.png" title="設定 Path 中的路徑" width="527" height="501"></p></li></ul></li></ul><h2 class="anchor anchorWithStickyNavbar_mojV" id="android-模擬器設定">Android 模擬器設定<a class="hash-link" href="#android-模擬器設定" title="Direct link to heading">​</a></h2><p>透過 VS 開發最大的好處就是可以在 VS 裡面管理所有相關的功能，包含 Android SDK 和模擬器。
安裝好 VS 之後，不妨先透過 Android SDK Manager (Tools -&gt; Android -&gt; Android SDK Manager...)來更新 Android SDK 到最新的版本。</p><p>另外，如果你使用 Intel 的 CPU 的話，也建議針對 Android 4.4.2 安裝 <code>Google APIs Intel x86 Atom System Image</code>，並且安裝 <a href="https://software.intel.com/en-us/android/articles/intel-hardware-accelerated-execution-manager" target="_blank" rel="noopener noreferrer" title="Intel® Hardware Accelerated Execution Manager"><code>Intel® Hardware Accelerated Execution Manager</code></a> 以獲得更好的效能。</p><p><img loading="lazy" alt="image-03" src="/assets/images/03-install-google-apis-intel-x86-atom-system-image-d405ed6ef61ccb6a4983afb9634c4cfc.png" title="安裝Google APIs Intel x86 Atom System Image" width="686" height="493"></p><blockquote><p>若有啟用 Hyper-V 的話，HAXM 可能會和它相衝，這時候可以透過在命令提示字元輸入 <code>bcdedit /set hypervisorlaunchtype off</code> 之後重新開機以關閉 Hyper-V 。</p></blockquote><p>SDK 更新完之後，就可以透過 Tools -&gt; Android -&gt; Android Emulator Manager... 來管理虛擬機囉。在這邊，我選擇修改原來內建的 AVD_GalaxyNexus_ToolsForApacheCordova，並且調整 CPU/ABI 為 <code>Google APIs Intel Atom (x86)</code>、Skin 為 <code>Skin with dynamic hardware controls</code>、勾選 <code>Use Host GPU</code>。</p><p><img loading="lazy" alt="image-04" src="/assets/images/04-edit-android-virtual-device-c6bd892aae0df3a3c71b2b841159023a.png" title="編輯安卓模擬器設定" width="397" height="689"></p><p>設定完成之後，就可以按下 Android Virtual Device (AVD) Manager 裡面的啟動按鈕來開啟模擬器啦~</p><p><img loading="lazy" alt="image-05" src="/assets/images/05-press-start-button-to-launch-android-emulator-dd434f0ad1fccdce833d57cc996442ba.png" title="按下Start鈕啟動模擬器" width="951" height="554"></p><p>如果看到模擬器正常執行，就可以開始動手寫測試程式囉。</p><h2 class="anchor anchorWithStickyNavbar_mojV" id="撰寫自動化測試程式碼">撰寫自動化測試程式碼<a class="hash-link" href="#撰寫自動化測試程式碼" title="Direct link to heading">​</a></h2><p>透過 Visual Studio 2017 建立出 Unit Test 專案之後，首先要作的是透過 NuGet Package Manager 在專案中加入 Appium.WebDriver 的參考。</p><p><img loading="lazy" alt="image-06" src="/assets/images/06-add-appium-webdriver-reference-through-nuget-a36e8b487b1f6c8f888c999584e06918.png" title="透過 NuGet 加入對 Appium 的參考" width="1366" height="738"></p><p>再來就可以開心的寫程式啦!!~</p><p>我的範例程式如下：</p><div class="codeBlockContainer_I0IT language-csharp theme-code-block"><div style="color:#393A34;background-color:#f6f8fa" class="codeBlockTitle_BvAR">UnitTest1.cs</div><div class="codeBlockContent_wNvx csharp"><pre tabindex="0" class="prism-code language-csharp codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">using System;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">using Microsoft.VisualStudio.TestTools.UnitTesting;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">using OpenQA.Selenium.Appium;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">using OpenQA.Selenium.Appium.Android;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">using OpenQA.Selenium.Remote;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">using OpenQA.Selenium.Appium.Enums;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">using OpenQA.Selenium;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">namespace MobileWebUnitTestWithAppium</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[TestClass]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">public class UnitTest1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">//宣告 Appium Driver，並指定使用 Android Element</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">AppiumDriver&lt;AndroidElement&gt; \_driver;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        [TestMethod]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        public void TestSearchOuchMvpProfile()</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            //定義相容性</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            DesiredCapabilities desiredCapabilities = new DesiredCapabilities();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            //指定平台為安卓</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            desiredCapabilities.SetCapability( MobileCapabilityType.PlatformName , MobilePlatform.Android );</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            //指定使用的平台版本為 4.4.2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            desiredCapabilities.SetCapability( MobileCapabilityType.PlatformVersion , &quot;4.4.2&quot; );</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            //指定裝置名稱，裝置名稱可以透過在 Tools -&gt; Android Adb Command Prompt... 中輸入 adb devices -l 取得</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            desiredCapabilities.SetCapability( MobileCapabilityType.DeviceName , &quot;generic_x86&quot; );</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            //指定瀏覽器名稱為 Browser(也可以使用 Chrome，指定為 Browser 則會使用預設的瀏覽器)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            desiredCapabilities.SetCapability( MobileCapabilityType.BrowserName , &quot;Browser&quot; );</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            //指定不開啟任何 App(有的範例並沒有這行，但是我如果把這行拿掉的話會出錯)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            desiredCapabilities.SetCapability( MobileCapabilityType.App , null );</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            //建立 AppiumDriver 的 Instance ，並指定 Appium Server 的路徑</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            _driver = new AndroidDriver&lt;AndroidElement&gt;( new Uri( &quot;http://127.0.0.1:4723/wd/hub&quot; ) , desiredCapabilities );</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            //指定瀏覽器開啟網址</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            _driver.Navigate().GoToUrl( &quot;https://mvp.microsoft.com/zh-tw/&quot; );</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            //找出關鍵字搜尋框</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            AndroidElement searchBox = _driver.FindElementByName( &quot;kw&quot; );</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            //在搜尋框中輸入文字</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            searchBox.SendKeys( &quot;Ouch Liu&quot; );</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            //按下 Enter</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            searchBox.SendKeys( Keys.Enter );</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            //找出內文為指定文字的超連結</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            AndroidElement profileLink = _driver.FindElementByLinkText( &quot;Ouch Liu&quot; );</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            //按下超連結</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            profileLink.Click();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            //取出 class 為 title 物件中的文字</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            string titleText = _driver.FindElementByClassName( &quot;title&quot; ).Text;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            //定義預期值</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            string expectedTitle = &quot;Ouch Liu (劉耀群)&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            //比對實際值與預期值是否相同</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            Assert.AreEqual( expectedTitle , titleText );</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><button type="button" aria-label="複製程式碼到剪貼簿" class="copyButton_wuS7 clean-btn">複製</button></div></div><blockquote><p>DeviceName 可以透過 Visual Studio 主選單的 Tools -&gt; Android Adb Command Prompt... 中輸入 <code>adb devices -l</code> 取得。</p></blockquote><h2 class="anchor anchorWithStickyNavbar_mojV" id="執行測試">執行測試<a class="hash-link" href="#執行測試" title="Direct link to heading">​</a></h2><p>在進行測試之前，請先打開桌上面的 Appium 圖示來啟動 Appium Server。
基本上，完全不需要更改任何設定，只需要按下 Start Server 1.6.4 按鈕就行了。</p><p><img loading="lazy" alt="image-07" src="/assets/images/07-start-appium-server-7d19af8fc014921816759627bea82ea8.png" title="按下 Start Server 1.6.4 按鈕" width="636" height="593"></p><p>Appium Server 啟動之後的畫面如下：</p><p><img loading="lazy" alt="image-08" src="/assets/images/08-appium-server-started-d8bd5c900a66121d7e9ab628faf87286.png" title="Appium Server 啟動後的畫面" width="636" height="593"></p><p>在開始執行測試之前，請務必先確認 Appium Server 已經正常啟動，而且 Android 模擬器也能正常運作。</p><p>接著就可以透過 Test Explorer 來執行我們的測試程式，驗證看看 Appium 是不是真的有那麼厲害囉。</p><p><img loading="lazy" alt="image-09" src="/assets/images/09-automation-running-eab2fcfeca0f4e810b1fc290b75ec1b1.gif" title="實際執行畫面" width="324" height="611"></p><p>因為我最後驗證的條件只有檢查文字，只要瀏覽器中的 Dom 物件找得到該文字就算測試成功了，所以並不需要將畫面往下捲，也是可以通過測試的。</p><p>另外，在執行的過程中，我們也可以看到 Appium Server 視窗中處理測試程式中各個動作的 Log。</p><p><img loading="lazy" alt="image-10" src="/assets/images/10-appium-server-console-log-2159c09df08b0afadc14f523adf0eb9e.png" title="Appium Server 測試期間的 Log" width="636" height="593"></p><h2 class="anchor anchorWithStickyNavbar_mojV" id="結語">結語<a class="hash-link" href="#結語" title="Direct link to heading">​</a></h2><p>上面的測試程式碼應該對於平常就有在使用 Selenium 的朋友們充滿了親切感吧，就我個人的感覺，真的是很容易上手的一個框架。</p><p>加上 Appium Server Desktop 最近也更新到了新版，免除了舊版許多繁冗的設定，現在幾乎是打開之後只要按下 Start Server 就可以使用了，真的是超級方便的啊!!~~</p><p>有相關需求的朋友們不妨也一起玩看看喔!!</p><p>最後，附上專案的原始碼，請自行取用：</p><p><a href="https://github.com/Ouch1978/MobileWebUnitTestWithAppium/" target="_blank" rel="noopener noreferrer"><img loading="lazy" alt="Sample" src="/assets/images/source-code-153869134bfab34cdb0cca6222a56300.png" width="320" height="128"></a></p></section></article><footer class="article__footer padding-top--md margin-top--lg margin-bottom--lg"><div class="col margin-top--sm"><a href="https://github.com/ouch1978/ouch1978.github.io/edit/main/blog/2017-04-17-mobile-web-automation-testing-with-vs2017-and-appium/2017-04-17-mobile-web-automation-testing-with-vs2017-and-appium.md" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_dcUD" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>編輯本頁</a></div></footer></div></div></div><div id="disqus_thread"></div><nav class="pagination-nav docusaurus-mt-lg" aria-label="Blog post page navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/blog/2017-05-08-design-xamarin-forms-with-gorilla-player"><div class="pagination-nav__sublabel">下一篇</div><div class="pagination-nav__label">透過 Gorilla Player 在裝置上即時預覽 Xamarin Forms 介面</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/blog/2017-04-07-add-control-panel-back-after-creator-update"><div class="pagination-nav__sublabel">上一篇</div><div class="pagination-nav__label">回來吧!! Creator Update 開始按鈕右鍵選單裡的控制台選項!!</div></a></div></nav></main><div class="col col--2"><div class="tableOfContents_cNA8 thin-scrollbar"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#前言" class="table-of-contents__link toc-highlight">前言</a></li><li><a href="#環境準備" class="table-of-contents__link toc-highlight">環境準備</a></li><li><a href="#android-模擬器設定" class="table-of-contents__link toc-highlight">Android 模擬器設定</a></li><li><a href="#撰寫自動化測試程式碼" class="table-of-contents__link toc-highlight">撰寫自動化測試程式碼</a></li><li><a href="#執行測試" class="table-of-contents__link toc-highlight">執行測試</a></li><li><a href="#結語" class="table-of-contents__link toc-highlight">結語</a></li></ul></div></div></div></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2022 Ouch1978, Inc. Built with Docusaurus.</div></div></div></footer></div>
<script src="/assets/js/runtime~main.4df91c81.js"></script>
<script src="/assets/js/main.60653464.js"></script>
</body>
</html>