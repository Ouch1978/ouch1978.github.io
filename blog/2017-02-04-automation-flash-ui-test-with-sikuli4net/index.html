<!doctype html>
<html lang="zh-TW" dir="ltr" class="blog-wrapper blog-post-page plugin-blog plugin-id-default">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.18">
<link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="OUCH1978@GITHUB RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="OUCH1978@GITHUB Atom Feed">
<link rel="preconnect" href="https://www.google-analytics.com">
<script>window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)},ga.l=+new Date,ga("create","UA-20523508-2","auto"),ga("set","anonymizeIp",!0),ga("send","pageview")</script>
<script async src="https://www.google-analytics.com/analytics.js"></script>
<link rel="search" type="application/opensearchdescription+xml" title="OUCH1978@GITHUB" href="/opensearch.xml">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.13.11/dist/katex.min.css" integrity="sha384-Um5gpz1odJg5Z4HAmzPtgZKdTBHZdw8S29IecapCSB31ligYPhHQZMIlWLYQGVoc" crossorigin="anonymous">
<link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@100;300;400;500;700;900&amp;display=swap" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/pangu/4.0.7/pangu.min.js" async></script>
<script src="/assets/enablePangu.js" async></script><title data-rh="true">透過 Sikuli4Net 對 Flash UI 進行自動化測試 | OUCH1978@GITHUB</title><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://ouch1978.github.io/blog/2017-02-04-automation-flash-ui-test-with-sikuli4net"><meta data-rh="true" name="docusaurus_locale" content="zh-TW"><meta data-rh="true" name="docusaurus_tag" content="default"><meta data-rh="true" name="docsearch:language" content="zh-TW"><meta data-rh="true" name="docsearch:docusaurus_tag" content="default"><meta data-rh="true" property="og:title" content="透過 Sikuli4Net 對 Flash UI 進行自動化測試 | OUCH1978@GITHUB"><meta data-rh="true" name="description" content="前言"><meta data-rh="true" property="og:description" content="前言"><meta data-rh="true" name="keywords" content="滑鼠,圖形,辨識"><meta data-rh="true" property="og:type" content="article"><meta data-rh="true" property="article:published_time" content="2017-02-04T00:00:00.000Z"><meta data-rh="true" property="article:author" content="https://github.com/ouch1978"><meta data-rh="true" property="article:tag" content="C#,Sikuli4Net,Visual Studio,Coded UI Test"><link data-rh="true" rel="icon" href="/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://ouch1978.github.io/blog/2017-02-04-automation-flash-ui-test-with-sikuli4net"><link data-rh="true" rel="alternate" href="https://ouch1978.github.io/blog/2017-02-04-automation-flash-ui-test-with-sikuli4net" hreflang="zh-TW"><link data-rh="true" rel="alternate" href="https://ouch1978.github.io/blog/2017-02-04-automation-flash-ui-test-with-sikuli4net" hreflang="x-default"><link data-rh="true" rel="preconnect" href="https://AG6O0X1DB7-dsn.algolia.net" crossorigin="anonymous"><link rel="stylesheet" href="/assets/css/styles.b2053045.css">
<link rel="preload" href="/assets/js/runtime~main.706a2b4c.js" as="script">
<link rel="preload" href="/assets/js/main.412a877a.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div role="region"><a href="#" class="skipToContent_ZgBM">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/logo.png" alt="Site Logo" class="themedImage_W2Cr themedImage--light_TfLj"><img src="/img/logo.png" alt="Site Logo" class="themedImage_W2Cr themedImage--dark_oUvU"></div><b class="navbar__title">OUCH1978@GITHUB</b></a><a class="navbar__item navbar__link" href="/docs/docs-intro">文件庫</a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/blog">部落格</a></div><div class="navbar__items navbar__items--right"><a href="/slides" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">投影片</a><div class="toggle_S7eR colorModeToggle_vKtC"><button class="clean-btn toggleButton_rCf9 toggleButtonDisabled_Pu9x" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_v35p"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_nQuB"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="searchBox_qEbK"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"></span></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper"><div class="container margin-vert--lg"><div class="row"><main class="col col--9 col--offset-1" itemscope="" itemtype="http://schema.org/Blog"><div class="sc-gsnTZi zLxxN"><div class="row" style="margin:0px"><div class="col col--12 article__details"><article><header><h1 class="blogPostTitle_uMeh" itemprop="headline">透過 Sikuli4Net 對 Flash UI 進行自動化測試</h1><div class="margin-top--md margin-bottom--sm row"><div class="col col--6 authorCol_FlmR"><div class="avatar margin-bottom--sm"><span class="avatar__photo-link avatar__photo"><a href="https://github.com/ouch1978" target="_blank" rel="noopener noreferrer"><img class="image_o0gy" src="https://avatars.githubusercontent.com/u/18132883?v=4" alt="Ouch Liu"></a></span><div class="avatar__intro" itemprop="author" itemscope="" itemtype="https://schema.org/Person"><div class="avatar__name"><a href="https://github.com/ouch1978" target="_blank" rel="noopener noreferrer" itemprop="url"><span itemprop="name">Ouch Liu</span></a></div><small class="avatar__subtitle" itemprop="description">不務正業的工程師</small></div></div></div></div></header><p class="single-post--date text--center"><svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="calendar-plus" class="svg-inline--fa fa-calendar-plus margin-right--md" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path fill="currentColor" d="M96 32C96 14.33 110.3 0 128 0C145.7 0 160 14.33 160 32V64H288V32C288 14.33 302.3 0 320 0C337.7 0 352 14.33 352 32V64H400C426.5 64 448 85.49 448 112V160H0V112C0 85.49 21.49 64 48 64H96V32zM448 464C448 490.5 426.5 512 400 512H48C21.49 512 0 490.5 0 464V192H448V464zM200 272V328H144C130.7 328 120 338.7 120 352C120 365.3 130.7 376 144 376H200V432C200 445.3 210.7 456 224 456C237.3 456 248 445.3 248 432V376H304C317.3 376 328 365.3 328 352C328 338.7 317.3 328 304 328H248V272C248 258.7 237.3 248 224 248C210.7 248 200 258.7 200 272z"></path></svg><time datetime="2017-02-04T00:00:00.000Z" itemprop="datePublished">2017年2月4日</time><br><br><svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="clock" class="svg-inline--fa fa-clock margin-right--md" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M256 512C114.6 512 0 397.4 0 256C0 114.6 114.6 0 256 0C397.4 0 512 114.6 512 256C512 397.4 397.4 512 256 512zM232 256C232 264 236 271.5 242.7 275.1L338.7 339.1C349.7 347.3 364.6 344.3 371.1 333.3C379.3 322.3 376.3 307.4 365.3 300L280 243.2V120C280 106.7 269.3 96 255.1 96C242.7 96 231.1 106.7 231.1 120L232 256z"></path></svg>預估閱讀時間： 9 分鐘</p><div class="text--center margin-bottom--xs padding-bottom--xs"><div class="post__tags-container margin-bottom--md"><svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="tags" class="svg-inline--fa fa-tags margin-right--md" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M472.8 168.4C525.1 221.4 525.1 306.6 472.8 359.6L360.8 472.9C351.5 482.3 336.3 482.4 326.9 473.1C317.4 463.8 317.4 448.6 326.7 439.1L438.6 325.9C472.5 291.6 472.5 236.4 438.6 202.1L310.9 72.87C301.5 63.44 301.6 48.25 311.1 38.93C320.5 29.61 335.7 29.7 344.1 39.13L472.8 168.4zM.0003 229.5V80C.0003 53.49 21.49 32 48 32H197.5C214.5 32 230.7 38.74 242.7 50.75L410.7 218.7C435.7 243.7 435.7 284.3 410.7 309.3L277.3 442.7C252.3 467.7 211.7 467.7 186.7 442.7L18.75 274.7C6.743 262.7 0 246.5 0 229.5L.0003 229.5zM112 112C94.33 112 80 126.3 80 144C80 161.7 94.33 176 112 176C129.7 176 144 161.7 144 144C144 126.3 129.7 112 112 112z"></path></svg><a class="post__tags margin-right--sm" style="font-size:0.75em;font-weight:500" href="/blog/tags/c">C#</a><a class="post__tags margin-horiz--sm" style="font-size:0.75em;font-weight:500" href="/blog/tags/sikuli-4-net">Sikuli4Net</a><a class="post__tags margin-horiz--sm" style="font-size:0.75em;font-weight:500" href="/blog/tags/visual-studio">Visual Studio</a><a class="post__tags margin-horiz--sm" style="font-size:0.75em;font-weight:500" href="/blog/tags/coded-ui-test">Coded UI Test</a></div></div><section class="sc-bczRLJ bdeZVr markdown"><h2 class="anchor anchorWithStickyNavbar_mojV" id="前言">前言<a class="hash-link" href="#前言" title="Direct link to heading">​</a></h2><p>在導入 CI/CD 的時候，能將測試自動化是很重要的一個環節。 然而，除了「<code>工程師生出來就應該要會</code>」的 Unit Test 之外， UI 的自動化測試也很重要。</p><p>基於大部份的工具都難以辨識以 Flash / Flex 編寫的 UI 裡面的元件的關係，因此大多數有需要針對 Flash UI 進行測試的需求時，最常使用的方式就是直接錄製滑鼠和鍵盤的動作。 這個方式固然可行，但是一來程式碼相對的複雜(可能得引用到 Windows API)、入門的門檻相對提高；二來，一旦 Flash 或是視窗的位置不小心跑掉，整個測試就會失敗了。</p><p>針對上述的兩個問題，讓我好奇是不是還有更好的方式可以讓我們以更簡單、有效率，而且更準確的方式來針對 Flash UI 進行自動化測試，而且最好能和 Selenium 混搭。 最後，總算讓我找到另一條出路啦，也就是今天要介紹的主角 -- <a href="https://www.nuget.org/packages/Sikuli4Net" target="_blank" rel="noopener noreferrer" title="Sikuli4Net - Call Sikuli from your .NET project">Sikuli4Net</a>。</p><p>其實 Sikuli 本來是一個以 Java 為基礎而開發出來的工具，從 2009 年開始了這個專案，在 2012 年正式完成。 主要的開發者 <a href="http://blog.vgod.tw/2010/01/30/sikuli/" target="_blank" rel="noopener noreferrer" title="vgod">vgod</a> 也是台灣人喔!!(台灣之光!! 灑花<del></del> 關於 Sikuli 的詳細發展史，請參閱<a href="https://en.wikipedia.org/wiki/Sikuli" target="_blank" rel="noopener noreferrer" title="Sikuli - Wiki">維基百科</a>)</p><p>Sikuli 主要的功能和特色是：讓我們以擷圖的方式，取代我們的眼睛，再透過 Sikuli 幫我們進行比對，找到目標控制項，並且和它進行互動。</p><p>不過，前面已經提到了， Sikuli 是以 Java 為基礎開發的，所以沒辦法直接透過 .Net / C# 呼叫，得要透過 Wrapper 多包一層才能給 .Net 使用。 而這個包好可以給 .Net 使用的版本， 在 Nuget 上也有兩三種，不過最後我還是選擇了 Sikuli4Net。</p><h2 class="anchor anchorWithStickyNavbar_mojV" id="使用方式">使用方式<a class="hash-link" href="#使用方式" title="Direct link to heading">​</a></h2><p>介紹了那麼多，光說不練是不夠的，接下來我們就來透過一個實例，見證透過 Sikuli4Nnet 為我們帶來的奇蹟吧!!</p><p>在我們開始之前，得先確認你的電腦裡面得有安裝 Java Runtime Environment 6 以上的版本(這個應該每個人都有吧?)，否則會出現系統找不到檔案的錯誤。</p><p>第一步當然就開啟地表最強的開發工具 - Visual Studio 建立我們的測試專案囉。</p><p><img loading="lazy" alt="建立 Coded UI Test 專案" src="/assets/images/01-create-coded-ui-test-project-845d7fe122fcb93e99febb66548f874b.png" title="建立 Coded UI Test 專案" width="1413" height="980" class="img_E7b_"></p><p>接著， Visual Studio 會貼心的問我們要用什麼方式建立程式碼，這邊我直接按下 Cancel 鈕。</p><p><img loading="lazy" alt="不使用錄製的方式建立程式碼" src="/assets/images/02-click-cancel-to-bypass-ui-recording-0511ddae409e8ce8d72ccb0305ae1147.png" title="不使用錄製的方式建立程式碼" width="706" height="479" class="img_E7b_"></p><p>再來，透過 Nuget 安裝以下的元件庫吧。</p><ul><li><p>Selenium.WebDriver</p></li><li><p>Selenium.Support</p></li><li><p>Selenium.WebDriver.ChromeDriver</p></li><li><p>Sikuli4Net</p></li></ul><p>安裝完需要使用的元件庫之後，就可以找一個 Flash 小遊戲來試刀了。</p><p>為了完成這個範例，我在網路上隨便找了一個 <a href="https://en.wikipedia.org/wiki/Sikuli" target="_blank" rel="noopener noreferrer" title="Flash 算命小遊戲">Flash 算命小遊戲</a>來作為我測試的目標。</p><p>為了證明 Sikuli4Net 可以和 Selenium 混搭使用，所以這裡就簡單的透過 Selenium 的 ChromeDriver 來幫我們用 Chrome 開啟目標網頁。</p><p>準備工作完成之後，就可以開始準備使用擷圖工具來把目標控制項的部份擷取下來並且加入到專案裡了。</p><p>以這次的範例來說，我會先在專案中建立一個名為 Images 的資料夾，再分別把 Flash 中需要點擊或是輸入文字的控制項分別擷圖存檔，並且放進 Images 資料夾中。</p><p>這邊有很重要的一點 -- <code>圖檔的 Copy to Output Directory 屬性記得要設為 Copy always</code> ，不然在執行的時候會出錯喔。</p><p><img loading="lazy" alt="Copy to Output Directory 屬性記得要設為 Copy always" src="/assets/images/03-prepare-screenshot-for-components-058ef5d5eb9f3ab285dbbf341c78b0f4.png" title="Copy to Output Directory 屬性記得要設為 Copy always" width="2160" height="1394" class="img_E7b_"></p><p>這些動作都完成了之後，再來就是透過 Sikuli4Net 提供的 API 來撰寫我們的測試啦!!</p><p>完整的程式碼如下：</p><div class="codeBlockContainer_I0IT language-csharp theme-code-block"><div style="color:#393A34;background-color:#f6f8fa" class="codeBlockTitle_BvAR">CodedUITest1.cs</div><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-csharp codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">using System;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">using Microsoft.VisualStudio.TestTools.UITesting;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">using Microsoft.VisualStudio.TestTools.UnitTesting;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">using OpenQA.Selenium;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">using OpenQA.Selenium.Chrome;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">using Sikuli4Net.sikuli_REST;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">using Sikuli4Net.sikuli_UTIL;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">using System.IO;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">using System.Threading;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">namespace SikuliCodedUITestProject</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[CodedUITest]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">public class CodedUITest1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">static IWebDriver _driver;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        APILauncher _launcher = new APILauncher( true );</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        public CodedUITest1()</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        #region Additional test attributes</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        // You can use the following additional attributes as you write your tests:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        //Use TestInitialize to run code before running each test</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        [TestInitialize()]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        public void MyTestInitialize()</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            _launcher.Start();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            _driver = new ChromeDriver();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            _driver.Manage().Window.Maximize();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            _driver.Navigate().GoToUrl( &quot;http://www.xingzuo360.cn/uploads/media/121030/1-1210300F426.swf&quot; );</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        //Use TestCleanup to run code after each test has run</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        [TestCleanup()]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        public void MyTestCleanup()</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            _driver.Quit();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            _launcher.Stop();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        #endregion</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        [TestMethod]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        [DeploymentItem( &quot;Images\\&quot; ,&quot;Images\\&quot; )]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        public void CodedUITestMethod1()</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            Thread.Sleep(5000);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            //定義目前的畫面為偵測區</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            Screen mainPage = new Screen();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            //透過 Pattern 類別宣告並定義要比對的控制項擷圖</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            Pattern goButton = new Pattern( Path.Combine( AppDomain.CurrentDomain.BaseDirectory + @&quot;\Images\Go.png&quot; ) );</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            Pattern nameField = new Pattern( Path.Combine( AppDomain.CurrentDomain.BaseDirectory + @&quot;\Images\Name.png&quot; ) );</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            Pattern birthdayField = new Pattern( Path.Combine( AppDomain.CurrentDomain.BaseDirectory + @&quot;\Images\Birthday.png&quot; ) );</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            Pattern gender = new Pattern( Path.Combine( AppDomain.CurrentDomain.BaseDirectory + @&quot;\Images\Gender.png&quot; ) );</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            Pattern bloodType = new Pattern( Path.Combine( AppDomain.CurrentDomain.BaseDirectory + @&quot;\Images\BloodType.png&quot; ) );</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            Pattern placeField = new Pattern( Path.Combine( AppDomain.CurrentDomain.BaseDirectory + @&quot;\Images\PlaceGrownUp.png&quot; ) );</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            Pattern okButton = new Pattern( Path.Combine( AppDomain.CurrentDomain.BaseDirectory + @&quot;\Images\OkButton.png&quot; ) );</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            Pattern result = new Pattern( Path.Combine( AppDomain.CurrentDomain.BaseDirectory + @&quot;\Images\Result.png&quot; ) );</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            //等待 go 按鈕出現</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            mainPage.Wait( goButton );</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            //對 go 按鈕按下滑鼠左鍵</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            mainPage.Click(goButton);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            Thread.Sleep( 3000 );</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            //在姓名欄位輸入文字</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            mainPage.Type( nameField , &quot;Ouch&quot; );</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            //在生日欄位輸入文字</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            mainPage.Type( birthdayField, &quot;19781128&quot; );</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            //點選男性</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            mainPage.Click( gender );</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            //點選 B 型</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            mainPage.Click( bloodType );</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            //在成長地點欄位輸入文字</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            mainPage.Type( placeField , &quot;Taipei&quot; );</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            //按下 Ok 按鈕</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            mainPage.Click( okButton );</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            Thread.Sleep( 8000 );</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            //以結果是否出現作為判斷測試成功的條件</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            Assert.IsTrue(mainPage.Exists(result));</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">       }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><button type="button" aria-label="複製程式碼到剪貼簿" title="複製" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p>專案原始檔連結在此，歡迎自行取用。</p><p><a href="https://github.com/Ouch1978/Sikuli4NetCodedUITestSample/" target="_blank" rel="noopener noreferrer"><img loading="lazy" alt="Sikuli4NetCodedUITestSample" src="/assets/images/source-code-153869134bfab34cdb0cca6222a56300.png" width="320" height="128" class="img_E7b_"></a></p><h2 class="anchor anchorWithStickyNavbar_mojV" id="注意事項--小心得">注意事項 / 小心得<a class="hash-link" href="#注意事項--小心得" title="Direct link to heading">​</a></h2><p>基本上，透過 Sikuli4Net 應該可以完成我們通常會對 Flash UI 進行的大部份操作。 不過如果想要針對長相一樣的多個控制項進行重複操作的話，這個部份我就還沒摸出來了。</p><p>另外，建議擷圖的部份儘量擷取比控制項還要大一點點的範圍，以提升比對準確度，如果 Flash 裡面有動畫或是需要等待它載入的話，也可以適當的透過 Thread.Sleep() 方法延緩測式的時間。</p><p>以上，如果你手邊也有古早的 Flash UI 需要測試的話，不妨也試看看 Sikuli4Net 吧~</p><p>當然，如果你有更好用、更簡便的方法或工具，也歡迎不吝分享喔!!~</p></section></article><footer class="article__footer padding-top--md margin-top--lg margin-bottom--lg"><div class="col margin-top--sm"><a href="https://github.com/ouch1978/ouch1978.github.io/edit/main/blog/2017-02-04-automation-flash-ui-test-with-sikuli4net/2017-02-04-automation-flash-ui-test-with-sikuli4net.md" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_dcUD" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>編輯本頁</a></div></footer></div></div></div><div id="disqus_thread"></div><nav class="pagination-nav docusaurus-mt-lg" aria-label="Blog post page navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/blog/2017-03-25-material-design-xaml-toolkit"><div class="pagination-nav__sublabel">下一篇</div><div class="pagination-nav__label">透過 Material Design Xaml Toolkit 讓你的 WPF 應用程式潮又有料</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/blog/2017-02-03-html-to-md-exporter"><div class="pagination-nav__sublabel">上一篇</div><div class="pagination-nav__label">部落格備份/搬家小工具 - Html to MD Exporter</div></a></div></nav></main><div class="col col--2"><div class="tableOfContents_cNA8 thin-scrollbar"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#前言" class="table-of-contents__link toc-highlight">前言</a></li><li><a href="#使用方式" class="table-of-contents__link toc-highlight">使用方式</a></li><li><a href="#注意事項--小心得" class="table-of-contents__link toc-highlight">注意事項 / 小心得</a></li></ul></div></div></div></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2022 Ouch Liu(劉耀群). Built with Docusaurus.</div></div></div></footer></div>
<script src="/assets/js/runtime~main.706a2b4c.js"></script>
<script src="/assets/js/main.412a877a.js"></script>
</body>
</html>