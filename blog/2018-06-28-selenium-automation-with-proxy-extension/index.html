<!doctype html>
<html lang="zh-TW" dir="ltr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.17">
<link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="OUCH1978@GITHUB RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="OUCH1978@GITHUB Atom Feed">
<link rel="preconnect" href="https://www.google-analytics.com">
<script>window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)},ga.l=+new Date,ga("create","UA-20523508-2","auto"),ga("set","anonymizeIp",!0),ga("send","pageview")</script>
<script async src="https://www.google-analytics.com/analytics.js"></script>
<link rel="search" type="application/opensearchdescription+xml" title="OUCH1978@GITHUB" href="/opensearch.xml">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.13.11/dist/katex.min.css" integrity="sha384-Um5gpz1odJg5Z4HAmzPtgZKdTBHZdw8S29IecapCSB31ligYPhHQZMIlWLYQGVoc" crossorigin="anonymous">
<link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@100;300;400;500;700;900&amp;display=swap" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/pangu/4.0.7/pangu.min.js" async></script>
<script src="undefinedassets/enablePangu.js" async></script><title data-rh="true">被擋的嫑嫑的嗎? 透過 CHROME 的擴充功能讓你的 SELENIUM 自動化突破國家的界線!! | OUCH1978@GITHUB</title><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://ouch1978.github.io/blog/2018-06-28-selenium-automation-with-proxy-extension"><meta data-rh="true" name="docusaurus_locale" content="zh-TW"><meta data-rh="true" name="docusaurus_tag" content="default"><meta data-rh="true" name="docsearch:language" content="zh-TW"><meta data-rh="true" name="docsearch:docusaurus_tag" content="default"><meta data-rh="true" property="og:title" content="被擋的嫑嫑的嗎? 透過 CHROME 的擴充功能讓你的 SELENIUM 自動化突破國家的界線!! | OUCH1978@GITHUB"><meta data-rh="true" name="description" content="前言"><meta data-rh="true" property="og:description" content="前言"><meta data-rh="true" property="og:type" content="article"><meta data-rh="true" property="article:published_time" content="2018-06-28T00:00:00.000Z"><meta data-rh="true" property="article:author" content="https://github.com/ouch1978"><meta data-rh="true" property="article:tag" content="selenium,automation,extension"><link data-rh="true" rel="icon" href="/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://ouch1978.github.io/blog/2018-06-28-selenium-automation-with-proxy-extension"><link data-rh="true" rel="alternate" href="https://ouch1978.github.io/blog/2018-06-28-selenium-automation-with-proxy-extension" hreflang="zh-TW"><link data-rh="true" rel="alternate" href="https://ouch1978.github.io/blog/2018-06-28-selenium-automation-with-proxy-extension" hreflang="x-default"><link data-rh="true" rel="preconnect" href="https://AG6O0X1DB7-dsn.algolia.net" crossorigin="anonymous"><link rel="stylesheet" href="/assets/css/styles.b6c0eb04.css">
<link rel="preload" href="/assets/js/runtime~main.4223f0d5.js" as="script">
<link rel="preload" href="/assets/js/main.5ec25d21.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div role="region"><a href="#" class="skipToContent_ZgBM">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/logo.png" alt="Site Logo" class="themedImage_W2Cr themedImage--light_TfLj"><img src="/img/logo.png" alt="Site Logo" class="themedImage_W2Cr themedImage--dark_oUvU"></div><b class="navbar__title">OUCH1978@GITHUB</b></a><a class="navbar__item navbar__link" href="/docs/intro/docs-intro">文件庫</a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/blog">部落格</a></div><div class="navbar__items navbar__items--right"><a href="/slides" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">投影片</a><div class="toggle_S7eR toggle_TdHA toggleDisabled_f9M3"><div class="toggleButton_rCf9" role="button" tabindex="-1"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_v35p"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_nQuB"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></div><input type="checkbox" class="toggleScreenReader_g2nN" aria-label="Switch between dark and light mode (currently light mode)"></div><div class="searchBox_qEbK"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"></span></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper blog-wrapper blog-post-page"><div class="container margin-vert--lg"><div class="row"><main class="col col--9 col--offset-1" itemscope="" itemtype="http://schema.org/Blog"><div class="sc-gsDKAQ kqZFtN"><div class="row" style="margin:0px"><div class="col col--12 article__details"><article><header><h1 class="blogPostTitle_uMeh" itemprop="headline">被擋的嫑嫑的嗎? 透過 CHROME 的擴充功能讓你的 SELENIUM 自動化突破國家的界線!!</h1><div class="margin-top--md margin-bottom--sm row"><div class="col col--6 authorCol_FlmR"><div class="avatar margin-bottom--sm"><span class="avatar__photo-link avatar__photo"><a href="https://github.com/ouch1978" target="_blank" rel="noopener noreferrer"><img class="image_o0gy" src="https://avatars.githubusercontent.com/u/18132883?v=4" alt="Ouch Liu"></a></span><div class="avatar__intro" itemprop="author" itemscope="" itemtype="https://schema.org/Person"><div class="avatar__name"><a href="https://github.com/ouch1978" target="_blank" rel="noopener noreferrer" itemprop="url"><span itemprop="name">Ouch Liu</span></a></div><small class="avatar__subtitle" itemprop="description">不務正業的工程師</small></div></div></div></div></header><p class="single-post--date text--center"><svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="calendar-plus" class="svg-inline--fa fa-calendar-plus margin-right--md" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path fill="currentColor" d="M96 32C96 14.33 110.3 0 128 0C145.7 0 160 14.33 160 32V64H288V32C288 14.33 302.3 0 320 0C337.7 0 352 14.33 352 32V64H400C426.5 64 448 85.49 448 112V160H0V112C0 85.49 21.49 64 48 64H96V32zM448 464C448 490.5 426.5 512 400 512H48C21.49 512 0 490.5 0 464V192H448V464zM200 272V328H144C130.7 328 120 338.7 120 352C120 365.3 130.7 376 144 376H200V432C200 445.3 210.7 456 224 456C237.3 456 248 445.3 248 432V376H304C317.3 376 328 365.3 328 352C328 338.7 317.3 328 304 328H248V272C248 258.7 237.3 248 224 248C210.7 248 200 258.7 200 272z"></path></svg><time datetime="2018-06-28T00:00:00.000Z" itemprop="datePublished">2018年6月28日</time><br><br><svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="clock" class="svg-inline--fa fa-clock margin-right--md" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M256 512C114.6 512 0 397.4 0 256C0 114.6 114.6 0 256 0C397.4 0 512 114.6 512 256C512 397.4 397.4 512 256 512zM232 256C232 264 236 271.5 242.7 275.1L338.7 339.1C349.7 347.3 364.6 344.3 371.1 333.3C379.3 322.3 376.3 307.4 365.3 300L280 243.2V120C280 106.7 269.3 96 255.1 96C242.7 96 231.1 106.7 231.1 120L232 256z"></path></svg>預估閱讀時間： 7 分鐘</p><div class="text--center margin-bottom--xs padding-bottom--xs"><div class="post__tags-container margin-bottom--md"><svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="tags" class="svg-inline--fa fa-tags margin-right--md" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M472.8 168.4C525.1 221.4 525.1 306.6 472.8 359.6L360.8 472.9C351.5 482.3 336.3 482.4 326.9 473.1C317.4 463.8 317.4 448.6 326.7 439.1L438.6 325.9C472.5 291.6 472.5 236.4 438.6 202.1L310.9 72.87C301.5 63.44 301.6 48.25 311.1 38.93C320.5 29.61 335.7 29.7 344.1 39.13L472.8 168.4zM.0003 229.5V80C.0003 53.49 21.49 32 48 32H197.5C214.5 32 230.7 38.74 242.7 50.75L410.7 218.7C435.7 243.7 435.7 284.3 410.7 309.3L277.3 442.7C252.3 467.7 211.7 467.7 186.7 442.7L18.75 274.7C6.743 262.7 0 246.5 0 229.5L.0003 229.5zM112 112C94.33 112 80 126.3 80 144C80 161.7 94.33 176 112 176C129.7 176 144 161.7 144 144C144 126.3 129.7 112 112 112z"></path></svg><a class="post__tags margin-right--sm" style="font-size:0.75em;font-weight:500" href="/blog/tags/selenium">selenium</a><a class="post__tags margin-horiz--sm" style="font-size:0.75em;font-weight:500" href="/blog/tags/automation">automation</a><a class="post__tags margin-horiz--sm" style="font-size:0.75em;font-weight:500" href="/blog/tags/extension">extension</a></div></div><section class="sc-bdvvtL bPJbvM markdown"><h2 class="anchor anchorWithStickyNavbar_mojV" id="前言">前言<a class="hash-link" href="#前言" title="Direct link to heading">​</a></h2><p>在透過 Selenium 進行自動化測試的時候，可能會基於需求或是地域的限制，得要模擬在不同的地區進行測試，並且驗證結果是否符合預期。</p><p>然而，該怎麼在自動化的程式中切換地區(也就是俗稱的翻牆啦~)，就是第一個會面臨到的問題。</p><p>值得開心的是，Chrome Web Store 裡面有不少 VPN 和 Secured Proxy 可以幫助我們輕鬆的翻牆。</p><p>更值得開心的是，我們也可以把這些工具運用到自動化測試的流程裡。</p><p>以下就來分享透過 Selenium 的 Chrome Driver 安裝擴充功能 ，並且模擬從不同的國家連線到 Google.com 的方法。</p><h2 class="anchor anchorWithStickyNavbar_mojV" id="流程說明">流程說明<a class="hash-link" href="#流程說明" title="Direct link to heading">​</a></h2><p>首先，由於 Selenium 預設每次開啟的 Chrome Driver 都會是一個全新的實體，所以我們的第一步就是幫它裝上我們要用來翻牆的擴充功能。</p><p>安裝完翻牆用的擴充功能之後，有一個很重要的步驟，就要是取得擴充包的 Id 還有裡面的 html 頁面路徑，以便於之後和它互動。</p><p>完成上面兩個動作之後，就可以動手撰寫程式來讓安裝並且開啟擴充功能的動作自動化，以便於之後測試的進行。</p><h3 class="anchor anchorWithStickyNavbar_mojV" id="下載-crx-檔">下載 .CRX 檔<a class="hash-link" href="#下載-crx-檔" title="Direct link to heading">​</a></h3><p>目前 Chrome Web Store 裡面經有有不少可以用來翻牆的擴充功能，例如 <a href="https://chrome.google.com/webstore/detail/tunnelbear-vpn/omdakjcmkglenbhjadbccaookpfjihpa" target="_blank" rel="noopener noreferrer" title="TunnelBear VPN">TunnelBear VPN</a> 和 <a href="https://chrome.google.com/webstore/detail/betternet-unlimited-free/gjknjjomckknofjidppipffbpoekiipm" target="_blank" rel="noopener noreferrer" title="Betternet Unlimited Free VPN Proxy">Betternet Unlimited Free VPN Proxy</a> 。</p><blockquote><p>要使用 TunnelBear 的話必需要先建立帳號，免費帳號登入之後每個月會有 500 MB 的容量限制，而 Betternet 則沒有任何限制，也不需要登入就能使用。</p></blockquote><p>有毅力和實驗精神的朋友們當然可以自己撰寫程式碼，透過 Chrome Web Store 進行下載和安裝；不過，我個人會比較推薦直接透過 .crx 檔進行安裝。</p><p>取得 .crx 檔的方式也有不只一種，例如透過在 Chrome 安裝 <a href="https://chrome.google.com/webstore/detail/get-crx/dijpllakibenlejkbajahncialkbdkjc" target="_blank" rel="noopener noreferrer" title="Get CRX Chrome Extension">Get CRX</a> 這個擴充功能直接把已經安裝在 Chrome 裡的擴充功能匯出成 .crx 檔。</p><p>也可以直接透過 <a href="https://chrome-extension-downloader.com/" target="_blank" rel="noopener noreferrer" title="Chrome Extension Downloader">Chrome Extension Downloader</a> 或是 <a href="http://crxextractor.com/" target="_blank" rel="noopener noreferrer" title="CRX Extractor">CRX Extractor</a> 等等網站直接下載。</p><p>為了方便之後的使用，可以把下載下來的 .crx 檔放在一個方便存取又好記的地方(例如 <code>C:\Chrome Extensions</code>)。</p><h3 class="anchor anchorWithStickyNavbar_mojV" id="取得擴充功能的-id-與網頁路徑">取得擴充功能的 Id 與網頁路徑<a class="hash-link" href="#取得擴充功能的-id-與網頁路徑" title="Direct link to heading">​</a></h3><p>其實呢，擴充功能說穿了，不過就是一個副名被改成 .crx 的 ZIP 檔；我們可以直接把它當作一個被打包起來的網站，所以完全可以透過 Selenium 來跟裡面的 html 檔互動。</p><p>Id 我們可以很輕鬆的透過擴充功能在 Chrome Web Store 裡的連結取得。</p><p>而 html 檔的路徑呢，則可以透過前面提到的 <a href="http://crxextractor.com/" target="_blank" rel="noopener noreferrer" title="CRX Extractor">CRX Extractor</a> 或是直接透過 7-ZIP 等壓縮工具來查看裡面的內容。</p><p>除此之外，透過 <a href="https://chrome.google.com/webstore/detail/chrome-extension-source-v/jifpbeccnghkjeaalbbjmodiffmgedin" target="_blank" rel="noopener noreferrer" title="Chrome extension source viewer">Chrome extension source viewer</a> 直接查看擴充功能的內容也是蠻方便的選擇。</p><p>以 Betternet 為例，透過 Chrome extension source viewer 查看內容的話會看到的檔案列表如下圖：</p><p>![image-01]<!-- -->( 01-view-contents-with-chrome-extension-source-viewer.png &quot;透過 Chrome extension source viewer 查看 Betternet 擴充)功能的內容&quot;</p><p>而那個 <code>panel/index.html</code> 就是我們之後要用來互動的目標。</p><blockquote><p>我們可以透過 <code>chrome-extension://{擴充功能 Id}/{html 檔路徑}</code> 直接開啟擴充功能中的頁面</p></blockquote><p>所以我們只要在 Chrome 的網址列輸入 <code>chrome-extension://gjknjjomckknofjidppipffbpoekiipm/panel/index.html</code> 網址，就可以看到該擴充功能的頁面，如下圖：</p><p><img loading="lazy" alt="image-02" src="/assets/images/02-browse-extension-page-with-url-df2631057ded77747e2460f333470c57.png" title="透過網址直接開啟擴充功能的頁面" width="1600" height="900"></p><h3 class="anchor anchorWithStickyNavbar_mojV" id="在自動化程式中指定-chrome-開啟擴充功能">在自動化程式中指定 Chrome 開啟擴充功能<a class="hash-link" href="#在自動化程式中指定-chrome-開啟擴充功能" title="Direct link to heading">​</a></h3><p>萬事俱備之後，就到了最開心的環節 - Coding 了!!~</p><p>廢話不多說，直接上 Code。</p><div class="codeBlockContainer_I0IT language-csharp theme-code-block"><div style="color:#9CDCFE;background-color:#1E1E1E" class="codeBlockTitle_BvAR">SwitchCountryTest.cs</div><div class="codeBlockContent_wNvx csharp"><pre tabindex="0" class="prism-code language-csharp codeBlock_jd64 thin-scrollbar" style="color:#9CDCFE;background-color:#1E1E1E"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#9CDCFE"><span class="token plain">using System;</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">using FluentAssertions;</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">using FluentAutomation;</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">using FluentAutomation.Interfaces;</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">using Microsoft.VisualStudio.TestTools.UnitTesting;</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">using OpenQA.Selenium;</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">using OpenQA.Selenium.Chrome;</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">namespace AutomationWithChromeExtension</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">{</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    [TestClass]</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    public class SwitchCountryTest : FluentTest</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    {</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        private const string BetterNetCrxPath = &quot;gjknjjomckknofjidppipffbpoekiipm.crx&quot;;</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        private const string BetterNetExtensionUrl =</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">            &quot;chrome-extension://gjknjjomckknofjidppipffbpoekiipm/panel/index.html&quot;;</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        private const string TargetUrl =</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">            &quot;http://www.google.com&quot;;</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        [TestInitialize]</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        public void TestInitialize()</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        {</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">            SeleniumWebDriver.Bootstrap( SeleniumWebDriver.Browser.Chrome , TimeSpan.FromSeconds( 15 ) );</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">            LoadBetterNetExtension();</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        [TestMethod]</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        public void TestWithoutBetterNet()</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        {</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">            InteractWithBetterNet( isTurnOn: false , country: string.Empty );</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">            CheckFooterText( expectedText: &quot;台灣&quot; );</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        [TestMethod]</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        public void TestSwitchToIndia()</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        {</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">            InteractWithBetterNet( isTurnOn: true , country: &quot;India&quot; );</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">            CheckFooterText( expectedText: &quot;India&quot; );</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        [TestMethod]</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        public void TestSwitchToGermany()</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        {</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">            InteractWithBetterNet( isTurnOn: true , country: &quot;Germany&quot; );</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">            CheckFooterText( expectedText: &quot;Deutschland&quot; );</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        private void CheckFooterText( string expectedText )</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        {</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">            I.Open( TargetUrl ).Find( &quot;span.Q8LRLc&quot; ).Element.Text.Should().Be( expectedText );</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        private void LoadBetterNetExtension()</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        {</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">            FluentSettings.Current.ContainerRegistration = ( container ) =&gt;</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">            {</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">                container.Register&lt;ICommandProvider , CommandProvider&gt;();</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">                container.Register&lt;IAssertProvider , AssertProvider&gt;();</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">                container.Register&lt;IFileStoreProvider , LocalFileStoreProvider&gt;();</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">                var chromeOptions = new ChromeOptions();</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">                chromeOptions.AddArgument( &quot;start-maximized&quot; );</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">                chromeOptions.AddExtension( BetterNetCrxPath );</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">                container.Register&lt;IWebDriver&gt;( ( c , o ) =&gt; new ChromeDriver( chromeOptions ) );</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">            };</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        private void InteractWithBetterNet( bool isTurnOn , string country )</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        {</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">            TurnOnOffBetterNet( isTurnOn );</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">            SwitchToCountry( country );</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        private void SwitchToCountry( string country )</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        {</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">            if( string.IsNullOrEmpty( country ) == true )</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">            {</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">                return;</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">            }</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">            I.Open( BetterNetExtensionUrl )</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">                .Click( &quot;div .globe&quot; )</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">                .Click( $&quot;div .locationsContainer span:contains(&#x27;{country}&#x27;)&quot; )</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">                .Wait( TimeSpan.FromSeconds( 3 ) );</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        private void TurnOnOffBetterNet( bool isTurnOn )</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        {</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">            bool isConnected = I.Open( BetterNetExtensionUrl )</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">                 .Find( &quot;div .button&quot; ).Element.Text == &quot;DISCONNECT&quot;;</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">            if( isTurnOn == isConnected )</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">            {</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">                return;</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">            }</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">            I.Click( isTurnOn ? &quot;div.button.disconnected&quot; : &quot;div.button.connected&quot; )</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">                .Wait( TimeSpan.FromSeconds( 5 ) );</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">}</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><button type="button" aria-label="複製程式碼到剪貼簿" class="copyButton_wuS7 clean-btn">複製</button></div></div><h2 class="anchor anchorWithStickyNavbar_mojV" id="結語">結語<a class="hash-link" href="#結語" title="Direct link to heading">​</a></h2><p>透過這個方法，可以在自動化測試的時候任意切換地區瀏覽同一個網站，判斷是否顯示的內容有依照需求中的定義呈現。</p><p>甚至，也可以突破某些網站的封鎖，順利的存取到網站中的內容喔!!</p><p>以上，希望對大家有幫助。</p><p>最後附上範例的原始碼，請自行取用：</p><p><a href="https://github.com/Ouch1978/AutomationWithChromeExtension" target="_blank" rel="noopener noreferrer"><img loading="lazy" alt="Sample" src="/assets/images/source-code-153869134bfab34cdb0cca6222a56300.png" width="320" height="128"></a></p></section></article><footer class="article__footer padding-top--md margin-top--lg margin-bottom--lg"><div class="col margin-top--sm"><a href="https://github.com/ouch1978/ouch1978.github.io/edit/main/blog/2018-06-28-selenium-automation-with-proxy-extension/2018-06-28-selenium-automation-with-proxy-extension.md" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_dcUD" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>編輯本頁</a></div></footer></div></div></div><div id="disqus_thread"></div><nav class="pagination-nav docusaurus-mt-lg" aria-label="Blog post page navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/blog/2018-11-08-blog-with-jekyll-and-docker"><div class="pagination-nav__sublabel">下一篇</div><div class="pagination-nav__label">透過 Docker 執行 Jekyll 產出部落格文章</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/blog/2018-04-10-fix-skype-update-error-1603"><div class="pagination-nav__sublabel">上一篇</div><div class="pagination-nav__label">解決傳統桌面版 Skype 在更新時出現 1603 &quot;The specified Account already exists&quot; 錯誤</div></a></div></nav></main><div class="col col--2"><div class="tableOfContents_cNA8 thin-scrollbar"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#前言" class="table-of-contents__link toc-highlight">前言</a></li><li><a href="#流程說明" class="table-of-contents__link toc-highlight">流程說明</a><ul><li><a href="#下載-crx-檔" class="table-of-contents__link toc-highlight">下載 .CRX 檔</a></li><li><a href="#取得擴充功能的-id-與網頁路徑" class="table-of-contents__link toc-highlight">取得擴充功能的 Id 與網頁路徑</a></li><li><a href="#在自動化程式中指定-chrome-開啟擴充功能" class="table-of-contents__link toc-highlight">在自動化程式中指定 Chrome 開啟擴充功能</a></li></ul></li><li><a href="#結語" class="table-of-contents__link toc-highlight">結語</a></li></ul></div></div></div></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2022 Ouch1978, Inc. Built with Docusaurus.</div></div></div></footer></div>
<script src="/assets/js/runtime~main.4223f0d5.js"></script>
<script src="/assets/js/main.5ec25d21.js"></script>
</body>
</html>