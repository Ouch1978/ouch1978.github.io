<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
    <id>https://ouch1978.github.io/blog</id>
    <title>OUCH1978@GITHUB Blog</title>
    <updated>2023-12-12T00:00:00.000Z</updated>
    <generator>https://github.com/jpmonette/feed</generator>
    <link rel="alternate" href="https://ouch1978.github.io/blog"/>
    <subtitle>OUCH1978@GITHUB Blog</subtitle>
    <icon>https://ouch1978.github.io/img/favicon.ico</icon>
    <entry>
        <title type="html"><![CDATA[救回桌面版 Skype 的分割模式]]></title>
        <id>https://ouch1978.github.io/blog/2023/12/12/prevent-skype-desktop-from-update-to-keep-split-mode</id>
        <link href="https://ouch1978.github.io/blog/2023/12/12/prevent-skype-desktop-from-update-to-keep-split-mode"/>
        <updated>2023-12-12T00:00:00.000Z</updated>
        <summary type="html"><![CDATA[Skype 自動更新之後... 咦!? 分割模式怎麼又不見了咧!?(為什麼我說又?) 沒了分割模式的 Skype 用起來真的很不習慣，就讓我們把熟悉的分割模式救回來吧!!]]></summary>
        <content type="html"><![CDATA[<h2 class="anchor anchorWithStickyNavbar_LWe7" id="前言">前言<a href="https://ouch1978.github.io/blog/2023/12/12/prevent-skype-desktop-from-update-to-keep-split-mode#%E5%89%8D%E8%A8%80" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h2>
<p>最近心血來潮，想說開一下 Skype 來看看還有沒有什麼朋友在線上。</p>
<p>結果 Skype 自動更新之後... 咦!? 分割模式怎麼又不見了咧!?(為什麼我說又?)</p>
<p>看看隔壁棚的親兒子 Microsoft Teams 都從善如流的加入了分割模式了， Skype 卻是大逆其道而行。</p>
<p>難不成是為了反串，好讓大家跳槽去用 Microsoft Teams 嗎?</p>
<p>沒了分割模式的 Skype 用起來真的很不習慣，就讓我們把熟悉的分割模式救回來吧!!</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="降版到-skype-8960409-版">降版到 Skype 8.96.0.409 版<a href="https://ouch1978.github.io/blog/2023/12/12/prevent-skype-desktop-from-update-to-keep-split-mode#%E9%99%8D%E7%89%88%E5%88%B0-skype-8960409-%E7%89%88" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h2>
<p>目前還殘留著分割模式的 Skype 是 8.96.0.409 版，之後的版本就不再支援分割模式了。</p>
<p>所以第一步當然就是把 Skype 裝回 8.96.0.409 版啦!!</p>
<p>目前 8.96.0.409 版可以透過下面的連結下載：</p>
<p><a href="https://download.skype.com/s4l/download/win/Skype-8.96.0.409.exe" target="_blank" rel="noopener noreferrer" title="Skype-8.96.0.409.exe">Skype-8.96.0.409.exe</a></p>
<p>下載安裝之後，就可以找回分割模式囉!!</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="讓-skype-的自動更新失效">讓 Skype 的自動更新失效<a href="https://ouch1978.github.io/blog/2023/12/12/prevent-skype-desktop-from-update-to-keep-split-mode#%E8%AE%93-skype-%E7%9A%84%E8%87%AA%E5%8B%95%E6%9B%B4%E6%96%B0%E5%A4%B1%E6%95%88" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h2>
<p>但是!!~ 先別高興得太早，一旦觸發到 Skype 的自動更新機制，它就又會更新到不支援分割模式的版本。</p>
<p>所以我們得要多作些事讓 Skype 的自動更新失效：</p>
<ol>
<li>
<p>以檔案總管開啟 <code>%AppData%\Microsoft\Skype for Desktop</code>。</p>
</li>
<li>
<p>把資料夾裡面的 <code>Skype-Setup.exe</code> 更名為 <code>Skype-Setup.exe.bak</code>。</p>
</li>
<li>
<p>建立一個新的資料夾，取名為 <code>Skype-Setup.exe.bak</code>。</p>
</li>
</ol>
<p>重新啟動 Skype 之後，應該會發現更新的功能壞掉了，就算手動按下重試也是會繼續失敗的。</p>
<p>喔耶!! 分割模式真的回來啦!!</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="參考資料">參考資料<a href="https://ouch1978.github.io/blog/2023/12/12/prevent-skype-desktop-from-update-to-keep-split-mode#%E5%8F%83%E8%80%83%E8%B3%87%E6%96%99" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h2>
<ul>
<li><a href="https://answers.microsoft.com/en-us/skype/forum/all/has-skype-again-removed-the-split-view-option/70427fca-f240-43ec-9500-2ed5ffbcc1f0?page=1" target="_blank" rel="noopener noreferrer" title="Has Skype AGAIN removed the &quot;split view&quot; option?">Has Skype AGAIN removed the "split view" option?</a></li>
</ul>]]></content>
        <author>
            <name>Ouch Liu</name>
            <uri>https://github.com/ouch1978</uri>
        </author>
        <category label="Windows" term="Windows"/>
        <category label="偷吃步" term="偷吃步"/>
    </entry>
    <entry>
        <title type="html"><![CDATA[最速搞定 Windows Subsystem for Android 含 Play Store 的懶人包]]></title>
        <id>https://ouch1978.github.io/blog/2023/02/11/easist-way-to-get-wsa-with-play-store-installed</id>
        <link href="https://ouch1978.github.io/blog/2023/02/11/easist-way-to-get-wsa-with-play-store-installed"/>
        <updated>2023-02-11T00:00:00.000Z</updated>
        <summary type="html"><![CDATA[早在 Windows 11 正式推出之前，微軟就多次在各種不同的場合放話說 Windows 11 會支援 Android App。 總算，在 2022 年的 3 月推出了正式版；然而，都已經過了快一年了，台灣的使用者還是看得到吃不到。 這篇就來分享一個我最近找到的懶人包，可以超超超超超快速的搞定 Windows Subsystem for Android，而且連 Play Store 都幫你裝好了。]]></summary>
        <content type="html"><![CDATA[<h2 class="anchor anchorWithStickyNavbar_LWe7" id="前言">前言<a href="https://ouch1978.github.io/blog/2023/02/11/easist-way-to-get-wsa-with-play-store-installed#%E5%89%8D%E8%A8%80" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h2>
<p>早在 Windows 11 正式推出之前，微軟就多次在各種不同的場合放話說 Windows 11 會支援 Android App。</p>
<p>總算，在 2022 年的 3 月推出了正式版；然而，都已經過了快一年了，台灣的使用者還是看得到吃不到。</p>
<p>這篇就來分享一個我最近找到的懶人包，可以超超超超超快速的搞定 Windows Subsystem for Android，而且連 Play Store 都幫你裝好了。</p>
<p><img loading="lazy" alt="通通不用" src="https://ouch1978.github.io/assets/images/no-need-9857cfe542a5c1f8d90f6ec0f4472e2a.png" title="通通不用" width="600" height="395" class="img_ev3q"></p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="免責聲明">免責聲明<a href="https://ouch1978.github.io/blog/2023/02/11/easist-way-to-get-wsa-with-play-store-installed#%E5%85%8D%E8%B2%AC%E8%81%B2%E6%98%8E" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h2>
<div class="theme-admonition theme-admonition-warning admonition_xJq3 alert alert--warning"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 16 16"><path fill-rule="evenodd" d="M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"></path></svg></span>警告</div><div class="admonitionContent_BuS1"><p>"使用非官方管道安裝 Windows Subsystem for Android 有好有壞，後果請自行負責。"<br>
服用前請在心中默念三次。</p></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="環境準備">環境準備<a href="https://ouch1978.github.io/blog/2023/02/11/easist-way-to-get-wsa-with-play-store-installed#%E7%92%B0%E5%A2%83%E6%BA%96%E5%82%99" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h2>
<p>雖然說是懶人包，但是有些步驟和先決條件還是得先搞定的：</p>
<ul>
<li>
<p>Microsoft Store： 22110.1402.6.0 以上版本。</p>
</li>
<li>
<p>記憶體： 8 GB 以上。</p>
</li>
<li>
<p>啟用<code>虛擬機器平台</code>：可以透過 <code>設定</code> -&gt; <code>應用程式</code> -&gt; <code>更多 Windows 功能</code> 把它打開。</p>
</li>
<li>
<p>啟用<code>開發人員模式</code>：可以在 <code>設定</code> -&gt; <code>穩私權與安全性</code> -&gt; <code>開發人員專用</code> 裡面把它打開。</p>
</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="安裝方法">安裝方法<a href="https://ouch1978.github.io/blog/2023/02/11/easist-way-to-get-wsa-with-play-store-installed#%E5%AE%89%E8%A3%9D%E6%96%B9%E6%B3%95" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h2>
<p>直接到下面的連結下載安裝包(可以依照不同平台和是否 root 連行選擇)。</p>
<p><a href="https://ahaan.co.uk/article/top_stories/google-play-store-windows-11-install#download-the-patched,-already-rooted-wsa-packages-or-the-non-root-wsa-packages" target="_blank" rel="noopener noreferrer" title="安裝包列表">安裝包列表</a></p>
<p>解壓縮安裝包之後，以<code>系統管理員權限</code>透過 PowerShell 切換到解壓後的資料夾下執行下列指令即可：</p>
<div class="language-powershell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockTitle_Ktv7">略過執行原則檢查</div><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-powershell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">Set-ExecutionPolicy -Scope Process -ExecutionPolicy Bypass</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="複製程式碼到剪貼簿" title="複製" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<div class="language-powershell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockTitle_Ktv7">進行安裝</div><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-powershell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">.\Install.ps1</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="複製程式碼到�剪貼簿" title="複製" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>安裝成功之後，可以在開始功能表裡面找到 Windows Subsystem for Android Settings 和 Play Store。</p>
<p><img loading="lazy" alt="Windows Subsystem for Android Settings" src="https://ouch1978.github.io/assets/images/windows-subsystem-for-android-settings-13771ad2b3572794f169fe21fc0ea1d2.png" title="Windows Subsystem for Android Settings" width="1200" height="1125" class="img_ev3q"></p>
<p>點開 Play Store 完成登入之後，就可以透過它來安裝 App 囉!!</p>
<p><img loading="lazy" alt="透過 Play Store 安裝 App" src="https://ouch1978.github.io/assets/images/install-apps-with-play-store-d1ca4e9c2c9a13722d377a0d8a0767a9.png" title="透過 Play Store 安裝 App" width="1578" height="1127" class="img_ev3q"></p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="實測">實測<a href="https://ouch1978.github.io/blog/2023/02/11/easist-way-to-get-wsa-with-play-store-installed#%E5%AF%A6%E6%B8%AC" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h2>
<p>我自己實測了下面幾個 App：</p>
<ol>
<li>
<p>Play Store： 可以正常使用，也可以直接透過它安裝 App。</p>
</li>
<li>
<p>Uber Eats： 可以正常使用。
<img loading="lazy" alt="使用 Windows Subsystem for Android 跑起來的 Uber Eats" src="https://ouch1978.github.io/assets/images/uber-eats-b93ba4112c323bc090f99d15a3a8b010.png" title="使用 Windows Subsystem for Android 跑起來的 Uber Eats" width="1599" height="1067" class="img_ev3q"></p>
</li>
<li>
<p>噠噠特攻： 可以正常打開，也可以玩。
<img loading="lazy" alt="使用 Windows Subsystem for Android 跑起來的噠噠特攻" src="https://ouch1978.github.io/assets/images/survival-io-4708b6a1fb257e9942de47bde1ba8667.png" title="使用 Windows Subsystem for Android 跑起來的噠噠特攻" width="919" height="1554" class="img_ev3q"></p>
</li>
<li>
<p>Final Destiny : 可以正常打開，也可以玩。
<img loading="lazy" alt="使用 Windows Subsystem for Android 跑起來的 Final Destiny" src="https://ouch1978.github.io/assets/images/final-destiny-1311fd89c8bf65f4b45578b56375c6bc.png" title="使用 Windows Subsystem for Android 跑起來的 Final Destiny" width="1499" height="942" class="img_ev3q"></p>
</li>
<li>
<p>Random Dice : Defense : 跑到 logging into server 之後會閃退或是卡住。</p>
</li>
<li>
<p>Random Dice : Wars : 跑到 logging into server 之後會閃退或是卡住。</p>
</li>
</ol>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="版本更新">版本更新<a href="https://ouch1978.github.io/blog/2023/02/11/easist-way-to-get-wsa-with-play-store-installed#%E7%89%88%E6%9C%AC%E6%9B%B4%E6%96%B0" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h2>
<p>如果要更新 Windows Subsystem for Android 到更新的版本或是降版的話，也只需要下載安裝包，比照安裝的步驟執行 Install.ps1 即可。</p>
<p>目前我自己測試升版和降版的結果，已經存在的 App 和資料都不會不見喔!!</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="後記">後記<a href="https://ouch1978.github.io/blog/2023/02/11/easist-way-to-get-wsa-with-play-store-installed#%E5%BE%8C%E8%A8%98" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h2>
<p>經過實測，在我的 Surface Laptop Studio 上跑噠噠特攻的時候，會有些微影音不同步的狀況，不過操作起來算是順暢的。</p>
<p>Windows Subsystem for Android Settings 裡面的 GPU used for apps for Android 好像也不用特別去切成實體顯卡，用預設值就蠻順的。</p>
<p>看起來目前對某些 App 的相容性還是不夠高，如果之後完全相容了，市場上的安卓模擬器可能就只剩下例如巨集、一鍵多開、鍵位模擬等特殊功能可以拿出來打了。</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="參考資料">參考資料<a href="https://ouch1978.github.io/blog/2023/02/11/easist-way-to-get-wsa-with-play-store-installed#%E5%8F%83%E8%80%83%E8%B3%87%E6%96%99" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h2>
<ul>
<li><a href="https://ahaan.co.uk/article/top_stories/google-play-store-windows-11-install" target="_blank" rel="noopener noreferrer" title="The Easy Way to Get The Google Play Store Working on Windows 11">The Easy Way to Get The Google Play Store Working on Windows 11</a></li>
</ul>]]></content>
        <author>
            <name>Ouch Liu</name>
            <uri>https://github.com/ouch1978</uri>
        </author>
        <category label="Windows" term="Windows"/>
        <category label="Android" term="Android"/>
        <category label="偷吃步" term="偷吃步"/>
    </entry>
    <entry>
        <title type="html"><![CDATA[透過 Python 取得 Skype 群組的 ID]]></title>
        <id>https://ouch1978.github.io/blog/2022/12/30/get-skype-group-id-with-python</id>
        <link href="https://ouch1978.github.io/blog/2022/12/30/get-skype-group-id-with-python"/>
        <updated>2022-12-30T00:00:00.000Z</updated>
        <summary type="html"><![CDATA[最近在整理部門 Skype 機器人的程式，發現原來透過程式發送訊息給某個群組時只能透過它的 ID 來發送。前人都是透過 Skype Web 搭配開發者工具來擷取 Group ID，我就好奇，難道沒有更聰明一點的方法嗎?]]></summary>
        <content type="html"><![CDATA[<h2 class="anchor anchorWithStickyNavbar_LWe7" id="前言">前言<a href="https://ouch1978.github.io/blog/2022/12/30/get-skype-group-id-with-python#%E5%89%8D%E8%A8%80" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h2>
<p>最近在整理部門 Skype 機器人的程式，發現原來透過程式發送訊息給某個群組時只能透過它的 ID 來發送。</p>
<p>前人都是透過 Skype Web 搭配開發者工具來擷取 Group ID，我就好奇，難道沒有更聰明一點的方法嗎?</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="透過-python-取得所有群組名稱與-id">透過 Python 取得所有群組名稱與 ID<a href="https://ouch1978.github.io/blog/2022/12/30/get-skype-group-id-with-python#%E9%80%8F%E9%81%8E-python-%E5%8F%96%E5%BE%97%E6%89%80%E6%9C%89%E7%BE%A4%E7%B5%84%E5%90%8D%E7%A8%B1%E8%88%87-id" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h2>
<p>這邊可以直接透過 VSCode 進行操作，先建立一個資料夾之後，以 VSCode 開啟。</p>
<p>接著透過終端機(開啟終端機的熱鍵為 <kbd>Ctrl</kbd> + <kbd>`</kbd>)安裝 SkPy 這個套件：</p>
<div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">pip3 install SkPy</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="複製程式碼到剪貼簿" title="複製" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>接著建立一個新檔案如下：</p>
<div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockTitle_Ktv7">SkypeChats.py</div><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># 引用 skpy 套件裡的 Skype 和 SkypeChats</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> skpy </span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> Skype</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> SkypeChats</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># 建立 Skype 連線</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">sk </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> Skype</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">"Skype 帳號"</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">"Skype 密碼"</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># 建立對話物件</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">skc </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> SkypeChats</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">sk</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># 取得最近對話記錄(預設一批只會拿出 10 筆)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">chats </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> skc</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">recent</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># 如果對話記錄筆數 &gt; 0 就執行</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">while</span><span class="token plain"> </span><span class="token builtin">len</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">chats</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">for</span><span class="token plain"> chat </span><span class="token keyword" style="color:#00009f">in</span><span class="token plain"> chats</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">values</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token comment" style="color:#999988;font-style:italic"># 取得群組名稱</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        group_name </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token builtin">getattr</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">chat</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">'topic'</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">'no attr'</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token comment" style="color:#999988;font-style:italic"># 取得群組 ID</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        group_id </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token builtin">getattr</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">chat</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">'id'</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">'no id'</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> group_name </span><span class="token operator" style="color:#393A34">!=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">'no attr'</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token comment" style="color:#999988;font-style:italic"># 如果抓得到群組名稱的話就印出名稱和 ID</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token keyword" style="color:#00009f">print</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">'Group Name:'</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> group_name</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">', Group Id:'</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> group_id</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic"># 取得下一批對話記錄</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    chats </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> skc</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">recent</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="複製程式碼到剪貼簿" title="複製" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>直接給它執行下去，就會把帳號有加入的所有群組名稱和 ID 都列出來囉!!</p>
<p>以上。</p>]]></content>
        <author>
            <name>Ouch Liu</name>
            <uri>https://github.com/ouch1978</uri>
        </author>
        <category label="Windows" term="Windows"/>
        <category label="Skype" term="Skype"/>
        <category label="Python" term="Python"/>
    </entry>
    <entry>
        <title type="html"><![CDATA[解決 Python 在 VSCode 中執行時輸出的中文為亂碼的問題]]></title>
        <id>https://ouch1978.github.io/blog/2022/12/29/solve-vscode-python-utf8-display</id>
        <link href="https://ouch1978.github.io/blog/2022/12/29/solve-vscode-python-utf8-display"/>
        <updated>2022-12-29T00:00:00.000Z</updated>
        <summary type="html"><![CDATA[在使用 VSCode 撰寫 Python 抓取 Skype 對話群組的時候，發現當群組名稱有中文時會噴 UnicodeEncodeError: 'cp950' codec can't encode 這個錯誤訊息，就算在程式中調整了編碼，顯示出來的也還是亂碼...]]></summary>
        <content type="html"><![CDATA[<h2 class="anchor anchorWithStickyNavbar_LWe7" id="前言">前言<a href="https://ouch1978.github.io/blog/2022/12/29/solve-vscode-python-utf8-display#%E5%89%8D%E8%A8%80" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h2>
<p>在使用 VSCode 撰寫 Python 抓取 Skype 對話群組的時候，發現當群組名稱有中文時會噴 UnicodeEncodeError: 'cp950' codec can't encode 這個錯誤訊息。</p>
<p>就算在程式中調整了編碼，顯示出來的也還是亂碼...</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="症狀">症狀<a href="https://ouch1978.github.io/blog/2022/12/29/solve-vscode-python-utf8-display#%E7%97%87%E7%8B%80" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h2>
<p>程式就以下短短一行：</p>
<div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockTitle_Ktv7">UnicodeTest.py</div><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">print</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">'☠我只是想顯示中文啊!!☠'</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="複製程式碼到剪貼簿" title="複製" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>一開始什麼都不作的執行結果如下：
<img loading="lazy" alt="出現 cp950 無法編碼的錯誤" src="https://ouch1978.github.io/assets/images/python-unicode-cp950-encode-error-ec2e58d3cfb0e50613d06357f189a01a.png" title="出現 cp950 無法編碼的錯誤" width="1063" height="397" class="img_ev3q"></p>
<p>在網路上找到有人說可以在程式中指定編碼：</p>
<div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockTitle_Ktv7">UnicodeTest.py</div><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">print</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">'☠我只是想顯示中文啊!!☠'</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">encode</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">"utf-8"</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">decode</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">"cp950"</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">"ignore"</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="複製程式碼到剪貼簿" title="複製" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>指定編碼之後的執行結果如下：
<img loading="lazy" alt="看來還是亂碼啊" src="https://ouch1978.github.io/assets/images/python-cannot-display-utf8-correctly-c901860049431473ec9c6336f76b8e92.png" title="看來還是亂碼啊" width="854" height="520" class="img_ev3q"></p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="解法">解法<a href="https://ouch1978.github.io/blog/2022/12/29/solve-vscode-python-utf8-display#%E8%A7%A3%E6%B3%95" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h2>
<p>開啟 Windows 11 的<code>設定</code> -&gt; <code>時間與語言</code> -&gt; <code>系統管理語言設定</code> -&gt; <code>變更系統地區設定</code>。</p>
<p><img loading="lazy" alt="勾選&amp;quot;Beta:使用 Unicode UTF-8 提供全球語言支援&amp;quot;" src="https://ouch1978.github.io/assets/images/enable-utf-8-worldwide-support-2f4581f2af73798253a3bedbb365678b.png" title="勾選&amp;#39;Beta:使用 Unicode UTF-8 提供全球語言支援&amp;#39;" width="692" height="355" class="img_ev3q"></p>
<p>勾選之後要需要重新啟動，重新啟動之後到<code>設定</code> -&gt; <code>系統</code> -&gt; <code>系統內容</code> -&gt; <code>環境變數</code>。</p>
<p>在系統變數中新增一組名稱為 <code>PYTHONIOENCODING</code> 的系統變數，值為 <code>UTF8</code>。</p>
<p><img loading="lazy" alt="新增 PYTHONIOENCODING 環境變數" src="https://ouch1978.github.io/assets/images/add-python-io-encoding-environment-variable-214c595a10629f5eaa7b5d24c64f360d.png" title="新增 PYTHONIOENCODING 環境變數" width="1027" height="251" class="img_ev3q"></p>
<p>新增完畢之後，重新開啟 VSCode，再執行原來的程式，就可以正常的顯示中文了!!</p>
<p><img loading="lazy" alt="總算可以正常顯示中文了" src="https://ouch1978.github.io/assets/images/display-utf8-correctly-1ee45ba708e6193de8c3cfce88646d67.png" title="總算可以正常顯示中文了" width="628" height="516" class="img_ev3q"></p>]]></content>
        <author>
            <name>Ouch Liu</name>
            <uri>https://github.com/ouch1978</uri>
        </author>
        <category label="Windows" term="Windows"/>
        <category label="VSCode" term="VSCode"/>
        <category label="Python" term="Python"/>
    </entry>
    <entry>
        <title type="html"><![CDATA[啟用 WSL2 下 Ubuntu 的 SSH 遠端連線功能]]></title>
        <id>https://ouch1978.github.io/blog/2022/12/07/enable-ssh-in-ubuntu-on-wsl2</id>
        <link href="https://ouch1978.github.io/blog/2022/12/07/enable-ssh-in-ubuntu-on-wsl2"/>
        <updated>2022-12-07T00:00:00.000Z</updated>
        <summary type="html"><![CDATA[Windows Subsystem for Linux (WSL) 下的 Ubuntu 原本就有內建 SSH 服務，但是預設是關閉的，所以無法從外部連進去。 這篇文章就來分享怎麼設定 SSH 服務，讓它支援從外部透過 SSH 遠端連線進去操作。]]></summary>
        <content type="html"><![CDATA[<h2 class="anchor anchorWithStickyNavbar_LWe7" id="前言">前言<a href="https://ouch1978.github.io/blog/2022/12/07/enable-ssh-in-ubuntu-on-wsl2#%E5%89%8D%E8%A8%80" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h2>
<p>Windows Subsystem for Linux (WSL) 下的 Ubuntu 原本就有內建 SSH 服務，但是預設是關閉的，所以無法從外部連進去。</p>
<p>這篇文章就來分享怎麼設定 SSH 服務，讓它支援從外部透過 SSH 遠端連線進去操作。</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="啟用-ssh-服務">啟用 SSH 服務<a href="https://ouch1978.github.io/blog/2022/12/07/enable-ssh-in-ubuntu-on-wsl2#%E5%95%9F%E7%94%A8-ssh-%E6%9C%8D%E5%8B%99" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h2>
<p>我們可以透過這個指令來察看 SSH 服務的狀態：</p>
<div class="language-sh codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sh codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">service ssh status</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="複製程式碼到剪貼簿" title="複製" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>WSL 下的 Ubuntu 預設是關閉的，所以我們應該會看到 <code>* sshd is not running</code> 這個訊息。</p>
<p>接下來我們可以透過下面這個指令來開啟 SSH 服務：</p>
<div class="language-sh codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sh codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">service ssh start</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="複製程式碼到剪貼簿" title="複製" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>如果沒有意外的話，它應該會因為沒有現成的 SSH Key 存在，所以會出現 <code>sshd: no hostkeys available -- exiting.</code> 這個錯誤訊息。</p>
<p>既然沒有 SSH Key，那就用下面的指令來產一組吧：</p>
<div class="language-sh codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sh codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">ssh-keygen -A</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="複製程式碼到剪貼簿" title="複製" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>產完 SSH Key 之後，再次輸入 <code>service ssh start</code> 開啟 SSH 服務，服務應該就可以正常被啟用了。</p>
<p>不過，如果這時候直接透過 SSH Client 去連的話，會發現無法使用帳號密碼登入。</p>
<p>原來透過帳號密碼登入的功能預設又是被關掉的，所以我們得要再調整 SSH 的設定來啟用它。</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="調整-ssh-服務的設定">調整 SSH 服務的設定<a href="https://ouch1978.github.io/blog/2022/12/07/enable-ssh-in-ubuntu-on-wsl2#%E8%AA%BF%E6%95%B4-ssh-%E6%9C%8D%E5%8B%99%E7%9A%84%E8%A8%AD%E5%AE%9A" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h2>
<p>接著我們可以輸入下面的指令來編輯 SSH 服務的設定檔：</p>
<div class="language-sh codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sh codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">nano /etc/ssh/sshd_config</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="複製程式碼到剪貼簿" title="複製" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>依照不同的需求調整設定檔的內容：</p>
<div class="language-yml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockTitle_Ktv7">/etc/ssh/sshd_config</div><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-yml codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># 允許使用 Root 帳號進行登入</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">PermitRootLogin yes</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># 允許使用公鑰進行登入</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">PubkeyAuthentication yes</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># 允許使用帳號密碼進行登入</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">PasswordAuthentication yes</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="複製程式碼到剪貼簿" title="複製" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<div class="theme-admonition theme-admonition-warning admonition_xJq3 alert alert--warning"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 16 16"><path fill-rule="evenodd" d="M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"></path></svg></span>注意</div><div class="admonitionContent_BuS1"><p>允許使用 Root 帳號進行登入會有一定的風險，開啟前請詳閱 <a href="https://askubuntu.com/questions/16178/why-is-it-bad-to-log-in-as-root" target="_blank" rel="noopener noreferrer" title="Why is it bad to log in as root?">公開說明書</a></p></div></div>
<p>調整完設定之後，請使用下面的指令重新啟動 SSH 服務，讓設定生效。</p>
<div class="language-sh codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sh codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">service ssh restart</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="複製程式碼到剪貼簿" title="複製" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="透過-ssh-client-登入">透過 SSH Client 登入<a href="https://ouch1978.github.io/blog/2022/12/07/enable-ssh-in-ubuntu-on-wsl2#%E9%80%8F%E9%81%8E-ssh-client-%E7%99%BB%E5%85%A5" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h2>
<p>重啟服務之後，就可以用自己順手的 SSH Client 登入看看啦!!</p>
<p>這邊以 XsHell 7 為例，建立一個新的 Session，IP 用預設的 127.0.0.1，Port 維持預設的 22：</p>
<p><img loading="lazy" alt="在 Xshell 建立新的連線" src="https://ouch1978.github.io/assets/images/create-new-session-with-xshell-88083949ecfe41fe667275d70bb6f7c4.png" title="在 Xshell 建立新的連線" width="860" height="829" class="img_ev3q"></p>
<p>輸入完帳號密碼之後按下 Connect 鈕，噹噹~~  搞定!!</p>
<p><img loading="lazy" alt="成功以 SSH Client 登入 WSL2 下的 Ubuntu" src="https://ouch1978.github.io/assets/images/login-ubuntu-on-wsl2-over-ssh-e9959b08a0feb3ad720ddcf8db0a292d.png" title="成功以 SSH Client 登入 WSL2 下的 Ubuntu" width="1431" height="1215" class="img_ev3q"></p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="後記">後記<a href="https://ouch1978.github.io/blog/2022/12/07/enable-ssh-in-ubuntu-on-wsl2#%E5%BE%8C%E8%A8%98" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h2>
<p>其實本文中關於 SSH 服務的設定調整並不只限定只能用在 WSL 下的 Ubuntu，一般的 Ubuntu 也是適用的喔!!</p>
<p>如果有發現無法從遠端透過 SSH Public Key 登入的話，通常也是因為沒有啟用的關係，調整一下設定再重啟 SSH 服務就可以囉!!</p>
<p>以上!!</p>]]></content>
        <author>
            <name>Ouch Liu</name>
            <uri>https://github.com/ouch1978</uri>
        </author>
        <category label="Windows" term="Windows"/>
        <category label="小技巧" term="小技巧"/>
        <category label="WSL2" term="WSL2"/>
    </entry>
    <entry>
        <title type="html"><![CDATA[在 Windows 刪除檔案或資料夾時出現 Source Path Too Long 錯誤的因應措施]]></title>
        <id>https://ouch1978.github.io/blog/2022/12/06/workaround-for-source-path-too-long-when-deleting-folder</id>
        <link href="https://ouch1978.github.io/blog/2022/12/06/workaround-for-source-path-too-long-when-deleting-folder"/>
        <updated>2022-12-06T00:00:00.000Z</updated>
        <summary type="html"><![CDATA[今天在整理 Jenkins 的某個 Workspace 資料夾時，遇到了一個神奇的狀況：當我要刪除 node_modules 資料夾的時候，跳出了'Source Path Too Long'這個錯誤訊息。 就算我用 Ctrl + Del 也沒辦法把整個資料夾刪除。]]></summary>
        <content type="html"><![CDATA[<h2 class="anchor anchorWithStickyNavbar_LWe7" id="前言">前言<a href="https://ouch1978.github.io/blog/2022/12/06/workaround-for-source-path-too-long-when-deleting-folder#%E5%89%8D%E8%A8%80" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h2>
<p>今天在整理 Jenkins 的某個 Workspace 資料夾時，遇到了一個神奇的狀況：</p>
<p>當我要刪除 node_modules 資料夾的時候，跳出了這個錯誤訊息：</p>
<p><img loading="lazy" alt="Source Path Too Long 錯誤" src="https://ouch1978.github.io/assets/images/source-path-too-long-32588be790cbd4c6f9a1a3c39ea50457.png" title="Source Path Too Long 錯誤" width="562" height="237" class="img_ev3q"></p>
<p>就算我用 <kbd>Ctrl</kbd> + <kbd>Del</kbd> 也沒辦法把整個資料夾刪除。</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="因應措施">因應措施<a href="https://ouch1978.github.io/blog/2022/12/06/workaround-for-source-path-too-long-when-deleting-folder#%E5%9B%A0%E6%87%89%E6%8E%AA%E6%96%BD" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h2>
<p>救助了谷哥大神之後，找到一個很神奇的解法 -- 透過壓縮工具的<code>壓縮後刪除檔案</code>功能就可以解決。</p>
<p>我半信半疑的試了之後，發現所言不假，還真的行得通。</p>
<p>以 7-Zip 為例，只需要勾選 Options 裡面的 <code>Delete files after compression</code> 選項，然後進行壓縮，就可以讓它在壓縮完畢之後刪除掉整個資料夾，如下圖：</p>
<p><img loading="lazy" alt="Delete files after compression" src="https://ouch1978.github.io/assets/images/delete-files-after-compression-53206f8ee0eed5ae0d51e2e43bc338e8.png" title="Delete files after compression" width="782" height="784" class="img_ev3q"></p>
<p>比起慢慢縮短檔名或是修改登錄檔、透過 npm 的 rimraf 套件來刪除...等等方法，這個方法的確是快又有效。</p>
<p>另外，據說直接透過 7-Zip 的 GUI 來刪除也行得通，不過我還沒試過就是了。</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="參考資料">參考資料<a href="https://ouch1978.github.io/blog/2022/12/06/workaround-for-source-path-too-long-when-deleting-folder#%E5%8F%83%E8%80%83%E8%B3%87%E6%96%99" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h2>
<ul>
<li>
<p><a href="https://www.techinpost.com/file-path-too-long/" target="_blank" rel="noopener noreferrer" title="Troubleshooting File Path too Long Error Code Problem Issue">Troubleshooting File Path too Long Error Code Problem Issue</a></p>
</li>
<li>
<p><a href="https://www.linglom.com/it-support/fix-source-path-too-long-while-deleting-files/" target="_blank" rel="noopener noreferrer" title="[Fix] Source Path Too Long while deleting files">[Fix] Source Path Too Long while deleting files</a></p>
</li>
<li>
<p><a href="https://coderwall.com/p/alhoww/solving-the-source-path-too-long-ntfs-issue" target="_blank" rel="noopener noreferrer" title="Solving the &quot;source path too long&quot; NTFS issue">Solving the "source path too long" NTFS issue</a></p>
</li>
</ul>]]></content>
        <author>
            <name>Ouch Liu</name>
            <uri>https://github.com/ouch1978</uri>
        </author>
        <category label="Windows" term="Windows"/>
        <category label="Trouble Shooting" term="Trouble Shooting"/>
    </entry>
    <entry>
        <title type="html"><![CDATA[執行 npm login 時出現 Web login not supported 錯誤的因應措施]]></title>
        <id>https://ouch1978.github.io/blog/2022/12/05/workaround-for-npm-web-login-not-support-error</id>
        <link href="https://ouch1978.github.io/blog/2022/12/05/workaround-for-npm-web-login-not-support-error"/>
        <updated>2022-12-05T00:00:00.000Z</updated>
        <summary type="html"><![CDATA[今天在處理把 npm 預設的 registry 改為公司內部的 Nexus Repository 伺服器時，執行到 npm login 這個指令就噴了 `Web login not supported` 這個錯誤。上網一查，原來苦主又不只我一個，看起來是因為 npm 9 之後相容性不同造成的。]]></summary>
        <content type="html"><![CDATA[<h2 class="anchor anchorWithStickyNavbar_LWe7" id="前言">前言<a href="https://ouch1978.github.io/blog/2022/12/05/workaround-for-npm-web-login-not-support-error#%E5%89%8D%E8%A8%80" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h2>
<p>今天在處理把 npm 預設的 registry 改為公司內部的 Nexus Repository 伺服器時，執行到 npm login 這個指令就噴了 <code>Web login not supported</code> 這個錯誤。</p>
<p>上網一查，原來苦主又不只我一個，看起來是因為 Nexus Repository 和 npm 9 之後相容性不同造成的。</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="因應措施">因應措施<a href="https://ouch1978.github.io/blog/2022/12/05/workaround-for-npm-web-login-not-support-error#%E5%9B%A0%E6%87%89%E6%8E%AA%E6%96%BD" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h2>
<p>救助 Google 大神之後，找到兩個解法，不過我目前用第一個方法就成功了。</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="方法一手動編輯-npmrc-檔">方法一：手動編輯 .npmrc 檔<a href="https://ouch1978.github.io/blog/2022/12/05/workaround-for-npm-web-login-not-support-error#%E6%96%B9%E6%B3%95%E4%B8%80%E6%89%8B%E5%8B%95%E7%B7%A8%E8%BC%AF-npmrc-%E6%AA%94" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h3>
<p>以文字編輯器編輯 <code>%UserProfile%\.npmrc</code> 檔：</p>
<div class="language-toml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockTitle_Ktv7">%UserProfile%\.npmrc</div><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-toml codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">registry=https://{你的私有 Repository 路徑}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">always-auth=true</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">//{你的私有 Repository 路徑}:_auth="{你的帳號:你的密碼 的 base64 編碼字串}"</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="複製程式碼到剪貼簿" title="複製" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>例如：</p>
<div class="language-toml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockTitle_Ktv7">%UserProfile%\.npmrc</div><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-toml codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">registry=https://registry.ouch1978.io/repository/npm/</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">always-auth=true</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">//registry.ouch1978.io/repository/npm/:_auth="b3VjaDE5Nzg6bXlUZXN0cGFzc3dvcmQ="</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="複製程式碼到剪貼簿" title="複製" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="方法二加上---auth-typelegacy-參數">方法二：加上 --auth-type=legacy 參數<a href="https://ouch1978.github.io/blog/2022/12/05/workaround-for-npm-web-login-not-support-error#%E6%96%B9%E6%B3%95%E4%BA%8C%E5%8A%A0%E4%B8%8A---auth-typelegacy-%E5%8F%83%E6%95%B8" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h3>
<p>在原來的指令後面加上 <code>--auth-type=legacy</code> 參數即可，例如：</p>
<div class="language-pwsh codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-pwsh codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">npm login --registry https://registry.ouch1978.io/repository/npm/ --auth-type=legacy</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="複製程式碼到剪貼簿" title="複製" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>這個方法比第一個方法來得直覺得多，也方便了許多。</p>
<p>以上。</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="參考資料">參考資料<a href="https://ouch1978.github.io/blog/2022/12/05/workaround-for-npm-web-login-not-support-error#%E5%8F%83%E8%80%83%E8%B3%87%E6%96%99" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h2>
<ul>
<li>
<p><a href="https://clavinjune.dev/en/blogs/npm-login-not-working/" target="_blank" rel="noopener noreferrer" title="NPM Login Not Working">NPM Login Not Working</a></p>
</li>
<li>
<p><a href="https://stackoverflow.com/questions/74482745/npm-login-not-allowing-login-to-github" target="_blank" rel="noopener noreferrer" title="npm login not allowing login to github">npm login not allowing login to github</a></p>
</li>
</ul>]]></content>
        <author>
            <name>Ouch Liu</name>
            <uri>https://github.com/ouch1978</uri>
        </author>
        <category label="Windows" term="Windows"/>
        <category label="Trouble Shooting" term="Trouble Shooting"/>
        <category label="npm" term="npm"/>
    </entry>
    <entry>
        <title type="html"><![CDATA[連線到遠端 Windows Server 時出現 There are no Remote Desktop License Servers available to provide a license 的因應措施]]></title>
        <id>https://ouch1978.github.io/blog/2022/11/23/rdp-no-license-server-error-workaround</id>
        <link href="https://ouch1978.github.io/blog/2022/11/23/rdp-no-license-server-error-workaround"/>
        <updated>2022-11-23T00:00:00.000Z</updated>
        <summary type="html"><![CDATA[最近要透過遠端桌面連線到某一台 Windows Server 時，突然出現這個錯誤訊息： 'The remote session was disconnected because there are no Remote Desktop License Servers available to provide a license' 然後就再也無法從我的電腦連進去了。不過，很神奇的是，有位同事說他沒遇到問題，還是可以從他的電腦遠端連線到同一台 Server...]]></summary>
        <content type="html"><![CDATA[<h2 class="anchor anchorWithStickyNavbar_LWe7" id="前言">前言<a href="https://ouch1978.github.io/blog/2022/11/23/rdp-no-license-server-error-workaround#%E5%89%8D%E8%A8%80" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h2>
<p>最近要透過遠端桌面連線到某一台 Windows Server 時，突然出現下面的錯誤訊息：</p>
<p><img loading="lazy" alt="遠端工作階段已中斷連線，因為沒有可用來提供授權的遠端桌面授權伺服器" src="data:image/png;base64,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" title="遠端工作階段已中斷連線，因為沒有可用來提供授權的遠端桌面授權伺服器" width="697" height="188" class="img_ev3q"></p>
<p>然後就再也無法從我的電腦連進去了。</p>
<p>不過，很神奇的是，有位同事說他沒遇到問題，還是可以從他的電腦遠端連線到同一台 Server...</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="原因">原因<a href="https://ouch1978.github.io/blog/2022/11/23/rdp-no-license-server-error-workaround#%E5%8E%9F%E5%9B%A0" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h2>
<p>會發生這個問題的原因，簡單的說，是因為 Server 上安裝了遠端桌面連線服務功能，而且沒有指定給它使用的授權伺服器。</p>
<p>遠端桌面連線服務預設會提供 120 天的寬限期，等寬限期到期之後又還沒指定授權伺服器給它的話，它就會封鎖非 Local Admin 帳號並且使用 Console 模式的遠端連線。</p>
<p>而我同事還可以連上遠端 Server，就是因為他用的工具是 Remote Desktop Organizer，而且他勾選了 <code>Connect To Console</code> 這個選項。</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="因應措施">因應措施<a href="https://ouch1978.github.io/blog/2022/11/23/rdp-no-license-server-error-workaround#%E5%9B%A0%E6%87%89%E6%8E%AA%E6%96%BD" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="使用-local-admin-帳號搭配-console-模式連線到遠端-server">使用 Local Admin 帳號搭配 Console 模式連線到遠端 Server<a href="https://ouch1978.github.io/blog/2022/11/23/rdp-no-license-server-error-workaround#%E4%BD%BF%E7%94%A8-local-admin-%E5%B8%B3%E8%99%9F%E6%90%AD%E9%85%8D-console-%E6%A8%A1%E5%BC%8F%E9%80%A3%E7%B7%9A%E5%88%B0%E9%81%A0%E7%AB%AF-server" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h3>
<p>前面有提到，非 Local Admin 帳號並且使用 Console 模式的遠端連線會被封鎖，所以我們只要用  Local Admin 帳號搭配 Console 模式來連到遠端 Server 就好啦!!</p>
<p>如果也是習慣使用 Remote Desktop Organizer 管理遠端桌面連線的話，只需要勾選 <code>Connect To Console</code> 這個選項即可。</p>
<p>不過，如果習慣直接使用 Windows 內建的 MSTSC 的話，也可以在命令提示字元輸入 <code>mstsc /help</code> 這個指令的話，就可以看到遠端桌面連線的參數說明如下：</p>
<p><img loading="lazy" alt="遠端桌面連線使用方法" src="https://ouch1978.github.io/assets/images/mstsc-usage-c4c1b569a0a8d748e3d980b6d81e0ee6.png" title="遠端桌面連線使用方法" width="838" height="1214" class="img_ev3q"></p>
<p>所以我們只要用下面的指令就可以用 Console 模式登入到遠端 Server：</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">mstsc /v:{遠端 Server IP} /admin</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="複製程式碼到剪貼簿" title="複製" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="刪除重置授權伺服器的寬限期">刪除/重置授權伺服器的寬限期<a href="https://ouch1978.github.io/blog/2022/11/23/rdp-no-license-server-error-workaround#%E5%88%AA%E9%99%A4%E9%87%8D%E7%BD%AE%E6%8E%88%E6%AC%8A%E4%BC%BA%E6%9C%8D%E5%99%A8%E7%9A%84%E5%AF%AC%E9%99%90%E6%9C%9F" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h3>
<p>只需要在遠端 Server 上使用登錄編輯程式，將 <code>HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Terminal Server\RCM\GracePeriod</code> 裡面的登錄機碼刪除，然後<code>重新開機</code>即可。</p>
<p><img loading="lazy" alt="刪除寬限期登錄機碼" src="https://ouch1978.github.io/assets/images/reset-grace-period-registry-7bde7b809a6d809c0ee9effc6d916b1b.png" title="刪除寬限期登錄機碼" width="1542" height="994" class="img_ev3q"></p>
<div class="theme-admonition theme-admonition-warning admonition_xJq3 alert alert--warning"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 16 16"><path fill-rule="evenodd" d="M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"></path></svg></span>注意事項</div><div class="admonitionContent_BuS1"><ol>
<li>經過實測，也可以直接把 GracePeriod 整個機碼刪除。</li>
<li>在對 GracePeriod 機碼進行操作的時候有可能出現權限不足的錯誤，只需要把它的擁有者改成 Local Administrators 群組並且授與寫入權限就可以解決。</li>
</ol></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="正確的解決之道">正確的解決之道<a href="https://ouch1978.github.io/blog/2022/11/23/rdp-no-license-server-error-workaround#%E6%AD%A3%E7%A2%BA%E7%9A%84%E8%A7%A3%E6%B1%BA%E4%B9%8B%E9%81%93" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h2>
<p>要一勞永逸的解決這個問題的話，有兩種方法：</p>
<ol>
<li>
<p>設定遠端桌面連線授權伺服器： 如果有購買遠端桌面連線授權伺服器的話，當然就直接把它設定上去就好啦!!</p>
<p>設定的方法可以參考 <a href="https://techdirectarchive.com/2021/10/24/how-to-fix-the-issue-the-remote-session-was-disconnected-because-there-are-no-remote-desktop-license-servers-available-to-provide-a-license/" target="_blank" rel="noopener noreferrer" title="How to fix the issue “The remote session was disconnected because there are no Remote Desktop License Servers available to provide a license”">這篇文章</a></p>
</li>
<li>
<p>移除遠端桌面連線服務： 如果沒有購買遠端桌面連線授權伺服器，又不是非得要使用遠端桌面連線服務的功能的話，也可以考慮把相關功能移除即可。</p>
<p><img loading="lazy" alt="透過伺服器管理員移除遠端桌面服務" src="https://ouch1978.github.io/assets/images/remove-remote-desktop-service-34ab6e3dc8ffa8f6d31b835228162f16.png" title="透過伺服器管理員移除遠端桌面服務" width="1541" height="993" class="img_ev3q"></p>
<p>除了使用 UI 之外，也可以透過 PowerShell 下指令來移除，指令如下：</p>
<div class="language-powershell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-powershell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">Uninstall-WindowsFeature -name Remote-Desktop-Services -includemanagementtools -confirm</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="複製程式碼到剪貼簿" title="複製" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
</ol>
<div class="theme-admonition theme-admonition-warning admonition_xJq3 alert alert--warning"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 16 16"><path fill-rule="evenodd" d="M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"></path></svg></span>注意事項</div><div class="admonitionContent_BuS1"><p>我分別透過伺服器管理員 UI 和 PowerShell 去移除遠端桌面連線服務，但是都在重新開機之後就失敗了，不知道裡面到底是有什麼巫術。
只能說，除非你有授權伺服器可以用，不然如果沒必要的話，還是別裝這個服務來整自己啊!!</p></div></div>]]></content>
        <author>
            <name>Ouch Liu</name>
            <uri>https://github.com/ouch1978</uri>
        </author>
        <category label="Windows" term="Windows"/>
        <category label="Trouble Shooting" term="Trouble Shooting"/>
    </entry>
    <entry>
        <title type="html"><![CDATA[.NET Framework 專案出現找不到 SQLite.Interop.dll 的因應措施]]></title>
        <id>https://ouch1978.github.io/blog/2022/11/10/fix-sqlite-interop-dll-missing</id>
        <link href="https://ouch1978.github.io/blog/2022/11/10/fix-sqlite-interop-dll-missing"/>
        <updated>2022-11-10T00:00:00.000Z</updated>
        <summary type="html"><![CDATA[同一個有引用 System.Data.SQLite 的專案，在某些人的電腦會出現找不到 SQLite.Interop.dll 的問題，有的人不會。這篇就來分享如果電腦出現找不到 SQLite.Interop.dll 錯誤訊息的因應之道。]]></summary>
        <content type="html"><![CDATA[<h2 class="anchor anchorWithStickyNavbar_LWe7" id="前言">前言<a href="https://ouch1978.github.io/blog/2022/11/10/fix-sqlite-interop-dll-missing#%E5%89%8D%E8%A8%80" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h2>
<p>之前有同事問我一個問題，說都是同一個 Repo，在某些人的電腦會出現找不到 SQLite.Interop.dll，但是其他人就正常。</p>
<p>而且印象中這種問題很久之前好像出現過，然後最近又出現了。</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="原因">原因<a href="https://ouch1978.github.io/blog/2022/11/10/fix-sqlite-interop-dll-missing#%E5%8E%9F%E5%9B%A0" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h2>
<p>簡單的說，當我們透過 NuGet 安裝 System.Data.SQLite.Core 時，我們的 csproj 會自動被加上下面這幾行：</p>
<div class="language-xml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockTitle_Ktv7">xxx.csproj</div><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-xml codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">Import</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">Project</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">"</span><span class="token tag attr-value" style="color:#e3116c">..\packages\Stub.System.Data.SQLite.Core.NetFramework.1.0.115.5\build\net46\Stub.System.Data.SQLite.Core.NetFramework.targets</span><span class="token tag attr-value punctuation" style="color:#393A34">"</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">Condition</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">"</span><span class="token tag attr-value" style="color:#e3116c">Exists('..\packages\Stub.System.Data.SQLite.Core.NetFramework.1.0.115.5\build\net46\Stub.System.Data.SQLite.Core.NetFramework.targets')</span><span class="token tag attr-value punctuation" style="color:#393A34">"</span><span class="token tag" style="color:#00009f"> </span><span class="token tag punctuation" style="color:#393A34">/&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">Target</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">Name</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">"</span><span class="token tag attr-value" style="color:#e3116c">EnsureNuGetPackageBuildImports</span><span class="token tag attr-value punctuation" style="color:#393A34">"</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">BeforeTargets</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">"</span><span class="token tag attr-value" style="color:#e3116c">PrepareForBuild</span><span class="token tag attr-value punctuation" style="color:#393A34">"</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">PropertyGroup</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">ErrorText</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">This project references NuGet package(s) that are missing on this computer. Use NuGet Package Restore to download them.  For more information, see http://go.microsoft.com/fwlink/?LinkID=322105. The missing file is {0}.</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">ErrorText</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">PropertyGroup</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">Error</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">Condition</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">"</span><span class="token tag attr-value" style="color:#e3116c">!Exists('..\packages\Stub.System.Data.SQLite.Core.NetFramework.1.0.115.5\build\net46\Stub.System.Data.SQLite.Core.NetFramework.targets')</span><span class="token tag attr-value punctuation" style="color:#393A34">"</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">Text</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">"</span><span class="token tag attr-value" style="color:#e3116c">$([System.String]::Format('$(ErrorText)', '..\packages\Stub.System.Data.SQLite.Core.NetFramework.1.0.115.5\build\net46\Stub.System.Data.SQLite.Core.NetFramework.targets'))</span><span class="token tag attr-value punctuation" style="color:#393A34">"</span><span class="token tag" style="color:#00009f"> </span><span class="token tag punctuation" style="color:#393A34">/&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">Target</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="複製程式碼到剪貼簿" title="複製" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>在正常的情況下，這幾行會在進行建置的時候，連結到 <code>..\packages\Stub.System.Data.SQLite.Core.NetFramework.1.0.115.5\build\net46\Stub.System.Data.SQLite.Core.NetFramework.targets</code> 檔。</p>
<p>MSBuild 會透過 Stub.System.Data.SQLite.Core.NetFramework.targets 裡面已經定義好的內容，自動把 x86\SQLite.Interop.dll 或是 x64\SQLite.Interop.dll 複製到 bin 資料夾下。</p>
<p>不過，如果我們的電腦環境或是 VS 沒有乖乖照著作，那兩個檔自然就不會出現了。</p>
<p>造成不如預期的可能性有很多，例如權限不足、檔案損毀、微軟的 Bug、MSBuild 安裝不完整... 等等，就先不一一深究了。</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="解法">解法<a href="https://ouch1978.github.io/blog/2022/11/10/fix-sqlite-interop-dll-missing#%E8%A7%A3%E6%B3%95" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="解法一將專案的-platform-target-改為-x86-或-x64而不要使用-any-cpu">解法一：將專案的 Platform target 改為 x86 或 x64，而不要使用 Any CPU<a href="https://ouch1978.github.io/blog/2022/11/10/fix-sqlite-interop-dll-missing#%E8%A7%A3%E6%B3%95%E4%B8%80%E5%B0%87%E5%B0%88%E6%A1%88%E7%9A%84-platform-target-%E6%94%B9%E7%82%BA-x86-%E6%88%96-x64%E8%80%8C%E4%B8%8D%E8%A6%81%E4%BD%BF%E7%94%A8-any-cpu" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h3>
<p>這個是比較暴力一點的解法，而且網路上還真的不少人建議用這個解法，不過我個人比較不建議用這個方法。</p>
<p>除非我們很確定我們的程式永遠只會在同一種架構上跑。</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="解法二直接把-sqliteinteropdll-視為-content-並且加到專案中">解法二：直接把 SQLite.Interop.dll 視為 Content 並且加到專案中<a href="https://ouch1978.github.io/blog/2022/11/10/fix-sqlite-interop-dll-missing#%E8%A7%A3%E6%B3%95%E4%BA%8C%E7%9B%B4%E6%8E%A5%E6%8A%8A-sqliteinteropdll-%E8%A6%96%E7%82%BA-content-%E4%B8%A6%E4%B8%94%E5%8A%A0%E5%88%B0%E5%B0%88%E6%A1%88%E4%B8%AD" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h3>
<p>第二個方法就很直覺了，直接把 packages\Stub.System.Data.SQLite.Core.NetFramework.1.0.115.5\build\net46 下的 x86 和 x64 資料夾複製到我們的專案下，並且把檔案的類型設為 <code>Content</code>， CopyToOutputDirectory 屬性設為 <code>Always</code>。</p>
<p>也就直接把原本會自動完成的事改成手動解決，但是升版 SQLite 的時候就得要再手動作一次。</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="解法三修改-csproj-檔強制觸發-systemdatasqlitecoretargets-中定義的內容">解法三：修改 csproj 檔，強制觸發 System.Data.SQLite.Core.targets 中定義的內容<a href="https://ouch1978.github.io/blog/2022/11/10/fix-sqlite-interop-dll-missing#%E8%A7%A3%E6%B3%95%E4%B8%89%E4%BF%AE%E6%94%B9-csproj-%E6%AA%94%E5%BC%B7%E5%88%B6%E8%A7%B8%E7%99%BC-systemdatasqlitecoretargets-%E4%B8%AD%E5%AE%9A%E7%BE%A9%E7%9A%84%E5%85%A7%E5%AE%B9" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h3>
<p>這個方法是我個人比較建議的作法，在 csproj 檔中加入下面的內容：</p>
<div class="language-xml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockTitle_Ktv7">xxx.csproj</div><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-xml codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">PropertyGroup</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"> </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">ContentSQLiteInteropFiles</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">true</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">ContentSQLiteInteropFiles</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">CopySQLiteInteropFiles</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">false</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">CopySQLiteInteropFiles</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">CleanSQLiteInteropFiles</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">false</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">CleanSQLiteInteropFiles</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">CollectSQLiteInteropFiles</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">false</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">CollectSQLiteInteropFiles</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">PropertyGroup</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="複製程式碼到剪貼簿" title="複製" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>這樣 MSBuild 就會在進行專案建置的時候，自動進行解法二的動作。</p>
<div class="theme-admonition theme-admonition-tip admonition_xJq3 alert alert--success"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 12 16"><path fill-rule="evenodd" d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"></path></svg></span>提示</div><div class="admonitionContent_BuS1"><p>其實上面這幾個動作都被定義在 System.Data.SQLite.Core.targets 裡面，有興趣的話也不妨撥空看看裡面的內容喔。</p></div></div>
<p>以上。</p>]]></content>
        <author>
            <name>Ouch Liu</name>
            <uri>https://github.com/ouch1978</uri>
        </author>
        <category label=".NET" term=".NET"/>
        <category label="NuGet" term="NuGet"/>
        <category label="C#" term="C#"/>
    </entry>
    <entry>
        <title type="html"><![CDATA[Jenkins 會在 Git 的 SSH 路徑加上多餘斜線的因應解法]]></title>
        <id>https://ouch1978.github.io/blog/2022/11/03/jenkins-extraneous-slash-in-ssh-path-workaround</id>
        <link href="https://ouch1978.github.io/blog/2022/11/03/jenkins-extraneous-slash-in-ssh-path-workaround"/>
        <updated>2022-11-03T00:00:00.000Z</updated>
        <summary type="html"><![CDATA[最近在把 Jenkins 裡透過 Git 拉 Repository 的路徑從 HTTPS 改成 SSH，不過發生了一件神奇的事：居然 SSH:// 會被改成 SSH:///。]]></summary>
        <content type="html"><![CDATA[<h2 class="anchor anchorWithStickyNavbar_LWe7" id="前言">前言<a href="https://ouch1978.github.io/blog/2022/11/03/jenkins-extraneous-slash-in-ssh-path-workaround#%E5%89%8D%E8%A8%80" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h2>
<p>最近在把 Jenkins 裡透過 Git 拉 Repository 的路徑從 HTTPS 改成 SSH，不過發生了一件神奇的事：</p>
<p>原本在 Jenkins 裡設定好的 Git Repo 路徑居然會被 Jenkins 從 SSH:// 改成 SSH:/// 硬生生的多了一條斜線。</p>
<p>舉例來說，我原本輸入的網址是 SSH://gitlab.ouch1978.com:22/test/my-test-repository.git。</p>
<p>但是 Jenkins 就會幫我把我的 .git/config 裡的 URL 改成 SSH:///gitlab.ouch1978.com:22/test/my-test-repository.git。</p>
<p>當然， Repository 就拉不下來了。</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="是誰搞的鬼">是誰搞的鬼?<a href="https://ouch1978.github.io/blog/2022/11/03/jenkins-extraneous-slash-in-ssh-path-workaround#%E6%98%AF%E8%AA%B0%E6%90%9E%E7%9A%84%E9%AC%BC" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h2>
<p>上網 Google 了一番，原來我又不孤單了，有其他人也有遇到相同的問題：</p>
<ul>
<li><a href="https://stackoverflow.com/questions/27786733/why-is-the-git-plugin-for-jenkins-rewriting-my-local-git-repo-url-with-extra-sla" target="_blank" rel="noopener noreferrer" title="Why is the Git Plugin for Jenkins rewriting my local git repo url with extra slashes?">Why is the Git Plugin for Jenkins rewriting my local git repo url with extra slashes?</a></li>
</ul>
<p>原來這個問題早在 2015 年就發生過，而且還有回報到 Jenkins 的 Issues 系統裡，而且級別是 Major：</p>
<ul>
<li><a href="https://issues.jenkins.io/browse/JENKINS-26680?page=com.atlassian.jira.plugin.system.issuetabpanels%3Acomment-tabpanel&amp;showAll=true" target="_blank" rel="noopener noreferrer" title="Extraneous Forward-Slash in ssh:// path to repository">Extraneous Forward-Slash in ssh:// path to repository</a></li>
</ul>
<p>不過一直到今天，這張問題單的狀態還是未解決，在 2019 年和 2021 年都還有苦主上去留言。</p>
<p>還有另一張相似的問題單：</p>
<ul>
<li><a href="https://issues.jenkins.io/browse/JENKINS-27483" target="_blank" rel="noopener noreferrer" title="Repository URL containg double points couldn't be resolved correctly.">Repository URL containg double points couldn't be resolved correctly.</a></li>
</ul>
<p>這張就直接把兇手指向了 Jenkins 的 Git Plugin，說如果網址內包含冒號的話就會有問題，而且這張單直接被標為 Won't Fix。</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="解法">解法<a href="https://ouch1978.github.io/blog/2022/11/03/jenkins-extraneous-slash-in-ssh-path-workaround#%E8%A7%A3%E6%B3%95" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h2>
<p>在 StackOverflow 和 Jenkins 的 Issues 系統裡也有不少熱心人士提供了不同的解決方法。</p>
<p>而我最後採用的思路是依照上述第二張問題單裡面提到的：<code>如果網址內包含冒號就會有問題</code> 這個論點。</p>
<p>那我的網址不要出現冒號不就好囉?</p>
<p>所以我在 .ssh/config 裡動了一些手腳：</p>
<div class="language-diff codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockTitle_Ktv7">~/.ssh/config</div><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-diff codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">-Host gitlab.ouch1978.com </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">+Host gitlab                      </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   HostName gitlab.ouch1978.com </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   AddKeysToAgent yes</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   PreferredAuthentications publickey</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   User git</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   IdentityFile ~/.ssh/id_ed25519_gitlab</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">+   Port 22 </span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="複製程式碼到剪貼簿" title="複製" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>如此一來，我的 Repository URL 就可以縮短成這樣：</p>
<p><code>git@gitlab:/test/my-test-repository.git</code></p>
<p>就不會再出現神奇的三條斜線啦!!</p>
<p>希望能幫到跟我一樣的苦主。</p>]]></content>
        <author>
            <name>Ouch Liu</name>
            <uri>https://github.com/ouch1978</uri>
        </author>
        <category label="CI/CD" term="CI/CD"/>
        <category label="DevOps" term="DevOps"/>
        <category label="ALM" term="ALM"/>
    </entry>
    <entry>
        <title type="html"><![CDATA[篩選 Redis Key 的正確姿勢]]></title>
        <id>https://ouch1978.github.io/blog/2022/10/29/correct-way-to-fileter-redis-key</id>
        <link href="https://ouch1978.github.io/blog/2022/10/29/correct-way-to-fileter-redis-key"/>
        <updated>2022-10-29T00:00:00.000Z</updated>
        <summary type="html"><![CDATA[還記得很久很久之前，曾經有一個同事來問我：為什麼我只是一句去查 Redis Key 的語法，程式都沒改過，但是卻越跑越慢?  一看他的程式碼，發現原來他用 LINQ 來過濾 Redis 的 Key...]]></summary>
        <content type="html"><![CDATA[<h2 class="anchor anchorWithStickyNavbar_LWe7" id="前言">前言<a href="https://ouch1978.github.io/blog/2022/10/29/correct-way-to-fileter-redis-key#%E5%89%8D%E8%A8%80" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h2>
<p>還記得很久很久之前，曾經有一個同事來問我：為什麼我只是一句去查 Redis Key 的語法，程式都沒改過，但是卻越跑越慢?</p>
<p>一看他的程式碼，發現原來他用 LINQ 來過濾 Redis 的 Key...</p>
<p>有經驗的朋友應該看到這邊就知道發生了什麼事。</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="需求">需求<a href="https://ouch1978.github.io/blog/2022/10/29/correct-way-to-fileter-redis-key#%E9%9C%80%E6%B1%82" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h2>
<p>當初只是很單純的要實作一個透過 Redis 中的 Key 來判斷資料是否存在的簡單功能。</p>
<p>如果使用 Redis 存放 Session Key 的話應該也會使用到類似的功能。</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="有問題的程式碼">有問題的程式碼<a href="https://ouch1978.github.io/blog/2022/10/29/correct-way-to-fileter-redis-key#%E6%9C%89%E5%95%8F%E9%A1%8C%E7%9A%84%E7%A8%8B%E5%BC%8F%E7%A2%BC" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h2>
<p>程式碼很簡單，就只有短短幾行：</p>
<div class="language-csharp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockTitle_Ktv7">MainWindow.xaml.cs</div><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-csharp codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">   var keys = _server.Keys()</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">         .Where(x =&gt; Regex.IsMatch(x, "Test_By_Ouch_*"))</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">         .ToList();</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="複製程式碼到剪貼簿" title="複製" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>我們可以先來看看原本的寫法和修改過後寫法的效能比較：</p>
<p><img loading="lazy" alt="修改程式碼前後的效能比較" src="https://ouch1978.github.io/assets/images/the-performance-before-and-after-using-filter-fe08645dca340809bb4041c1dcd7ef4a.png" title="修改程式碼前後的效能比較" width="1220" height="695" class="img_ev3q"></p>
<p>讀取接近十二萬筆的 Key 時，使用原來的程式碼大約會花上 0.52 秒的時間。</p>
<p>但是如果改用 Filter 的作法，則可以縮短到 0.15 秒以內完成，效能差到三倍以上</p>
<p>我之前測出來的結果，還曾經差到十五倍以上。</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="問題在哪兒">問題在哪兒?<a href="https://ouch1978.github.io/blog/2022/10/29/correct-way-to-fileter-redis-key#%E5%95%8F%E9%A1%8C%E5%9C%A8%E5%93%AA%E5%85%92" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h2>
<p>簡單的說，原本的寫法會把所有的 Key 一次撈回本機，再透過 LINQ 進行過濾。</p>
<p>當資料量變大，變慢的情況就會越明顯。</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="正確的姿勢">正確的姿勢<a href="https://ouch1978.github.io/blog/2022/10/29/correct-way-to-fileter-redis-key#%E6%AD%A3%E7%A2%BA%E7%9A%84%E5%A7%BF%E5%8B%A2" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h2>
<p>其實 StackExchange.Redis 的 IServer.Keys API 原本就內建 Key filter 的功能。</p>
<p>我們只要簡單的把程式改成下面這樣：</p>
<div class="language-csharp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockTitle_Ktv7">MainWindow.xaml.cs</div><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-csharp codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">   var keys = _server.Keys(pattern: "Test_By_Ouch_*", pageSize: pageSize)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">         .ToList();</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="複製程式碼到剪貼簿" title="複製" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>就可以比原來的寫法效能好三倍以上。</p>
<p>因為它會直接在 Server 上就進行篩選，而不是把全部的 Key 都撈下來才進行篩選。</p>
<p>這邊需要再特別注意的是 page size 參數，因為 Keys API 實際上會透過 Key Scan 來尋找符合條件的 Key。</p>
<p>Page size 的預設值是 10，在資料筆數越多的情況下，使用預設值就會讓整個查詢變得更慢。</p>
<p>至於 Page size 有沒有什麼最佳的設定值呢?</p>
<p>作者說：</p>
<blockquote>
<p>不要使用 Key Scan!!
不要使用 Key Scan!!
不要使用 Key Scan!!</p>
</blockquote>
<p>(很重要，所以要說三次)</p>
<p>除非你很清楚的知道使用 Key Scan 對 Server 的影響，不然這種寫法還是儘量避開為妙。</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="後記">後記<a href="https://ouch1978.github.io/blog/2022/10/29/correct-way-to-fileter-redis-key#%E5%BE%8C%E8%A8%98" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h2>
<p>當初，問我的同事一再強調，這個功能本來都是好的，但是不知道為什麼就越來越慢了。</p>
<p>我只能說，<code>用對的方法做事比把事情做對還重要</code>。(雖然我也常常犯蠢啦~~)</p>
<p>再來，即便 LINQ 已經不是什麼新玩意兒了，不過對於新手來說，還是很容易踩到雷(我以前也曾經踩得嫑嫑的啊~~)。</p>
<p>之後再來整理一篇使用 LINQ 時該注意的事項跟大家分享。</p>
<p>最後一樣附上範例的程式碼，歡迎有興趣的同學自行取用：</p>
<p><a href="https://github.com/Ouch1978/RedisKeyFilterSample" target="_blank" rel="noopener noreferrer" title="Redis Key 搜尋範例"><img loading="lazy" alt="Redis Key 搜尋範例" src="https://ouch1978.github.io/assets/images/source-code-153869134bfab34cdb0cca6222a56300.png" width="320" height="128" class="img_ev3q"></a></p>]]></content>
        <author>
            <name>Ouch Liu</name>
            <uri>https://github.com/ouch1978</uri>
        </author>
        <category label="C#" term="C#"/>
        <category label="Redis" term="Redis"/>
        <category label="程式設計" term="程式設計"/>
    </entry>
    <entry>
        <title type="html"><![CDATA[在 VSCode 裡顯示隱藏的資料夾和檔案]]></title>
        <id>https://ouch1978.github.io/blog/2022/10/10/show-hidden-items-in-vscode</id>
        <link href="https://ouch1978.github.io/blog/2022/10/10/show-hidden-items-in-vscode"/>
        <updated>2022-10-10T00:00:00.000Z</updated>
        <summary type="html"><![CDATA[VSCode 預設不會顯示某些特定的資料夾和檔案，例如 .git 資料夾、 .svn 資料夾等等。 以一個 IDE 來講，不顯示這些資料夾都是很合情合理的，但是作為一個文字編輯器來看的話，這些資料夾不顯示的話就怪怪的了。 所以這篇就來分享一下讓 VSCode 顯示預設隱藏的資料夾或檔案的方法。]]></summary>
        <content type="html"><![CDATA[<h2 class="anchor anchorWithStickyNavbar_LWe7" id="前言">前言<a href="https://ouch1978.github.io/blog/2022/10/10/show-hidden-items-in-vscode#%E5%89%8D%E8%A8%80" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h2>
<p>VSCode 預設不會顯示某些特定的資料夾和檔案，例如 .git 資料夾、 .svn 資料夾等等。</p>
<p>以一個 IDE 來講，不顯示這些資料夾都是很合情合理的，但是作為一個文字編輯器來看的話，這些資料夾不顯示的話就怪怪的了。</p>
<p>所以這篇就來分享一下讓 VSCode 顯示預設隱藏的資料夾或檔案的方法。</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="修改排除檔案清單">修改排除檔案清單<a href="https://ouch1978.github.io/blog/2022/10/10/show-hidden-items-in-vscode#%E4%BF%AE%E6%94%B9%E6%8E%92%E9%99%A4%E6%AA%94%E6%A1%88%E6%B8%85%E5%96%AE" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h2>
<p>按下 <kbd>Ctrl</kbd> + <kbd>,</kbd> 開啟設定頁。</p>
<p>接著在搜尋框中輸入 <code>files.exclude</code>，就會出現排除的檔案清單：</p>
<p><img loading="lazy" alt="搜尋排除檔案清單" src="https://ouch1978.github.io/assets/images/search-for-files-exclude-settings-64c9ed11d0e0bbd9e9771f4edd8cc26e.png" title="搜尋排除檔案清單" width="1755" height="639" class="img_ev3q"></p>
<p>然後把我們想要顯示的項目從清單裡刪除。</p>
<p>例如我希望 .git 資料夾不要被隱藏，就按下 <code>**/.git</code> 項目右邊的 <code>X</code> 號。</p>
<p>如此一來， .git 資料夾就會顯示出來了。</p>
<p><img loading="lazy" alt="調整設定後，.git 資料夾顯示出來了" src="https://ouch1978.github.io/assets/images/git-foler-appearing-after-settings-changed-c718d7183f1c46aea67a38837305b456.png" title="調整設定後，.git 資料夾顯示出來了" width="2400" height="1554" class="img_ev3q"></p>
<p>就這麼簡單。</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="透過擴充套件動態調整顯示隱藏特定資料夾和檔案">透過擴充套件動態調整顯示/隱藏特定資料夾和檔案<a href="https://ouch1978.github.io/blog/2022/10/10/show-hidden-items-in-vscode#%E9%80%8F%E9%81%8E%E6%93%B4%E5%85%85%E5%A5%97%E4%BB%B6%E5%8B%95%E6%85%8B%E8%AA%BF%E6%95%B4%E9%A1%AF%E7%A4%BA%E9%9A%B1%E8%97%8F%E7%89%B9%E5%AE%9A%E8%B3%87%E6%96%99%E5%A4%BE%E5%92%8C%E6%AA%94%E6%A1%88" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h2>
<p>如果我們希望能透過 UI 開關是否顯示隱藏資料夾或是檔案呢?</p>
<p>例如有時候我就是不想看到 node_modules、build 和 .docusaurus 資料夾，有時候又想看到它。</p>
<p>那 <a href="https://marketplace.visualstudio.com/items?itemName=amodio.toggle-excluded-files" target="_blank" rel="noopener noreferrer" title="Toggle Excluded Files">Toggle Excluded Files</a> 這個擴充套件就很適合我們。</p>
<p>它用起來的效果像下圖這樣：</p>
<p><img loading="lazy" alt="開啟/關閉排除檔案效果" src="https://ouch1978.github.io/assets/images/toggle-excluded-files-effect-1e510bf85b5d29bb89bcabfdc24b321a.gif" title="開啟/關閉排除檔案效果" width="1546" height="1160" class="img_ev3q"></p>
<p>是不是很方便啊?</p>
<p>以上。</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="參考資料">參考資料<a href="https://ouch1978.github.io/blog/2022/10/10/show-hidden-items-in-vscode#%E5%8F%83%E8%80%83%E8%B3%87%E6%96%99" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h2>
<ul>
<li><a href="https://linuxpip.org/vscode-show-hidden-files/" target="_blank" rel="noopener noreferrer" title="Show hidden files in VSCode">Show hidden files in VSCode</a></li>
</ul>]]></content>
        <author>
            <name>Ouch Liu</name>
            <uri>https://github.com/ouch1978</uri>
        </author>
        <category label="Windows" term="Windows"/>
        <category label="小技巧" term="小技巧"/>
        <category label="VSCode" term="VSCode"/>
    </entry>
    <entry>
        <title type="html"><![CDATA[快速搞定在 Windows 裡透過 SSH 通訊協定存取 GitLab 的 Repository]]></title>
        <id>https://ouch1978.github.io/blog/2022/10/09/quick-guide-to-use-git-with-ssh</id>
        <link href="https://ouch1978.github.io/blog/2022/10/09/quick-guide-to-use-git-with-ssh"/>
        <updated>2022-10-09T00:00:00.000Z</updated>
        <summary type="html"><![CDATA[雖然說 Git 一直以來都支援 HTTPS 和 SSH 這兩種通訊協定，不過近年來不論是 GitHub 還是 GitLab 都建議使用 SSH 來存取 Repository。 這篇文章就分享一下在 Windows 上快速設定使用 SSH 存取 GitLab Repository 的方法。]]></summary>
        <content type="html"><![CDATA[<h2 class="anchor anchorWithStickyNavbar_LWe7" id="前言">前言<a href="https://ouch1978.github.io/blog/2022/10/09/quick-guide-to-use-git-with-ssh#%E5%89%8D%E8%A8%80" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h2>
<p>雖然說 Git 一直以來都支援 HTTPS 和 SSH 這兩種通訊協定，不過近年來不論是 GitHub 還是 GitLab 都建議使用 SSH 來存取 Repository。</p>
<p>這篇文章就分享一下在 Windows 上快速設定使用 SSH 存取 GitLab Repository 的方法。</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="事前準備">事前準備<a href="https://ouch1978.github.io/blog/2022/10/09/quick-guide-to-use-git-with-ssh#%E4%BA%8B%E5%89%8D%E6%BA%96%E5%82%99" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h2>
<p>在繼續之前，請先確認電腦已經安裝好下列工具：</p>
<ol>
<li>Git for Windows (建議使用預設安裝，包含 Git Bash 和 SSH 等工具)。</li>
<li>VSCode 或是 NotePad++ 等文字檔編輯工具(用來批次把原來使用 HTTPS 通訊協定的 Repo 改成使用 SSH)。</li>
</ol>
<p>另外，請把 GitLab 的 URL、你的 Email、可以存取 API 的 Personal Access Token 先記在方便取用的文字檔或是剪貼簿裡。</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="廢話不多說開工">廢話不多說，開工<a href="https://ouch1978.github.io/blog/2022/10/09/quick-guide-to-use-git-with-ssh#%E5%BB%A2%E8%A9%B1%E4%B8%8D%E5%A4%9A%E8%AA%AA%E9%96%8B%E5%B7%A5" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h2>
<p>接著，請照下面步驟操作(大部份指令都可以直接照抄就好)。</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="透過-ssh-keygen-產出公鑰和私鑰">透過 SSH-Keygen 產出公鑰和私鑰<a href="https://ouch1978.github.io/blog/2022/10/09/quick-guide-to-use-git-with-ssh#%E9%80%8F%E9%81%8E-ssh-keygen-%E7%94%A2%E5%87%BA%E5%85%AC%E9%91%B0%E5%92%8C%E7%A7%81%E9%91%B0" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h3>
<div class="theme-admonition theme-admonition-warning admonition_xJq3 alert alert--warning"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 16 16"><path fill-rule="evenodd" d="M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"></path></svg></span>警告</div><div class="admonitionContent_BuS1"><ol>
<li>有些人會建議不要設定金鑰的 Passphrase，免得之後每次都要輸入，但是其實我們可以透過 SSH Agent 來解決這個問題。
基於安全性考量，這邊還是建議大家不要省略這個重要的步驟，畢竟我們還是不會希望金鑰被別人拿去使用。</li>
<li>這邊為了方便，會自動產生 Passphrase，請各位複製之後妥善保存，或是使用自己喜歡的密碼。</li>
</ol></div></div>
<p>我寫了一個 Script 可以直接在 Git Bash 裡執行，內容如下：</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockTitle_Ktv7">gen_ssh_key.sh</div><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">#!/bin/bash</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#產生 Passphrase 並且存入環境變數</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">export MY_PASSPHRASE=$(&lt; /dev/urandom tr -dc _A-Z-a-z-0-9 | head -c8)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#輸入你在 GitLab 中使用的 Email</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">read -p '請輸入您在 GitLab 登記的信箱： ' email</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#產出公、私鑰</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ssh-keygen -t ed25519 -N $MY_PASSPHRASE -C $email -f ~/.ssh/id_ed25519_gitlab</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">echo -e "您的 Passphrase 是: ${RED} $MY_PASSPHRASE ${NC}，請妥善保存。"</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="複製程式碼到剪貼簿" title="複製" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>直接把上述內容儲存到 %USERPROFILE% 資料夾下，然後在 Git Bash 中輸入 <code>. ./gen_ssh_key.sh</code> 執行即可。</p>
<p>執行結果如下圖：
<img loading="lazy" alt="產出公鑰和私鑰" src="https://ouch1978.github.io/assets/images/generate-ssh-key-in-git-bash-ab66d31ce28cb99f48a865a0ceda1018.png" title="產出公鑰和私鑰" width="1152" height="673" class="img_ev3q"></p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="透過-ssh-agent-管理金鑰">透過 SSH Agent 管理金鑰<a href="https://ouch1978.github.io/blog/2022/10/09/quick-guide-to-use-git-with-ssh#%E9%80%8F%E9%81%8E-ssh-agent-%E7%AE%A1%E7%90%86%E9%87%91%E9%91%B0" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h3>
<p>接著的指令一樣接著在 Git Bash 中執行：</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">#將金鑰交給 SSH Agent 託管</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ssh-agent bash</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ssh-add "C:\\Users\\$USERNAME/.ssh/id_ed25519_gitlab"</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="複製程式碼到剪貼簿" title="複製" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>詢問 Passphrase 的時候，直接輸入上一個步驟產出的 Passphrase 就行了。</p>
<p>再以系統管理員的身份開啟 PowerShell，輸入下列指令：</p>
<div class="language-powershell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-powershell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">Get-Service ssh-agent | Set-Service -StartupType Automatic -PassThru | Start-Service</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ssh-agent</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">cd $env:USERPROFILE\.ssh</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ssh-add .\id_ed25519_gitlab</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">git config --global core.sshCommand C:\\Windows\\System32\\OpenSSH\\ssh.exe</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="複製程式碼到剪貼簿" title="複製" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="將公鑰設定到-gitlab">將公鑰設定到 GitLab<a href="https://ouch1978.github.io/blog/2022/10/09/quick-guide-to-use-git-with-ssh#%E5%B0%87%E5%85%AC%E9%91%B0%E8%A8%AD%E5%AE%9A%E5%88%B0-gitlab" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h3>
<p>這邊我一樣準備了一個 Script 在 Git Bash 裡執行：</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockTitle_Ktv7">set_ssh_key_to_gitlab.sh</div><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">#!/bin/bash</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#輸入 GitLab 的網址</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">read -p '請輸入 GitLab 的網址： ' gitlab_url</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#輸 GitLab 的 Personal Access Token</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">read -p '請輸入您的 Personal Access Token： ' personal_access_token</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#讀取 id_ed25519_gitlab 的內容</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">key=$(cat ~/.ssh/id_ed25519_gitlab.pub)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#透過 CURL 將公鑰上傳到 GitLab</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">curl -X POST -F "private_token=$personal_access_token" -F "title=MY_SSH_KEY" -F "key=$key" "$gitlab_url/api/v4/user/keys"</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="複製程式碼到剪貼簿" title="複製" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>直接把上述內容儲存到 %USERPROFILE% 資料夾下，然後在 Git Bash 中輸入 <code>. ./set_ssh_key_to_gitlab.sh</code> 執行即可。</p>
<div class="theme-admonition theme-admonition-tip admonition_xJq3 alert alert--success"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 12 16"><path fill-rule="evenodd" d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"></path></svg></span>小提醒</div><div class="admonitionContent_BuS1"><p>需依據 GitLab 的版本調整使用的 API 版本，如果使用的 GitLab 為 9.5 版之前的版本請改用 v3 取代 v4。</p></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="設定-ssh-config">設定 SSH Config<a href="https://ouch1978.github.io/blog/2022/10/09/quick-guide-to-use-git-with-ssh#%E8%A8%AD%E5%AE%9A-ssh-config" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h3>
<p>一樣在 Git Bash 中繼續執行下列指令：</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">   nano ~/.ssh/config</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="複製程式碼到剪貼簿" title="複製" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>加入下面的內容來告訴 SSH 在連線到哪些主機的時候要使用哪個金鑰：</p>
<div class="language-txt codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockTitle_Ktv7">~/.ssh/config</div><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-txt codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">Host gitlab.ouch1978.com</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   HostName gitlab.ouch1978.com</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   AddKeysToAgent yes</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   PreferredAuthentications publickey</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   User git</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   IdentityFile ~/.ssh/id_ed25519_gitlab</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="複製程式碼到剪貼簿" title="複製" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<div class="theme-admonition theme-admonition-tip admonition_xJq3 alert alert--success"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 12 16"><path fill-rule="evenodd" d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"></path></svg></span>小提示</div><div class="admonitionContent_BuS1"><ol>
<li>請務必依照你的環境和需求調整 <code>Host</code> 和 <code>HostName</code> 這兩個值。</li>
<li>關於詳細調整的方式可以參考 <a href="https://blog.alantsai.net/about" target="_blank" rel="noopener noreferrer">Alan Tsai</a> 的 <a href="https://blog.alantsai.net/posts/2016/03/ssh-config-ssh-agent-passphrase-management" target="_blank" rel="noopener noreferrer" title="如何�用config管理多個網站的ssh key和如何不用每一組輸入ssh的Pass Phrase">文章</a> 裡面 <code>config 的 alias作用</code> 一節。</li>
</ol></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="驗收">驗收<a href="https://ouch1978.github.io/blog/2022/10/09/quick-guide-to-use-git-with-ssh#%E9%A9%97%E6%94%B6" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h3>
<p>可以先到 GitLab 看看 SSH Key 是否已經正確的被加入。</p>
<p>再使用命令提示字元、Git Client 和 IDE 試著 Clone 專案看看，如果都成功就大功告成囉!!</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="疑難排解">疑難排解<a href="https://ouch1978.github.io/blog/2022/10/09/quick-guide-to-use-git-with-ssh#%E7%96%91%E9%9B%A3%E6%8E%92%E8%A7%A3" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="tortoisegit-顯示-no-supported-authentication-methods-availablesever-sent-publickey-錯誤">TortoiseGit 顯示 No supported authentication methods available(sever sent: publickey) 錯誤<a href="https://ouch1978.github.io/blog/2022/10/09/quick-guide-to-use-git-with-ssh#tortoisegit-%E9%A1%AF%E7%A4%BA-no-supported-authentication-methods-availablesever-sent-publickey-%E9%8C%AF%E8%AA%A4" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h3>
<p>將預設的 SSH Client 改為 Git 的 SSH Client (路徑為：<code>C:\Windows\System32\OpenSSH\ssh.exe</code>)即可，如下圖：</p>
<p><img loading="lazy" alt="更改 TortoiseGit 預設的 SSH Client" src="https://ouch1978.github.io/assets/images/tortoise-git-ssh-client-setting-61843b9fa85befa84094aa53b246ebb0.png" title="更改 TortoiseGit 預設的 SSH Client" width="1117" height="1033" class="img_ev3q"></p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="visual-studio-顯示-fatal-detected-dubious-ownership-in-repository">Visual Studio 顯示 fatal: detected dubious ownership in repository<a href="https://ouch1978.github.io/blog/2022/10/09/quick-guide-to-use-git-with-ssh#visual-studio-%E9%A1%AF%E7%A4%BA-fatal-detected-dubious-ownership-in-repository" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h3>
<p>在 PowerShell 中輸入：</p>
<div class="language-powershell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-powershell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">git config --global --add safe.directory '*'</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="複製程式碼到剪貼簿" title="複製" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="額外收錄">額外收錄<a href="https://ouch1978.github.io/blog/2022/10/09/quick-guide-to-use-git-with-ssh#%E9%A1%8D%E5%A4%96%E6%94%B6%E9%8C%84" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="怎麼把原先透過-https-存取的-repo-改為用-ssh">怎麼把原先透過 HTTPS 存取的 Repo 改為用 SSH?<a href="https://ouch1978.github.io/blog/2022/10/09/quick-guide-to-use-git-with-ssh#%E6%80%8E%E9%BA%BC%E6%8A%8A%E5%8E%9F%E5%85%88%E9%80%8F%E9%81%8E-https-%E5%AD%98%E5%8F%96%E7%9A%84-repo-%E6%94%B9%E7%82%BA%E7%94%A8-ssh" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h3>
<p>直接在 Repo 的資料夾下指令更改 remote 的 URL 即可，例如：</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">git remote set-url origin git@gitlab.ouch1978.com:pocs/dotnetcoretest.git</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="複製程式碼到剪貼簿" title="複製" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="如果已經有一堆透過-https-存取的-repo-呢">如果已經有一堆透過 HTTPS 存取的 Repo 呢?<a href="https://ouch1978.github.io/blog/2022/10/09/quick-guide-to-use-git-with-ssh#%E5%A6%82%E6%9E%9C%E5%B7%B2%E7%B6%93%E6%9C%89%E4%B8%80%E5%A0%86%E9%80%8F%E9%81%8E-https-%E5%AD%98%E5%8F%96%E7%9A%84-repo-%E5%91%A2" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h3>
<div class="theme-admonition theme-admonition-tip admonition_xJq3 alert alert--success"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 12 16"><path fill-rule="evenodd" d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"></path></svg></span>小提示</div><div class="admonitionContent_BuS1"><p>.git 資料夾在 VSCode 中預設是會被隱藏起來的，比較習慣使用 NotePad++ 的朋友可以考慮使用 NotePad ++ 修改。
或是參考<a href="https://ouch1978.github.io/blog/2022/10/10/show-hidden-items-in-vscode">在 VSCode 裡顯示隱藏的資料夾和檔案</a> 這篇文章來調整 VSCode 的設定。</p></div></div>
<p>直接以 VSCode 開啟所有 Repo 的根目錄，然後透過搜尋所有 <code>.git/config</code> 檔，然後取代 url 的值，如下圖：</p>
<p><img loading="lazy" alt="以 VSCode 一次修改多個 Repo 的 Remote URL" src="https://ouch1978.github.io/assets/images/set-git-remote-url-with-vscode-once-at-a-time-939776e7fbd56cd295cacde64458b568.png" title="以 VSCode 一次修改多個 Repo 的 Remote URL" width="2400" height="1554" class="img_ev3q"></p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="參考資料">參考資料<a href="https://ouch1978.github.io/blog/2022/10/09/quick-guide-to-use-git-with-ssh#%E5%8F%83%E8%80%83%E8%B3%87%E6%96%99" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h2>
<ul>
<li>
<p><a href="https://blog.alantsai.net/posts/2016/03/ssh-config-ssh-agent-passphrase-management" target="_blank" rel="noopener noreferrer" title="如何用config管理多個網站的ssh key和如何不用每一組輸入ssh的Pass Phrase">如何用config管理多個網站的ssh key和如何不用每一組輸入ssh的Pass Phrase</a></p>
</li>
<li>
<p><a href="https://www.howtogeek.com/howto/30184/10-ways-to-generate-a-random-password-from-the-command-line/" target="_blank" rel="noopener noreferrer" title="10 Ways to Generate a Random Password from the Linux Command Line">10 Ways to Generate a Random Password from the Linux Command Line</a></p>
</li>
<li>
<p><a href="https://ourtechroom.com/tech/https-vs-ssh-in-git/" target="_blank" rel="noopener noreferrer" title="HTTPS vs SSH in git">HTTPS vs SSH in git</a></p>
</li>
</ul>]]></content>
        <author>
            <name>Ouch Liu</name>
            <uri>https://github.com/ouch1978</uri>
        </author>
        <category label="Windows" term="Windows"/>
        <category label="小技巧" term="小技巧"/>
        <category label="Git" term="Git"/>
    </entry>
    <entry>
        <title type="html"><![CDATA[一次從遠端新增使用者帳號到多台 Windows Server 的本機群組]]></title>
        <id>https://ouch1978.github.io/blog/2022/10/05/add-user-into-group-to-multiple-windows-servers</id>
        <link href="https://ouch1978.github.io/blog/2022/10/05/add-user-into-group-to-multiple-windows-servers"/>
        <updated>2022-10-05T00:00:00.000Z</updated>
        <summary type="html"><![CDATA[在管理 Widows Server 的時候，偶爾會因為團隊成員異動或是其它因素，得要將新的帳號加入 Windows Server 的本機群組。當 Server 一多起來，改起來就很花時間。這邊就來分享一個蠻有效率的方式，可以一次把帳號加到多台 Windows Server 裡。]]></summary>
        <content type="html"><![CDATA[<h2 class="anchor anchorWithStickyNavbar_LWe7" id="前言">前言<a href="https://ouch1978.github.io/blog/2022/10/05/add-user-into-group-to-multiple-windows-servers#%E5%89%8D%E8%A8%80" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h2>
<p>在管理 Widows Server 的時候，偶爾會因為團隊成員異動或是其它因素，得要將新的帳號加入 Windows Server 的本機群組。</p>
<p>當 Server 一多起來，改起來就很花時間。</p>
<p>這邊就來分享一個蠻有效率的方式，可以一次把帳號加到多台 Windows Server 的本機群組裡。</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="取得-psexecexe">取得 PsExec.exe<a href="https://ouch1978.github.io/blog/2022/10/05/add-user-into-group-to-multiple-windows-servers#%E5%8F%96%E5%BE%97-psexecexe" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h2>
<p>這次我們要使用的工具是 PsExec，和之前介紹過的 <a title="PsPasswd" href="https://ouch1978.github.io/blog/2022/09/14/change-windows-local-admin-password-remotely">PsPasswd</a> 一樣都是 PsTools 裡的一個工具。</p>
<p>PsTools 是由微軟 Azure CTO - Mark Russinovich 所開發的一系列小工具的集合。</p>
<p>之所以會取名叫 PsTools，是因為它的第一個小工具 PsList(用來顯示目前執行中的程序清單) 致敬了標準 UNIX 作業系統裡顯示目前執行中的程序清單的指令就叫 <code>PS</code>，而他把所有小工具都加上 Ps 這個前綴詞來讓它們看起來是一個同捆包的概念，整個套裝就叫 PsTools。</p>
<p>說完故事，PsTools 的下載點在 <a href="https://download.sysinternals.com/files/PSTools.zip" target="_blank" rel="noopener noreferrer" title="Download PsTools Suite">這裡</a>。</p>
<p>下載並且解壓縮之後，你應該就會看到裡面包含了今天的主角 - <code>PsExec.exe</code>。</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="所以我該怎麼下指令呢">所以我該怎麼下指令呢?<a href="https://ouch1978.github.io/blog/2022/10/05/add-user-into-group-to-multiple-windows-servers#%E6%89%80%E4%BB%A5%E6%88%91%E8%A9%B2%E6%80%8E%E9%BA%BC%E4%B8%8B%E6%8C%87%E4%BB%A4%E5%91%A2" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h2>
<p>這邊以新增使用者到遠端 Server 的本機系統管理員群組為例。</p>
<p>我們可以透過命令提示字元切換到 PsExec.exe 的所在目錄，然後透過下面的指令來執行它：</p>
<div class="language-powershell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-powershell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">psexec {\\遠端機器的名稱或 IP} -u {擁有遠端管理者權限的帳號} -p {擁有遠端管理者權限帳號的密碼} net localgroup {群組名稱} "{要新增的帳號}" /add</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="複製程式碼到剪貼簿" title="複製" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<div class="theme-admonition theme-admonition-tip admonition_xJq3 alert alert--success"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 12 16"><path fill-rule="evenodd" d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"></path></svg></span>小提示</div><div class="admonitionContent_BuS1"><ol>
<li>如果沒輸入 -p 參數的話，會跳出一個視窗讓我們輸入密碼。</li>
<li>如果目前登入的帳號擁有遠端系統管理者權限的話可以不用輸入 -u 和 -p 參數。</li>
<li>PsExec 在執行的時候預設會跳出終端使用者授權視窗，如果想直接接受的話，可以多下一個 -accepteula 參數略過。</li>
</ol></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="將使用者加入遠端系統管理員群組">將使用者加入遠端系統管理員群組<a href="https://ouch1978.github.io/blog/2022/10/05/add-user-into-group-to-multiple-windows-servers#%E5%B0%87%E4%BD%BF%E7%94%A8%E8%80%85%E5%8A%A0%E5%85%A5%E9%81%A0%E7%AB%AF%E7%B3%BB%E7%B5%B1%E7%AE%A1%E7%90%86%E5%93%A1%E7%BE%A4%E7%B5%84" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h3>
<p>假設我目前本機登入的帳號已經有遠端 Server 的系統管理員權限，所以可以省略 -u 和 -p 兩個參數，那我就可以這樣下指令：</p>
<div class="language-powershell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-powershell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">psexec \\192.168.173.101 net localgroup administrators "my-domain\ouch1978-test" /add</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="複製程式碼到剪貼簿" title="複製" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="將使用者加入多台機器的系統管理員群組">將使用者加入多台機器的系統管理員群組<a href="https://ouch1978.github.io/blog/2022/10/05/add-user-into-group-to-multiple-windows-servers#%E5%B0%87%E4%BD%BF%E7%94%A8%E8%80%85%E5%8A%A0%E5%85%A5%E5%A4%9A%E5%8F%B0%E6%A9%9F%E5%99%A8%E7%9A%84%E7%B3%BB%E7%B5%B1%E7%AE%A1%E7%90%86%E5%93%A1%E7%BE%A4%E7%B5%84" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h3>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="用逗號分隔多台機器">用逗號分隔多台機器<a href="https://ouch1978.github.io/blog/2022/10/05/add-user-into-group-to-multiple-windows-servers#%E7%94%A8%E9%80%97%E8%99%9F%E5%88%86%E9%9A%94%E5%A4%9A%E5%8F%B0%E6%A9%9F%E5%99%A8" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h4>
<p>如果需要改多台的話，可以用逗號分隔多台電腦的名稱或是 IP，例如：</p>
<div class="language-powershell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-powershell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">psexec \\192.168.173.101,\\192.168.173.102,\\192.168.173.103 net localgroup administrators "my-domain\ouch1978-test" /add</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="複製程式碼到剪貼簿" title="複製" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="使用機器清單檔">使用機器清單檔<a href="https://ouch1978.github.io/blog/2022/10/05/add-user-into-group-to-multiple-windows-servers#%E4%BD%BF%E7%94%A8%E6%A9%9F%E5%99%A8%E6%B8%85%E5%96%AE%E6%AA%94" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h4>
<p>我們也可以把所有的機器名稱或 IP 放到一個文字檔裡，再把它餵給 PsExec.exe，例如：</p>
<div class="language-plain codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-plain codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">192.168.173.101</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">192.168.173.102</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">192.168.173.103</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">MyWindows11</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="複製程式碼到剪貼簿" title="複製" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>然後執行：</p>
<div class="language-powershell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-powershell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">psexec @C:\ServerList.txt net localgroup administrators "my-domain\ouch1978-test" /add</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="複製程式碼到剪貼簿" title="複製" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>就可以一次把 my-domain\ouch1978-test 這個帳號加到 ServerList.txt 裡面包含的所有機器的系統管理員群組中。</p>
<div class="theme-admonition theme-admonition-tip admonition_xJq3 alert alert--success"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 12 16"><path fill-rule="evenodd" d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"></path></svg></span>小提示</div><div class="admonitionContent_BuS1"><p>清單檔裡面的每筆機器名稱或 IP 前面都不用加上 <code>\\</code>。</p></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="將帳號加到整個網域裡所有電腦的系統管理員群組">將帳號加到整個網域裡所有電腦的系統管理員群組<a href="https://ouch1978.github.io/blog/2022/10/05/add-user-into-group-to-multiple-windows-servers#%E5%B0%87%E5%B8%B3%E8%99%9F%E5%8A%A0%E5%88%B0%E6%95%B4%E5%80%8B%E7%B6%B2%E5%9F%9F%E8%A3%A1%E6%89%80%E6%9C%89%E9%9B%BB%E8%85%A6%E7%9A%84%E7%B3%BB%E7%B5%B1%E7%AE%A1%E7%90%86%E5%93%A1%E7%BE%A4%E7%B5%84" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h3>
<p>如果需要一次把帳號加到整個網域中所有電腦的系統管理員群組的話，可以使用萬用字元來達成目的：</p>
<div class="language-powershell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-powershell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">psexec \\* net localgroup administrators "my-domain\ouch1978-test" /add</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="複製程式碼到剪貼簿" title="複製" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="再來說說-psexec-的功能">再來說說 PsExec 的功能<a href="https://ouch1978.github.io/blog/2022/10/05/add-user-into-group-to-multiple-windows-servers#%E5%86%8D%E4%BE%86%E8%AA%AA%E8%AA%AA-psexec-%E7%9A%84%E5%8A%9F%E8%83%BD" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h2>
<p>其實 PsExec 並不單單只是能讓我們拿來加帳號到遠端電腦的使用者群組而已。</p>
<p>它真正的功能是讓我們執行遠端電腦的程式。</p>
<p>舉例來說，我們可以透過它來幫遠端的電腦設定系統環境變數：</p>
<div class="language-powershell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-powershell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">psexec \\* setx %PATH%;%ProgramFiles%</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="複製程式碼到剪貼簿" title="複製" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>上面這個指令就可以讓我們幫整個網域的所有電腦在系統環境變數的預設路徑清單裡加上系統預設的 Program Files 資料夾。</p>
<p>當然，複製檔案、刪除檔案之類的指令也都是可以輕鬆辦到的。</p>
<p>只要你知道指令怎麼下，就都難不倒它喔!!</p>
<div class="theme-admonition theme-admonition-danger admonition_xJq3 alert alert--danger"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 12 16"><path fill-rule="evenodd" d="M5.05.31c.81 2.17.41 3.38-.52 4.31C3.55 5.67 1.98 6.45.9 7.98c-1.45 2.05-1.7 6.53 3.53 7.7-2.2-1.16-2.67-4.52-.3-6.61-.61 2.03.53 3.33 1.94 2.86 1.39-.47 2.3.53 2.27 1.67-.02.78-.31 1.44-1.13 1.81 3.42-.59 4.78-3.42 4.78-5.56 0-2.84-2.53-3.22-1.25-5.61-1.52.13-2.03 1.13-1.89 2.75.09 1.08-1.02 1.8-1.86 1.33-.67-.41-.66-1.19-.06-1.78C8.18 5.31 8.68 2.45 5.05.32L5.03.3l.02.01z"></path></svg></span>警告</div><div class="admonitionContent_BuS1"><p>還是要再次叮嚀，一次對整個網域的電腦進行操作有好有壞，使用前請務必三思再按下 <kbd>Enter</kbd>。</p></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="參考資料">參考資料<a href="https://ouch1978.github.io/blog/2022/10/05/add-user-into-group-to-multiple-windows-servers#%E5%8F%83%E8%80%83%E8%B3%87%E6%96%99" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h2>
<ul>
<li>
<p><a href="https://learn.microsoft.com/zh-tw/sysinternals/downloads/psexec" target="_blank" rel="noopener noreferrer">PsExec v2.40</a></p>
</li>
<li>
<p><a href="https://www.itprotoday.com/windows-server/psexec-explainer-mark-russinovich" target="_blank" rel="noopener noreferrer" title="PsExec Explainer by Mark Russinovich">PsExec Explainer by Mark Russinovich</a></p>
</li>
<li>
<p><a href="https://4sysops.com/archives/add-a-user-to-the-local-administrators-group-on-a-remote-computer/#psexec-and-net-localgroup" target="_blank" rel="noopener noreferrer">Add a user to the local Administrators group on a remote computer</a></p>
</li>
</ul>]]></content>
        <author>
            <name>Ouch Liu</name>
            <uri>https://github.com/ouch1978</uri>
        </author>
        <category label="Windows" term="Windows"/>
        <category label="小技巧" term="小技巧"/>
        <category label="PsTools" term="PsTools"/>
    </entry>
    <entry>
        <title type="html"><![CDATA[一張圖看懂同步、非同步與多執行緒的差別]]></title>
        <id>https://ouch1978.github.io/blog/2022/09/25/understand-sync-async-and-multi-thread-with-one-pic</id>
        <link href="https://ouch1978.github.io/blog/2022/09/25/understand-sync-async-and-multi-thread-with-one-pic"/>
        <updated>2022-09-25T00:00:00.000Z</updated>
        <summary type="html"><![CDATA[同步、非同步和多執行緒的差別常常是面試的必考題之一。應該也有很多人不只看過、用過，甚至已經寫到用起來像吃飯喝水一樣的自然。但是，當遇到有人要求用比較淺顯易懂的方式來解釋這三者的差別時，我敢說，有很多人就是講不出來。我幾乎敢這樣講，但我也不敢完全否認，還是有些人可以回答得出來。]]></summary>
        <content type="html"><![CDATA[<h2 class="anchor anchorWithStickyNavbar_LWe7" id="前言">前言<a href="https://ouch1978.github.io/blog/2022/09/25/understand-sync-async-and-multi-thread-with-one-pic#%E5%89%8D%E8%A8%80" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h2>
<p>同步、非同步和多執行緒的差別常常是面試的必考題之一。</p>
<p>應該也有很多人不只看過、用過，甚至已經寫到用起來像吃飯喝水一樣的自然。</p>
<p>但是，當遇到有人要求用比較淺顯易懂的方式來解釋這三者的差別時，我敢說，有很多人就是講不出來。</p>
<p>我幾乎敢這樣講，但我也不敢完全否認，還是有些人可以回答得出來。(喂!~)</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="所以我說那張圖呢">所以，我說那張圖呢?<a href="https://ouch1978.github.io/blog/2022/09/25/understand-sync-async-and-multi-thread-with-one-pic#%E6%89%80%E4%BB%A5%E6%88%91%E8%AA%AA%E9%82%A3%E5%BC%B5%E5%9C%96%E5%91%A2" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h2>
<p>這邊就以常見的速食店當例子，來說明同步、非同步和多執行緒的差異。</p>
<p><img loading="lazy" alt="同步、非同步與多執行緒的差異" src="https://ouch1978.github.io/assets/images/difference-between-sync-async-and-multi-thread-3e2596569ce293b96b8b38c99fe67078.png" title="同步、非同步與多執行緒的差異 - 以速食店為例" width="2197" height="955" class="img_ev3q"></p>
<div class="theme-admonition theme-admonition-tip admonition_xJq3 alert alert--success"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 12 16"><path fill-rule="evenodd" d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"></path></svg></span>小提示</div><div class="admonitionContent_BuS1"><ol>
<li>可以把店員看作是執行緒，就可以和程式運作的方式互相對應。</li>
<li>倒飲料、炸薯條和煎肉排等等動作可以對應到程式中需要等待 I/O 的各種動作。</li>
</ol></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="同步">同步<a href="https://ouch1978.github.io/blog/2022/09/25/understand-sync-async-and-multi-thread-with-one-pic#%E5%90%8C%E6%AD%A5" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h3>
<p>同步的運作方式應該是最常見的程式運作方式。</p>
<p>從圖裡我們可以看到，當店員作了一個動作之後，一定得要等到該動作完成、取得回應之後，才能繼續下一個動作。</p>
<p>在這樣的運作方式下，會花極大的時間在空轉和等待上。</p>
<p>所以在大部份的同步處理下，效率都是相對差的。</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="非同步">非同步<a href="https://ouch1978.github.io/blog/2022/09/25/understand-sync-async-and-multi-thread-with-one-pic#%E9%9D%9E%E5%90%8C%E6%AD%A5" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h3>
<p>非同步和同步最大的差別，就是店員不用傻傻的等待上一個動作完成，就可以開始去處理下一個動作。</p>
<p>等到前面的工作完成，他再繼續往後處理就好。</p>
<p>從圖裡可以明顯的看得出來，非同步和同步相比，雖然都是只有一個店員，但是整個出餐速度快了許多。</p>
<p>也因為等待的時間還可以處理其它工作的關係，真正閒置的時間也大幅的縮短。</p>
<p>所以都在單一員工的情況下，非同步的效率是相對高的。</p>
<div class="theme-admonition theme-admonition-warning admonition_xJq3 alert alert--warning"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 16 16"><path fill-rule="evenodd" d="M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"></path></svg></span>警告</div><div class="admonitionContent_BuS1"><p>非同步並不會多生出一個執行緒!!<br>
非同步並不會多生出一個執行緒!!<br>
非同步並不會多生出一個執行緒!!<br></p><p>很重要，所以要說三次。</p></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="多執行緒">多執行緒<a href="https://ouch1978.github.io/blog/2022/09/25/understand-sync-async-and-multi-thread-with-one-pic#%E5%A4%9A%E5%9F%B7%E8%A1%8C%E7%B7%92" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h3>
<p>多執行緒最接近現實生活中快餐店的運作方式。</p>
<p>由一個櫃檯負責點餐和收集所有餐點，其它工作則由其他的人負責，而且三個人都是同時平行處理的。</p>
<p>在大多數的正常情況下，多執行緒的效率會是三者裡面最好的。</p>
<p>不過，在店員越多的情況下，溝通的成本就越高，一個人出錯就可能影響到整個出餐的流程。</p>
<p>使用多執行緒時也一樣，執行緒越多，Context switch 的成本也越高，對協調各執行緒的要求就越嚴格，各執行緒的容錯率也越低。</p>
<p>在現實生活中的速食店裡，也常常可以看到當店裡一忙起來之後，有人開始介入其他人的工作，接著就整個場面開始大亂，有打工過的朋友應該很能體會。</p>
<div class="theme-admonition theme-admonition-tip admonition_xJq3 alert alert--success"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 12 16"><path fill-rule="evenodd" d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"></path></svg></span>小提示</div><div class="admonitionContent_BuS1"><p>上面的圖很刻意的避開資源共用的問題，但是在現實的程式裡面，解決各資源之間的衝突也是很重要的一環。</p></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="結語">結語<a href="https://ouch1978.github.io/blog/2022/09/25/understand-sync-async-and-multi-thread-with-one-pic#%E7%B5%90%E8%AA%9E" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h2>
<p>希望這篇文章可以幫助到已經用到麻木，但是還想不出一個簡單解釋這三者的朋友。</p>
<p>尤其是需要面試的朋友，總不能回面試官再問就是居心叵測，畢竟機會可能只有一次，晚了人家就不要了。(逃~~)</p>]]></content>
        <author>
            <name>Ouch Liu</name>
            <uri>https://github.com/ouch1978</uri>
        </author>
        <category label="Programming" term="Programming"/>
        <category label="一張圖看懂系列" term="一張圖看懂系列"/>
    </entry>
    <entry>
        <title type="html"><![CDATA[延長 MSDTC 分散式交易連線快取的時間，提升系統效能]]></title>
        <id>https://ouch1978.github.io/blog/2022/09/24/prevent-msdtc-connection-being-recycled</id>
        <link href="https://ouch1978.github.io/blog/2022/09/24/prevent-msdtc-connection-being-recycled"/>
        <updated>2022-09-24T00:00:00.000Z</updated>
        <summary type="html"><![CDATA[之前有同事跑來問我，為什麼我們的 ASP.NET WebAPI 閒置一段時間之後，被呼叫的第一個 API Call 都會因為超時而失敗? 當下我一開始很直覺的認為，應該是系統沒有作好預載(Preload)的動作，導致 Application Pool 被回收之後重啟的過程花費太多時間。 但是人生往往不是這麼簡單，在我們對系統加上預載相關設定之後，隔一段時間的第一個 API 呼叫都還是會超時。 經過一番抽絲剝繭之後，才發現原來真兇是 MSDTC…]]></summary>
        <content type="html"><![CDATA[<h2 class="anchor anchorWithStickyNavbar_LWe7" id="前言">前言<a href="https://ouch1978.github.io/blog/2022/09/24/prevent-msdtc-connection-being-recycled#%E5%89%8D%E8%A8%80" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h2>
<p>之前有同事跑來問我，為什麼我們的 ASP.NET WebAPI 閒置一段時間之後，被呼叫的第一個 API 呼叫都會因為超時而失敗?</p>
<p>(這裡指的超時是呼叫端設定了兩秒沒收到回應就會直接當作超時處理)</p>
<p>而且很有趣的是，當把 Load Balancer 後面的伺服器移到只剩一台的時候，這個問題就不會發生。</p>
<p>一旦掛上兩台以上的機器，比較不那麼忙的那台就很容易重現這個問題。</p>
<p>當下我一開始很直覺的認為，應該是系統沒有作好預載(Preload)的動作，導致 Application Pool 被回收之後重啟的過程花費太多時間。</p>
<p>但是人生往往不是這麼簡單，在我們對系統加上預載相關設定之後，隔一段時間的第一個 API 呼叫都還是會超時。</p>
<p>經過一番抽絲剝繭之後，才發現原來真兇是 MSDTC…</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="問題重現與驗證">問題重現與驗證<a href="https://ouch1978.github.io/blog/2022/09/24/prevent-msdtc-connection-being-recycled#%E5%95%8F%E9%A1%8C%E9%87%8D%E7%8F%BE%E8%88%87%E9%A9%97%E8%AD%89" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h2>
<p>當初還有一個很有趣的現象，只要系統閒置大約十分鐘左右，這個問題就會重現。</p>
<p>所以看起來更不像是因為沒做預載造成的問題。</p>
<p>所以我用 WPF 寫了一個小測試程式(這樣就可以證明不是因為沒有預載造成的)，情境如下：</p>
<ol>
<li>
<p>在一個 Transaction Scope 裡面使用同一個 SQL Server Instance 裡三個不同的資料庫，用不同順序的排列組合去連它們。</p>
</li>
<li>
<p>連上資料庫之後只執行簡單的 <code>SELECT GETDATE()</code> 指令。</p>
</li>
<li>
<p>觀察和每個資料庫進行連線所花費的時間以及執行命令所花費的時間。</p>
</li>
<li>
<p>程式開著放十分鐘以上，再測一輪。</p>
</li>
</ol>
<p><img loading="lazy" alt="我的測試結果" src="https://ouch1978.github.io/assets/images/transaction-scope-test-result-0254943eb68a2519f6fa85703b44185a.png" title="我的測試結果" width="1255" height="802" class="img_ev3q"></p>
<p>而我得到的結論是：</p>
<p>不管是哪種排列組合，在連到第一顆資料庫的時候都很快，只會花費十幾毫秒。</p>
<p>但是當在建立和第二顆資料庫的連線時就會花費很長的時間，甚至可能長到超過兩千毫秒以上，在連第三顆的時候又很快，通常也在十毫秒之內。</p>
<p>第一輪執行完畢之後如果馬上執行第二輪的話，在 Transaction Scope 裡使用這三顆資料庫的任意排列組合，都還是可以很快的跑完。</p>
<p>但是一旦放了超過十分鐘，就會再慢一次。</p>
<p>有興趣的話也不妨在自己的電腦試看看是不是和我看到的結果是一致的。</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="魔鬼藏在細節裡">魔鬼藏在細節裡<a href="https://ouch1978.github.io/blog/2022/09/24/prevent-msdtc-connection-being-recycled#%E9%AD%94%E9%AC%BC%E8%97%8F%E5%9C%A8%E7%B4%B0%E7%AF%80%E8%A3%A1" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h2>
<p>經過一番驗證之後，確認是因為在連到第二顆資料庫時，系統會多一個判斷是否要將交易提升為分散式交易的動作。</p>
<div class="theme-admonition theme-admonition-note admonition_xJq3 alert alert--secondary"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>註記</div><div class="admonitionContent_BuS1"><p>在 SQL Server 2008 之前的版本，只要是 Transaction Scope 包含一條以上的資料庫連線，系統就會把它判定為分散式交易。
但是從 SQL Server 2008 之後，要連到一個以上的資料庫才會被判定為分散式交易。</p></div></div>
<p>如果是分散式交易，MSDTC Client 就會去確認是否有現成的連線可用，如果沒有，就會重新建立連線。</p>
<p>就是這個聽起來很簡單的小動作，造成建立連線的時間比平常多了 100 倍以上。</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="關於那神秘的十分鐘呢">關於那神秘的十分鐘呢?<a href="https://ouch1978.github.io/blog/2022/09/24/prevent-msdtc-connection-being-recycled#%E9%97%9C%E6%96%BC%E9%82%A3%E7%A5%9E%E7%A7%98%E7%9A%84%E5%8D%81%E5%88%86%E9%90%98%E5%91%A2" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h3>
<p>為了找出到底為什麼是十分鐘這件事，還真的花了不少時間和心力。</p>
<p>除了用各種相關的關鍵字問 Google 大神之外，也請教了台灣微軟的技術客服。</p>
<p>錄封包、DTC Ping 這些招式也都搬出來了，可是還是看不出個所以然。</p>
<p>後來因為當時有一個應急措施可以避免這個問題，我就沒把它放心上了。</p>
<p>直到某一天我心血來潮，想說再查看看有沒有相關的資料，總算讓我找到一篇微軟的 KB 備份。</p>
<p>裡面提到一個關鍵：</p>
<blockquote>
<p>交易管理器預設每<code>六秒</code>會檢查一次連線狀態，如果連續<code>一百次</code>得到的狀態都是閒置的，就會將連線關閉。</p>
</blockquote>
<p>這不就是那神秘的十分鐘嗎!?</p>
<p>那份 KB 裡面也提到<code>六秒</code>和<code>一百次</code>這兩個預設值的改法。</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="所以我說那個解法是什麼">所以我說，那個解法是什麼?<a href="https://ouch1978.github.io/blog/2022/09/24/prevent-msdtc-connection-being-recycled#%E6%89%80%E4%BB%A5%E6%88%91%E8%AA%AA%E9%82%A3%E5%80%8B%E8%A7%A3%E6%B3%95%E6%98%AF%E4%BB%80%E9%BA%BC" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h2>
<p>又過了一段時間之後，收到微軟的技術客服的來信，信裡的建議和我當初看到的 KB 備份提到的修改方法一模一樣。</p>
<p>果然原廠還是原廠啊!!</p>
<p>解決的方法如下：</p>
<p>在所有的 Application Server 中都新增下列登錄機碼：</p>
<p>機碼 Key： <code>HKLM\SOFTWARE\Microsoft\MSDTC</code></p>
<p>名稱： <code>CmMaxIdlePings</code></p>
<p>型別： <code>REG_DWORD</code></p>
<p>數值： <code>0xFFFFFFFF</code></p>
<p>在所有的 SQL Server 中都新增下列登錄機碼：</p>
<p>機碼 Key： <code>HKLM\CLUSTER\Resources\&lt;MSDTC resource GUID&gt;\MSDTCPRIVATE\MSDTC</code></p>
<p>名稱： <code>CmMaxIdlePings</code></p>
<p>型別： <code>REG_DWORD</code></p>
<p>數值： <code>0xFFFFFFFF</code></p>
<p>修改完畢之後記得要重新啟動 Server，然後之後的 MSDTC 連線一旦建立起來就再也不會被關掉了。</p>
<div class="theme-admonition theme-admonition-note admonition_xJq3 alert alert--secondary"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>註記</div><div class="admonitionContent_BuS1"><ol>
<li>這邊使用的改法是去修改那個一百次，讓它一直檢查下去。</li>
<li>不建議修改六秒 (<code>CmPingFreqSecs</code>) 的值，因為根據微軟的說法，更改它可能會造成 DTC 不穩定。</li>
</ol></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="關於那傳說中的-kb-備份">關於那傳說中的 KB 備份<a href="https://ouch1978.github.io/blog/2022/09/24/prevent-msdtc-connection-being-recycled#%E9%97%9C%E6%96%BC%E9%82%A3%E5%82%B3%E8%AA%AA%E4%B8%AD%E7%9A%84-kb-%E5%82%99%E4%BB%BD" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h3>
<p>那篇的編號是 <code>KB197810</code>，不過現在應該已經屍骨無存了。</p>
<p>不過還好<a href="https://www.betaarchive.com/wiki/index.php/Microsoft_KB_Archive/197810" target="_blank" rel="noopener noreferrer" title="Microsoft KB Archive/197810">這邊</a>有它的備份。</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="後記">後記<a href="https://ouch1978.github.io/blog/2022/09/24/prevent-msdtc-connection-being-recycled#%E5%BE%8C%E8%A8%98" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h2>
<p>人家當初是為了縮短連線被佔用的時間以及降低重複檢查連線狀態所消耗的資源，才把時間從十小時縮短到十分鐘。</p>
<p>KB 的內容也是教我們怎麼把時間縮到更短，沒想到我們卻想把它拉長。</p>
<p>還是早點擺脫用 Transaction Scope 達到分散式交易的目的，才不用老是在通靈或是改這些登錄機碼。</p>
<p>另外，十七年前的 KB，真的是時代的眼淚啊~~</p>]]></content>
        <author>
            <name>Ouch Liu</name>
            <uri>https://github.com/ouch1978</uri>
        </author>
        <category label="Programming" term="Programming"/>
        <category label="MSDTC" term="MSDTC"/>
        <category label="SQL Server" term="SQL Server"/>
    </entry>
    <entry>
        <title type="html"><![CDATA[一張圖看懂寫程式時常見的幾種鎖]]></title>
        <id>https://ouch1978.github.io/blog/2022/09/21/common-locks-in-programming-world</id>
        <link href="https://ouch1978.github.io/blog/2022/09/21/common-locks-in-programming-world"/>
        <updated>2022-09-21T00:00:00.000Z</updated>
        <summary type="html"><![CDATA[透過一張圖片快速瞭解寫程式時常見的鎖的種類及特性。]]></summary>
        <content type="html"><![CDATA[<h2 class="anchor anchorWithStickyNavbar_LWe7" id="前言">前言<a href="https://ouch1978.github.io/blog/2022/09/21/common-locks-in-programming-world#%E5%89%8D%E8%A8%80" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h2>
<p>在寫程式的世界裡，充斥著各種不同的鎖，不同的鎖適用的情境也有所不同。</p>
<p>不同種類的鎖的特性和使用情境也是面試時常常被拿來當作考題的題目。</p>
<p>這篇文章就簡單的透過一張圖來介紹幾種比較常見的鎖。</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="所以我說那張圖呢">所以我說，那張圖呢?<a href="https://ouch1978.github.io/blog/2022/09/21/common-locks-in-programming-world#%E6%89%80%E4%BB%A5%E6%88%91%E8%AA%AA%E9%82%A3%E5%BC%B5%E5%9C%96%E5%91%A2" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h2>
<p>下面這張圖就是今天的主角。</p>
<p><img loading="lazy" alt="寫程式時常見的各種鎖" src="https://ouch1978.github.io/assets/images/common-locks-in-programming-world-6263b2f8cc0f6c48972a53aa36beb25d.png" title="寫程式時常見的各種鎖" width="2128" height="1078" class="img_ev3q"></p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="看圖�說故事">看圖說故事<a href="https://ouch1978.github.io/blog/2022/09/21/common-locks-in-programming-world#%E7%9C%8B%E5%9C%96%E8%AA%AA%E6%95%85%E4%BA%8B" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="樂觀鎖">樂觀鎖<a href="https://ouch1978.github.io/blog/2022/09/21/common-locks-in-programming-world#%E6%A8%82%E8%A7%80%E9%8E%96" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h3>
<p>樂觀鎖從字面上來看，它就是很樂觀。(喂!~)</p>
<p>通常它會被用在資源發生衝突的機率很低的情境下，或是就算發生衝突時只要還原成原來的狀態就可以解決的情境。</p>
<p>另一個使用它的要素是上鎖的成本很高，例如每次上鎖的時間都是幾分鐘，甚至幾小時起跳，過程中其它執行緒只能乾等。</p>
<p>當多個執行緒要存取同一個資源時，它會放行所有執行緒，最後再檢查是不是有衝突。</p>
<p>如果真的發生衝突的話就進行回滾(rollback)，放棄這次的操作。</p>
<p>我們常見的 SVN 、 Git 和 O365 的多人共編功能就是使用樂觀鎖的概念實作出來的。</p>
<p>所以大家都可以很開心的一起編輯，很開心的存檔或是 Commit，然後很開心的解衝突。(咦!?)</p>
<p>當然，我們可以選擇花更多的時間解決衝突，或是放棄努力好幾個小時的成果，這就是使用樂觀鎖可能增加的成本。</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="悲觀鎖">悲觀鎖<a href="https://ouch1978.github.io/blog/2022/09/21/common-locks-in-programming-world#%E6%82%B2%E8%A7%80%E9%8E%96" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h3>
<p>悲觀鎖的悲觀指的是：資源有很大的機會同時被多個執行緒存取，所以要透過上鎖的機制來確保資料的正確性。</p>
<p>在使用上需要特別注意，每次上鎖的時間越短越好，否則會造成極大的資源浪費。</p>
<p>大家可以試著想像看看：</p>
<p>一個有著十個人的開發團隊，一起撰寫同一個專案，但是同時只允許一個人進行開發。</p>
<p>一旦有一個人 check out 程式碼，其他人就不能對整份程式碼進行任何修改，直到程式碼被 check in ，交出存取權為止。</p>
<p>如果有人忘記交出存取權，其他人就只能一直乾等，那將會是多可怕的一件事啊~(<del>開心，大家都可以回家啦!!</del>)</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="互斥鎖">互斥鎖<a href="https://ouch1978.github.io/blog/2022/09/21/common-locks-in-programming-world#%E4%BA%92%E6%96%A5%E9%8E%96" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h4>
<p>互斥鎖就是我們常看到的 Mutex。</p>
<p>最常見的用法就是在多執行緒中避免兩個執行緒同時存取同一個資源。</p>
<p>和自旋鎖的差別是，當執行緒遇到上鎖的物件時，它會進行 Sleep Waiting，等到鎖被釋放通知它之後才繼續存取的動作。</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="自旋鎖">自旋鎖<a href="https://ouch1978.github.io/blog/2022/09/21/common-locks-in-programming-world#%E8%87%AA%E6%97%8B%E9%8E%96" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h4>
<p>自旋鎖的特色是當執行緒遇到上鎖的物件時，它會進行 Busy Waiting，不斷反覆的去詢問鎖釋放了沒，直到它可以存取為止。</p>
<p>由於自旋鎖會不斷的去做詢問的動作，所以會比互斥所更快獲取下一次存取物件的機會(效能相對好)。</p>
<p>但是隨之而來的副作用是：和互斥鎖相比，自旋鎖會佔用相對多的 CPU 資源。</p>
<p>而且，自旋鎖在 CPU 只有單核單緒的情況下是無法發揮作用的(整顆 CPU 的執行緒都被它整碗端走了啊~~)。</p>
<div class="theme-admonition theme-admonition-tip admonition_xJq3 alert alert--success"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 12 16"><path fill-rule="evenodd" d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"></path></svg></span>小提示</div><div class="admonitionContent_BuS1"><p>如果能保證每次上鎖的時間很短的情境下，使用自旋鎖的效能會比使用互斥鎖來得好。</p></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="讀寫鎖">讀/寫鎖<a href="https://ouch1978.github.io/blog/2022/09/21/common-locks-in-programming-world#%E8%AE%80%E5%AF%AB%E9%8E%96" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h4>
<p>顧名思義，讀/寫鎖分為讀鎖和寫鎖兩種。</p>
<p>更精準的說，應該分為<code>讀優先鎖</code>和<code>寫優先鎖</code>。</p>
<p>為了確保資料的正確性，寫鎖通常會確保同時只有一個執行緒可以修改資料(獨佔鎖)。</p>
<p>寫優先鎖會讓寫入的動作完成之後，才讓讀取的動作進行，以確保讀取時都是讀取到最新的資料。</p>
<p>讀取的動作在物件沒被上鎖時，則會允許多個執行緒同時讀取它(共享鎖)，因為大家讀到的資料都一樣，沒有先後的問題。</p>
<p>讀優先鎖則是會儘可能讓多個執行緒讀取的動作先作完，再放行寫入的動作。</p>
<p>大多數情境下的讀/寫鎖也都會藉由實作互斥鎖或是自旋鎖來實現。</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="結語">結語<a href="https://ouch1978.github.io/blog/2022/09/21/common-locks-in-programming-world#%E7%B5%90%E8%AA%9E" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h2>
<p>本來只想放一張圖就好的，但是還是忍不住寫了一大堆字。</p>
<p>關於執行緒餓死和鎖死的原理就先跳過不說了。</p>
<p>如果有覺得應該要被加在圖裡的鎖或是希望補充的內容，也歡迎提供建議喔!!</p>]]></content>
        <author>
            <name>Ouch Liu</name>
            <uri>https://github.com/ouch1978</uri>
        </author>
        <category label="Programming" term="Programming"/>
        <category label="一張圖看懂系列" term="一張圖看懂系列"/>
    </entry>
    <entry>
        <title type="html"><![CDATA[從遠端修改 Windows 本機帳號的密碼，還可以一次改多台!!]]></title>
        <id>https://ouch1978.github.io/blog/2022/09/14/change-windows-local-admin-password-remotely</id>
        <link href="https://ouch1978.github.io/blog/2022/09/14/change-windows-local-admin-password-remotely"/>
        <updated>2022-09-14T00:00:00.000Z</updated>
        <summary type="html"><![CDATA[在管理 Server 的時候，偶爾會出現需要更改某台機器管理者密碼的情況。如果要改的機器只有一兩台的話，還可以辛苦一點直接用遠端桌面連線的方式連過去改。但是，如果一次要改五台以上，甚至是十台以上，可能就會需要更聰明一點的方法了。]]></summary>
        <content type="html"><![CDATA[<h2 class="anchor anchorWithStickyNavbar_LWe7" id="前言">前言<a href="https://ouch1978.github.io/blog/2022/09/14/change-windows-local-admin-password-remotely#%E5%89%8D%E8%A8%80" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h2>
<p>在管理 Server 的時候，偶爾會出現需要更改某台機器管理者密碼的情況。</p>
<p>如果要改的機器只有一兩台的話，還可以辛苦一點直接用遠端桌面連線的方式連過去改。</p>
<p>但是，如果一次要改五台以上，甚至是十台以上，一台一台用遠端桌面連線慢慢改可能就沒那麼有效率了。</p>
<p>這篇文章就來分享透過 <code>PsPasswd.exe</code> 來更改遠端 Windows 裡某個帳號的密碼的方法。</p>
<p>最重要的是，它還支援一次對一整批的機器進行修改!!</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="取得-pspasswdexe">取得 PsPasswd.exe<a href="https://ouch1978.github.io/blog/2022/09/14/change-windows-local-admin-password-remotely#%E5%8F%96%E5%BE%97-pspasswdexe" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h2>
<p>PsPasswd.exe 是 PsTools 裡的一個工具。</p>
<p>PsTools 是由微軟 Azure CTO - Mark Russinovich 所開發的一系列小工具的集合。</p>
<p>之所以會取名叫 PsTools，是因為它的第一個小工具 PsList(用來顯示目前執行中的程序清單) 致敬了標準 UNIX 作業系統裡顯示目前執行中的程序清單的指令就叫 <code>PS</code>，而他把所有小工具都加上 Ps 這個前綴詞來讓它們看起來是一個同捆包的概念，整個套裝就叫 PsTools。</p>
<p>說完故事，PsTools 的下載點在 <a href="https://download.sysinternals.com/files/PSTools.zip" target="_blank" rel="noopener noreferrer" title="Download PsTools Suite">這裡</a>。</p>
<p>下載並且解壓縮之後，你應該就會看到裡面包含了今天的主角 - <code>PsPasswd.exe</code>。</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="所以我該怎麼使用呢">所以我該怎麼使用呢?<a href="https://ouch1978.github.io/blog/2022/09/14/change-windows-local-admin-password-remotely#%E6%89%80%E4%BB%A5%E6%88%91%E8%A9%B2%E6%80%8E%E9%BA%BC%E4%BD%BF%E7%94%A8%E5%91%A2" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h2>
<p>我們可以透過命令提示字元切換到 PsPasswd.exe 的所在目錄，然後透過下面的指令來執行它：</p>
<div class="language-powershell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-powershell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">pspasswd {\\遠端機器的名稱或 IP} -u {擁有遠端管理者權限的帳號} -p {擁有遠端管理者權限帳號的密碼} {要被更改密碼的遠端帳號} {新密碼}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="複製程式碼到剪貼簿" title="複製" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<div class="theme-admonition theme-admonition-tip admonition_xJq3 alert alert--success"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 12 16"><path fill-rule="evenodd" d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"></path></svg></span>小提示</div><div class="admonitionContent_BuS1"><ol>
<li>如果忽略遠端機器的名稱或 IP 的話，指令會在本機執行，也就是會修改到本機中指定帳號的密碼。</li>
<li>如果沒輸入 -p 參數的話，屆時會跳出一個視窗讓我們輸入密碼。</li>
<li>如果沒輸入新密碼的話，預設會使用 NULL 作為新的密碼，也就是不用密碼的意思。</li>
</ol></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="修改一台機器的密碼">修改一台機器的密碼<a href="https://ouch1978.github.io/blog/2022/09/14/change-windows-local-admin-password-remotely#%E4%BF%AE%E6%94%B9%E4%B8%80%E5%8F%B0%E6%A9%9F%E5%99%A8%E7%9A%84%E5%AF%86%E7%A2%BC" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h3>
<div class="language-powershell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-powershell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">pspasswd \\192.168.173.101 -u ouch1978 -p ILoveOuch1978 Administrator MyNewPassword</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="複製程式碼到剪貼簿" title="複製" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="修改多台機器的密碼">修改多台機器的密碼<a href="https://ouch1978.github.io/blog/2022/09/14/change-windows-local-admin-password-remotely#%E4%BF%AE%E6%94%B9%E5%A4%9A%E5%8F%B0%E6%A9%9F%E5%99%A8%E7%9A%84%E5%AF%86%E7%A2%BC" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h3>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="用逗號分隔多台機器">用逗號分隔多台機器<a href="https://ouch1978.github.io/blog/2022/09/14/change-windows-local-admin-password-remotely#%E7%94%A8%E9%80%97%E8%99%9F%E5%88%86%E9%9A%94%E5%A4%9A%E5%8F%B0%E6%A9%9F%E5%99%A8" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h4>
<p>如果需要改多台的話，可以用逗號分隔多台電腦的名稱或是 IP，例如：</p>
<div class="language-powershell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-powershell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">pspasswd \\192.168.173.101,\\192.168.173.102,\\192.168.173.103 -u ouch1978 -p ILoveOuch1978 Administrator MyNewPassword</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="複製程式碼到剪貼簿" title="複製" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="使用機器清單檔">使用機器清單檔<a href="https://ouch1978.github.io/blog/2022/09/14/change-windows-local-admin-password-remotely#%E4%BD%BF%E7%94%A8%E6%A9%9F%E5%99%A8%E6%B8%85%E5%96%AE%E6%AA%94" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h4>
<p>我們也可以把所有的機器名稱或 IP 放到一個文字檔裡，再把它餵給 PsPasswd.exe，例如：</p>
<div class="language-plain codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-plain codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">192.168.173.101</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">192.168.173.102</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">192.168.173.103</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">MyWindows11</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="複製程式碼到剪貼簿" title="複製" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>然後執行：</p>
<div class="language-powershell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-powershell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">pspasswd @C:\ServerList.txt -u ouch1978 -p ILoveOuch1978 Administrator MyNewPassword</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="複製程式碼到剪貼簿" title="複製" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>就可以一次針對 ServerList.txt 裡面包含的所有電腦進行修改。</p>
<div class="theme-admonition theme-admonition-tip admonition_xJq3 alert alert--success"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 12 16"><path fill-rule="evenodd" d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"></path></svg></span>小提示</div><div class="admonitionContent_BuS1"><p>清單檔裡面的每筆機器名稱或 IP 前面都不用加上 <code>\\</code>。</p></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="修改整個網域所有機器的密碼">修改整個網域所有機器的密碼<a href="https://ouch1978.github.io/blog/2022/09/14/change-windows-local-admin-password-remotely#%E4%BF%AE%E6%94%B9%E6%95%B4%E5%80%8B%E7%B6%B2%E5%9F%9F%E6%89%80%E6%9C%89%E6%A9%9F%E5%99%A8%E7%9A%84%E5%AF%86%E7%A2%BC" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h3>
<p>如果需要一次針對整個網域中所有電腦進行修改的話，可以使用萬用字元來達成目的：</p>
<div class="language-powershell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-powershell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">pspasswd \\* -u ouch1978 -p ILoveOuch1978 Administrator MyNewPassword</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="複製程式碼到剪貼簿" title="複製" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<div class="theme-admonition theme-admonition-danger admonition_xJq3 alert alert--danger"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 12 16"><path fill-rule="evenodd" d="M5.05.31c.81 2.17.41 3.38-.52 4.31C3.55 5.67 1.98 6.45.9 7.98c-1.45 2.05-1.7 6.53 3.53 7.7-2.2-1.16-2.67-4.52-.3-6.61-.61 2.03.53 3.33 1.94 2.86 1.39-.47 2.3.53 2.27 1.67-.02.78-.31 1.44-1.13 1.81 3.42-.59 4.78-3.42 4.78-5.56 0-2.84-2.53-3.22-1.25-5.61-1.52.13-2.03 1.13-1.89 2.75.09 1.08-1.02 1.8-1.86 1.33-.67-.41-.66-1.19-.06-1.78C8.18 5.31 8.68 2.45 5.05.32L5.03.3l.02.01z"></path></svg></span>警告</div><div class="admonitionContent_BuS1"><p>修改整個網域中所有電腦的密碼是一件非常具有風險的行為，請務必重複確認自己知道自己在幹嘛再送出指令。</p></div></div>
<p>以上。</p>]]></content>
        <author>
            <name>Ouch Liu</name>
            <uri>https://github.com/ouch1978</uri>
        </author>
        <category label="Windows" term="Windows"/>
        <category label="小技巧" term="小技巧"/>
        <category label="PsTools" term="PsTools"/>
    </entry>
    <entry>
        <title type="html"><![CDATA[修復 Windows 11 開始功能表右鍵選單消失的問題]]></title>
        <id>https://ouch1978.github.io/blog/2022/09/01/fix-windows-11-missing-context-menu-on-start-button</id>
        <link href="https://ouch1978.github.io/blog/2022/09/01/fix-windows-11-missing-context-menu-on-start-button"/>
        <updated>2022-09-01T00:00:00.000Z</updated>
        <summary type="html"><![CDATA[昨天安裝了 Windows 11 更新重新開機之後，用著用著，就覺得哪裡怪怪的，在開始功能表上按下右鍵時完全沒有反應。本來以為是滑鼠右鍵壞了，但是在桌面上或是檔案總管按滑鼠右鍵又可以正常叫出右鍵選單。上網 Google 了一下，發現原來我並不孤單，還有不少人也遇過相同的狀況。參考了一下別人的解法，一個一個試，總算讓我在試到第三個方法的時候成功把它救回來了。這邊就來紀錄一下我試過的方法有哪些。]]></summary>
        <content type="html"><![CDATA[<h2 class="anchor anchorWithStickyNavbar_LWe7" id="前言">前言<a href="https://ouch1978.github.io/blog/2022/09/01/fix-windows-11-missing-context-menu-on-start-button#%E5%89%8D%E8%A8%80" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h2>
<p>昨天安裝了 Windows 11 更新重新開機之後，用著用著，就覺得哪裡怪怪的，在開始功能表上按下右鍵時完全沒有反應。</p>
<p>本來以為是滑鼠右鍵壞了，但是在桌面上或是檔案總管按滑鼠右鍵又可以正常叫出右鍵選單。</p>
<p>上網 Google 了一下，發現原來我並不孤單，還有不少人也遇過相同的狀況。</p>
<p>參考了一下別人的解法，一個一個試，總算讓我在試到第三個方法的時候成功把它救回來了。</p>
<p>這邊就來紀錄一下我試過的方法有哪些。</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="解決過程">解決過程<a href="https://ouch1978.github.io/blog/2022/09/01/fix-windows-11-missing-context-menu-on-start-button#%E8%A7%A3%E6%B1%BA%E9%81%8E%E7%A8%8B" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h2>
<p>先說結論，結果我是一直作到 <a href="https://ouch1978.github.io/blog/2022/09/01/fix-windows-11-missing-context-menu-on-start-button#%E6%96%B9%E6%B3%95%E4%B8%89%E9%80%8F%E9%81%8E%E7%99%BB%E9%8C%84%E6%AA%94%E4%BF%AE%E5%BE%A9">方法三：透過登錄檔修復</a> 才成功解決的。</p>
<p>遇到相同狀況的朋友，不妨直接試第三個方法，看看能不能一次就解決。</p>
<p>以下就依照我試過的方法先後順序分享。</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="方法一重啟檔案總管">方法一：重啟檔案總管<a href="https://ouch1978.github.io/blog/2022/09/01/fix-windows-11-missing-context-menu-on-start-button#%E6%96%B9%E6%B3%95%E4%B8%80%E9%87%8D%E5%95%9F%E6%AA%94%E6%A1%88%E7%B8%BD%E7%AE%A1" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h3>
<p>按下鍵盤的 <kbd>Ctrl</kbd> + <kbd>Shift</kbd> + <kbd>Esc</kbd> 叫出工作管理員，點選左下角的更多詳細資料之後，找到檔案總管並且按下右下角的<code>重新啟動</code>按鈕。</p>
<p><img loading="lazy" alt="重啟檔案總管" src="https://ouch1978.github.io/assets/images/restart-windows-file-explorer-aa0cd0aba86566412298929ca6c9359e.png" title="重啟檔案總管" width="1002" height="891" class="img_ev3q"></p>
<p>嗯... 沒效!! 下面一位~</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="方法二複製-winx-資料夾">方法二：複製 WinX 資料夾<a href="https://ouch1978.github.io/blog/2022/09/01/fix-windows-11-missing-context-menu-on-start-button#%E6%96%B9%E6%B3%95%E4%BA%8C%E8%A4%87%E8%A3%BD-winx-%E8%B3%87%E6%96%99%E5%A4%BE" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h3>
<p>複製 <code>C:\Users\Default\AppData\Local\Microsoft\Windows\WinX</code> 資料夾。</p>
<p><img loading="lazy" alt="複製 WinX 資料夾" src="https://ouch1978.github.io/assets/images/copy-winx-folder-4b6ca093214004ceadc738b2e12f9a75.png" title="複製 WinX 資料夾" width="1691" height="1035" class="img_ev3q"></p>
<p>然後把複製的內容貼到 <code>%AppData%\..\Local\Microsoft\Windows\</code> 下。</p>
<p><img loading="lazy" alt="貼上到使用者資料夾" src="https://ouch1978.github.io/assets/images/paste-to-corresponding-folder-under-user-folder-c1999861f07c08663a7a13b1e9decd2c.png" title="貼上到使用者資料夾" width="1691" height="1035" class="img_ev3q"></p>
<p>然後透過 <a href="https://ouch1978.github.io/blog/2022/09/01/fix-windows-11-missing-context-menu-on-start-button#%E6%96%B9%E6%B3%95%E4%B8%80%E9%87%8D%E5%95%9F%E6%AA%94%E6%A1%88%E7%B8%BD%E7%AE%A1">方法一</a> 的步驟來重啟檔案總管。</p>
<p>嗯... 還是沒效，無三不成禮就對了。</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="方法三透過登錄檔修復">方法三：透過登錄檔修復<a href="https://ouch1978.github.io/blog/2022/09/01/fix-windows-11-missing-context-menu-on-start-button#%E6%96%B9%E6%B3%95%E4%B8%89%E9%80%8F%E9%81%8E%E7%99%BB%E9%8C%84%E6%AA%94%E4%BF%AE%E5%BE%A9" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h3>
<p>下載 <a target="_blank" title="修復 Windows 11 開始功能表右鍵選單消失登錄檔壓縮包" href="https://ouch1978.github.io/assets/files/%E4%BF%AE%E5%BE%A9%20Windows%2011%20%E9%96%8B%E5%A7%8B%E5%8A%9F%E8%83%BD%E8%A1%A8%E5%8F%B3%E9%8D%B5%E9%81%B8%E5%96%AE%E6%B6%88%E5%A4%B1%E7%99%BB%E9%8C%84%E6%AA%94-d59d112fef8a2df06269ec78b6c13409.zip">修復 Windows 11 開始功能表右鍵選單消失登錄檔壓縮包</a> 之後解壓縮。</p>
<p>然後以滑鼠雙擊執行裡面的 <code>fix-windows-11-missing-context-menu-on-start-button.reg</code> 檔。</p>
<p>最後再透過 <a href="https://ouch1978.github.io/blog/2022/09/01/fix-windows-11-missing-context-menu-on-start-button#%E6%96%B9%E6%B3%95%E4%B8%80%E9%87%8D%E5%95%9F%E6%AA%94%E6%A1%88%E7%B8%BD%E7%AE%A1">方法一</a> 的步驟來重啟檔案總管。</p>
<p>如果你運氣沒有比我差的話，應該就可以看到開始功能表的右鍵選單回來啦!!</p>]]></content>
        <author>
            <name>Ouch Liu</name>
            <uri>https://github.com/ouch1978</uri>
        </author>
        <category label="Windows 11" term="Windows 11"/>
        <category label="疑難排解" term="疑難排解"/>
    </entry>
    <entry>
        <title type="html"><![CDATA[移除 Windows 10/Windows 11 桌面捷徑上的箭頭圖示]]></title>
        <id>https://ouch1978.github.io/blog/2022/08/29/remove-windows-10-shortcut-arrow-on-desktop-icon</id>
        <link href="https://ouch1978.github.io/blog/2022/08/29/remove-windows-10-shortcut-arrow-on-desktop-icon"/>
        <updated>2022-08-29T00:00:00.000Z</updated>
        <summary type="html"><![CDATA[每次重灌 Windows 時或是拿到新電腦時，對於桌面捷徑上的小箭頭圖示一直都很反感，每次都要先消滅那些箭頭才會覺得可以繼續工作。不過，有的時候照著網路上的作法可能當下有效，重新開機或是過沒多久那個可惡的箭頭就又復活了。特別來寫一篇文章來記錄一下我目前試過最有效的方法。]]></summary>
        <content type="html"><![CDATA[<h2 class="anchor anchorWithStickyNavbar_LWe7" id="前言">前言<a href="https://ouch1978.github.io/blog/2022/08/29/remove-windows-10-shortcut-arrow-on-desktop-icon#%E5%89%8D%E8%A8%80" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h2>
<p>每次重灌 Windows 時或是拿到新電腦時，對於桌面捷徑上的小箭頭圖示一直都很反感，每次都要先消滅那些箭頭才會覺得可以繼續工作。</p>
<p>不過，有的時候照著網路上的作法可能當下有效，重新開機或是過沒多久那個可惡的箭頭就又復活了。</p>
<p>特別來寫一篇文章來記錄一下我目前試過最有效的方法。</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="去去箭頭走">去去，箭頭走<a href="https://ouch1978.github.io/blog/2022/08/29/remove-windows-10-shortcut-arrow-on-desktop-icon#%E5%8E%BB%E5%8E%BB%E7%AE%AD%E9%A0%AD%E8%B5%B0" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h2>
<p>廢話不多說，來消滅箭頭吧!!</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="透過手動的方式修改登錄檔">透過手動的方式修改登錄檔<a href="https://ouch1978.github.io/blog/2022/08/29/remove-windows-10-shortcut-arrow-on-desktop-icon#%E9%80%8F%E9%81%8E%E6%89%8B%E5%8B%95%E7%9A%84%E6%96%B9%E5%BC%8F%E4%BF%AE%E6%94%B9%E7%99%BB%E9%8C%84%E6%AA%94" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h3>
<p>網路上比較常見的作法應該是把透過調整登錄檔，把圖示改成 Windows 內建在 shell32.dll 中的空白圖示(<code>%windir%\System32\shell32.dll,-50</code>)。</p>
<p>但是我實測過幾台電腦之後，發現這個方法在某些不明的狀況下會失效。</p>
<p>比較有效的方法是直接把它改成實體的空白圖示檔，作法如下：</p>
<ol>
<li>
<p>請先按滑鼠右鍵另存新檔下載 <a target="_blank" title="移除捷徑箭頭壓縮包" href="https://ouch1978.github.io/assets/files/%E7%A7%BB%E9%99%A4%E6%8D%B7%E5%BE%91%E7%AE%AD%E9%A0%AD-ee9da513ad382fb642d0205e2e2cf4c5.zip">移除捷徑箭頭壓縮包</a>，然後解壓縮。</p>
</li>
<li>
<p>把解壓縮之後的空白圖示(<code>blank.ico</code>)放到 C:\Windows 下，確保完整路徑為 <code>C:\Windows\blank.ico</code>。</p>
<div class="theme-admonition theme-admonition-tip admonition_xJq3 alert alert--success"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 12 16"><path fill-rule="evenodd" d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"></path></svg></span>小提示</div><div class="admonitionContent_BuS1"><p>如果空白圖示儲存的位置不是 C:\Windows 的話，請自行調整移除捷徑箭頭登錄檔的內容，將路徑和檔名調整為修改後的值。</p></div></div>
</li>
<li>
<p>以滑鼠雙擊執行 <code>移除捷徑箭頭.reg</code>。</p>
</li>
<li>
<p>按下鍵盤的 <kbd>Ctrl</kbd> + <kbd>Shift</kbd> + <kbd>Esc</kbd> 叫出工作管理員，並且重新啟動檔案總管。</p>
<p><img loading="lazy" alt="重啟檔案總管" src="https://ouch1978.github.io/assets/images/restart-windows-file-explorer-0c433798ce5bdc72d5088b46d745a492.png" title="重啟檔案總管" width="1002" height="891" class="img_ev3q"></p>
</li>
</ol>
<p>如果要還原這個設定，讓箭頭回來的話，只需要雙擊執行 <code>還原捷徑箭頭.reg</code> ，然後一樣重新啟動檔案總管即可。</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="透過現成的-windows-調整小工具">透過現成的 Windows 調整小工具<a href="https://ouch1978.github.io/blog/2022/08/29/remove-windows-10-shortcut-arrow-on-desktop-icon#%E9%80%8F%E9%81%8E%E7%8F%BE%E6%88%90%E7%9A%84-windows-%E8%AA%BF%E6%95%B4%E5%B0%8F%E5%B7%A5%E5%85%B7" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h3>
<p>網路上應該能找到不少用來移除捷徑箭頭的小工具。</p>
<p>不過我比較習慣使用的是 <a href="https://winaerotweaker.com/#download/" target="_blank" rel="noopener noreferrer" title="下載 Winaero Tweaker">Winaero Tweaker</a> ，它除了移除箭頭小圖示之外，還有不少其它的功能。</p>
<p>下載安裝之後，開啟它的執行檔，會先出現使用者授權提示畫面，這邊就直接按下同意就好。</p>
<p><img loading="lazy" alt="同意授權" src="https://ouch1978.github.io/assets/images/agree-winaero-tweaker-eula-b6c1fd2c89c74dc047f9151c1b4cfa20.png" title="同意授權" width="1180" height="789" class="img_ev3q"></p>
<p>接著在搜尋框中輸入 <code>arrow</code>，就可以快速找到修改捷徑箭頭的功能，然後以滑鼠雙擊 'Shortcuts \Shortcut Arrow'。</p>
<p><img loading="lazy" alt="在搜尋框輸入 arrow 來快速找到修改捷徑箭頭的功能" src="https://ouch1978.github.io/assets/images/enter-arrow-to-find-change-shortcut-arrow-function-dc3a150259a7ba038b8c3fa708835ed0.png" title="在搜尋框輸入 arrow 來快速找到修改捷徑箭頭的功能" width="1350" height="819" class="img_ev3q"></p>
<p>接著依序點選 'No Arrow' 和左下角的 'Restart Explorer'，就大功告成啦!!</p>
<p><img loading="lazy" alt="依序點選 No Arrow 和左下角的 Restart Explorer" src="https://ouch1978.github.io/assets/images/select-no-arrow-and-click-restart-explorer-94ecf3372c8983f7f25e1121dc8a3b13.png" title="依序點選 No Arrow 和左下角的 Restart Explorer" width="1350" height="819" class="img_ev3q"></p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="碎碎唸">碎碎唸<a href="https://ouch1978.github.io/blog/2022/08/29/remove-windows-10-shortcut-arrow-on-desktop-icon#%E7%A2%8E%E7%A2%8E%E5%94%B8" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h2>
<p>相信應該會有不少人跟我一樣不喜歡那個箭頭，所以才會有不只一種可以把它移除的工具出現。</p>
<p>不過，我也不懂為什麼微軟一直要把這個功能留著，而且不把它改成是可以設定的選項，如果有朋友知道原因的話，不妨在下面留言跟大家分享一下。</p>
<p>還有還有，如果有朋友有找到更簡單的方法的話，也請不吝跟大家分享喔!!</p>]]></content>
        <author>
            <name>Ouch Liu</name>
            <uri>https://github.com/ouch1978</uri>
        </author>
        <category label="Windows 10" term="Windows 10"/>
        <category label="Windows 11" term="Windows 11"/>
        <category label="小技巧" term="小技巧"/>
    </entry>
</feed>