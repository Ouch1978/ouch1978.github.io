"use strict";(self.webpackChunkouch1978_at_github=self.webpackChunkouch1978_at_github||[]).push([[8405],{40211:(e,i,t)=>{t.r(i),t.d(i,{assets:()=>u,contentTitle:()=>l,default:()=>c,frontMatter:()=>o,metadata:()=>r,toc:()=>a});var n=t(74848),s=t(28453);const o={title:"\u89e3\u6c7a Visual Studio 2017 \u5728\u6709\u624b\u5beb\u7b46\u7684\u88dd\u7f6e\u4e0a\u6c92\u6709\u56de\u61c9\u53ca\u91cd\u555f\u7684\u554f\u984c",description:"\u9019\u6b21\u91cd\u704c\u5b8c\u96fb\u8166\uff0c\u4e26\u4e14\u5b89\u88dd\u597d\u4e86 Visual Studio 2017 \u4e4b\u5f8c\uff0c\u4e00\u76f4\u6c92\u4ec0\u9ebc\u6642\u9593\u628a\u5b83\u6253\u958b\u4f86\u52d5\u624b\u5beb\u7a0b\u5f0f\u3002 \u6628\u5929\u7d22\u6027\u6253\u958b\u4f86\u66f4\u65b0\u5230\u6700\u65b0\u7684\u7248\u672c\u4e4b\u5f8c\uff0c\u96a8\u4fbf\u958b\u4e86\u4e00\u500b\u4e4b\u524d\u5beb\u597d\u73a9\u7684\u5c08\u6848\u60f3\u8aaa\u4f86\u8dd1\u770b\u770b\uff0c\u7d50\u679c\u4e00\u958b\u6c92\u591a\u4e45\uff0cVisual Studio \u99ac\u4e0a\u6c92\u6709\u56de\u61c9\uff0c\u518d\u904e\u6c92\u591a\u4e45\uff0c\u5c31\u76f4\u63a5\u5d29\u6f70\u91cd\u958b\u4e86\u3002",authors:"ouch1978",tags:["Visual Studio","Trouble Shooting"],keywords:["Visual Studio 2017","PenIMC_v0400.dll"]},l=void 0,r={permalink:"/blog/2017/08/29/fix-visual-studio-2017-crash-on-pen-enabled-devices",editUrl:"https://github.com/ouch1978/ouch1978.github.io/edit/main/blog/2017-08-29-fix-visual-studio-2017-crash-on-pen-enabled-devices/index.md",source:"@site/blog/2017-08-29-fix-visual-studio-2017-crash-on-pen-enabled-devices/index.md",title:"\u89e3\u6c7a Visual Studio 2017 \u5728\u6709\u624b\u5beb\u7b46\u7684\u88dd\u7f6e\u4e0a\u6c92\u6709\u56de\u61c9\u53ca\u91cd\u555f\u7684\u554f\u984c",description:"\u9019\u6b21\u91cd\u704c\u5b8c\u96fb\u8166\uff0c\u4e26\u4e14\u5b89\u88dd\u597d\u4e86 Visual Studio 2017 \u4e4b\u5f8c\uff0c\u4e00\u76f4\u6c92\u4ec0\u9ebc\u6642\u9593\u628a\u5b83\u6253\u958b\u4f86\u52d5\u624b\u5beb\u7a0b\u5f0f\u3002 \u6628\u5929\u7d22\u6027\u6253\u958b\u4f86\u66f4\u65b0\u5230\u6700\u65b0\u7684\u7248\u672c\u4e4b\u5f8c\uff0c\u96a8\u4fbf\u958b\u4e86\u4e00\u500b\u4e4b\u524d\u5beb\u597d\u73a9\u7684\u5c08\u6848\u60f3\u8aaa\u4f86\u8dd1\u770b\u770b\uff0c\u7d50\u679c\u4e00\u958b\u6c92\u591a\u4e45\uff0cVisual Studio \u99ac\u4e0a\u6c92\u6709\u56de\u61c9\uff0c\u518d\u904e\u6c92\u591a\u4e45\uff0c\u5c31\u76f4\u63a5\u5d29\u6f70\u91cd\u958b\u4e86\u3002",date:"2017-08-29T00:00:00.000Z",tags:[{label:"Visual Studio",permalink:"/blog/tags/visual-studio"},{label:"Trouble Shooting",permalink:"/blog/tags/trouble-shooting"}],readingTime:2.47,hasTruncateMarker:!0,authors:[{name:"Ouch Liu",title:"\u4e0d\u52d9\u6b63\u696d\u7684\u67b6\u69cb\u5e2b",url:"https://github.com/ouch1978",imageURL:"https://avatars.githubusercontent.com/u/18132883?v=4",key:"ouch1978"}],frontMatter:{title:"\u89e3\u6c7a Visual Studio 2017 \u5728\u6709\u624b\u5beb\u7b46\u7684\u88dd\u7f6e\u4e0a\u6c92\u6709\u56de\u61c9\u53ca\u91cd\u555f\u7684\u554f\u984c",description:"\u9019\u6b21\u91cd\u704c\u5b8c\u96fb\u8166\uff0c\u4e26\u4e14\u5b89\u88dd\u597d\u4e86 Visual Studio 2017 \u4e4b\u5f8c\uff0c\u4e00\u76f4\u6c92\u4ec0\u9ebc\u6642\u9593\u628a\u5b83\u6253\u958b\u4f86\u52d5\u624b\u5beb\u7a0b\u5f0f\u3002 \u6628\u5929\u7d22\u6027\u6253\u958b\u4f86\u66f4\u65b0\u5230\u6700\u65b0\u7684\u7248\u672c\u4e4b\u5f8c\uff0c\u96a8\u4fbf\u958b\u4e86\u4e00\u500b\u4e4b\u524d\u5beb\u597d\u73a9\u7684\u5c08\u6848\u60f3\u8aaa\u4f86\u8dd1\u770b\u770b\uff0c\u7d50\u679c\u4e00\u958b\u6c92\u591a\u4e45\uff0cVisual Studio \u99ac\u4e0a\u6c92\u6709\u56de\u61c9\uff0c\u518d\u904e\u6c92\u591a\u4e45\uff0c\u5c31\u76f4\u63a5\u5d29\u6f70\u91cd\u958b\u4e86\u3002",authors:"ouch1978",tags:["Visual Studio","Trouble Shooting"],keywords:["Visual Studio 2017","PenIMC_v0400.dll"]},unlisted:!1,prevItem:{title:"\u900f\u904e Xamarin.Forms \u4f86\u73a9\u73a9\u50b3\u8aaa\u4e2d\u7684 XAML Standard (preview) \u5427!!",permalink:"/blog/2018/01/08/xaml-standard-preview-in-xamarin-forms"},nextItem:{title:"\u89e3\u6c7a Visual Studio 2017 \u9996\u6b21\u57f7\u884c\u6642\u5361\u5728 We are getting things ready \u7684\u554f\u984c",permalink:"/blog/2017/08/15/fix-visual-studio-2017-first-launch-stucking"}},u={authorsImageUrls:[void 0]},a=[{value:"\u524d\u8a00",id:"\u524d\u8a00",level:2},{value:"\u89e3\u6cd5",id:"\u89e3\u6cd5",level:2}];function d(e){const i={a:"a",code:"code",h2:"h2",img:"img",li:"li",ol:"ol",p:"p",pre:"pre",...(0,s.R)(),...e.components};return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(i.h2,{id:"\u524d\u8a00",children:"\u524d\u8a00"}),"\n",(0,n.jsx)(i.p,{children:"\u9019\u6b21\u91cd\u704c\u5b8c\u96fb\u8166\uff0c\u4e26\u4e14\u5b89\u88dd\u597d\u4e86 Visual Studio 2017 \u4e4b\u5f8c\uff0c\u4e00\u76f4\u6c92\u4ec0\u9ebc\u6642\u9593\u628a\u5b83\u6253\u958b\u4f86\u52d5\u624b\u5beb\u7a0b\u5f0f\u3002"}),"\n",(0,n.jsx)(i.p,{children:"\u6628\u5929\u7d22\u6027\u6253\u958b\u4f86\u66f4\u65b0\u5230\u6700\u65b0\u7684\u7248\u672c\u4e4b\u5f8c\uff0c\u96a8\u4fbf\u958b\u4e86\u4e00\u500b\u4e4b\u524d\u5beb\u597d\u73a9\u7684\u5c08\u6848\u60f3\u8aaa\u4f86\u8dd1\u770b\u770b\uff0c\u7d50\u679c\u4e00\u958b\u6c92\u591a\u4e45\uff0cVisual Studio \u99ac\u4e0a\u6c92\u6709\u56de\u61c9\uff0c\u518d\u904e\u6c92\u591a\u4e45\uff0c\u5c31\u76f4\u63a5\u5d29\u6f70\u91cd\u958b\u4e86\u3002"}),"\n",(0,n.jsx)(i.p,{children:'![image-01] (01-visual-studio-2017-is-restarting.png "Visual Studio 2017 \u91cd\u8907\u81ea\u52d5\u91cd\u555f")'}),"\n",(0,n.jsx)(i.p,{children:"\u5230 Windows \u4e8b\u4ef6\u6aa2\u8996\u5668\u4e00\u770b\uff0c\u767c\u73fe\u932f\u8aa4\u539f\u56e0\u5982\u4e0b\uff1a"}),"\n",(0,n.jsx)(i.p,{children:'![image-02] (02-error-log-in-event-viewer.png "Windows \u4e8b\u4ef6\u6aa2\u8996\u5668\u4e2d\u986f\u793a\u7684\u932f\u8aa4\u8a0a\u606f")'}),"\n",(0,n.jsxs)(i.p,{children:["\u4f7f\u7528\u95dc\u9375\u5b57 ",(0,n.jsx)(i.code,{children:"PenIMC_v0400.dll"})," \u4e00\u67e5\uff0c\u770b\u8d77\u4f86\u597d\u50cf\u8ddf\u624b\u5beb\u7b46\u6709\u95dc\u4fc2\uff0c\u800c\u4e14",(0,n.jsx)(i.a,{href:"https://developercommunity.visualstudio.com/content/problem/55303/visual-studio-may-terminate-unexpectedly-when-runn.html",title:"Visual Studio may freeze or crash when running on a pen-enabled machine",children:"\u770b\u8d77\u4f86\u6709\u4e0d\u5c11\u4eba"}),"\u8ddf\u6211\u4e00\u6a23\u4e2d\u62db..."]}),"\n",(0,n.jsx)(i.h2,{id:"\u89e3\u6cd5",children:"\u89e3\u6cd5"}),"\n",(0,n.jsx)(i.p,{children:"\u7c21\u55ae\u7684\u8aaa\uff0c\u89e3\u6cd5\u6709\u5169\u7a2e\uff0c\u4e00\u7a2e\u662f\u900f\u904e Windows Update \u5b89\u88dd KB4022716 (15063.447)\u9019\u500b\u66f4\u65b0\u5305\uff1b\u4f46\u662f\u5f88\u795e\u5947\u7684\uff0c\u6211\u7684\u96fb\u8166\u8dd1\u7684\u660e\u660e\u5c31\u662f 15063.502 \u7248\uff0c\u537b\u9084\u662f\u4e00\u6a23\u4e2d\u62db\u554a..."}),"\n",(0,n.jsx)(i.p,{children:(0,n.jsx)(i.img,{alt:"image-03",src:t(4888).A+"",title:"\u6211\u7684\u96fb\u8166\u5df2\u7d93\u662f 15063.502\u7248",width:"841",height:"636"})}),"\n",(0,n.jsx)(i.p,{children:"\u6240\u4ee5\u53ea\u80fd\u8a66\u770b\u770b\u53e6\u4e00\u7a2e\u65b9\u5f0f\uff0c\u4e5f\u5c31\u662f\u81ea\u5df1\u624b\u52d5\u4fee\u6539 Visual Studio 2017 \u7684\u8a2d\u5b9a\u6a94\uff0c\u628a Visual Studio 2017 \u5c0d\u89f8\u63a7\u548c\u624b\u5beb\u7b46\u7684\u652f\u63f4\u76f8\u95dc\u529f\u80fd\u95dc\u6389(\u9019\u500b\u6bd4\u8f03\u50cf\u662f Workaround\uff0c\u800c\u4e14\u7b49\u5fae\u8edf\u4e4b\u5f8c\u91cb\u51fa\u76f8\u95dc\u4fee\u6b63\u6a94\u4e4b\u5f8c\uff0c\u5f97\u8981\u8a18\u5f97\u628a\u5b83\u6539\u56de\u4f86)\u3002"}),"\n",(0,n.jsx)(i.p,{children:"\u5177\u9ad4\u7684\u4f5c\u6cd5\u5982\u4e0b\uff1a"}),"\n",(0,n.jsxs)(i.ol,{children:["\n",(0,n.jsxs)(i.li,{children:["\n",(0,n.jsx)(i.p,{children:"\u627e\u5230 Visual Studio 2017 \u7684\u57f7\u884c\u6a94\u8def\u5f91\uff0c\u5982 C:\\Program Files (x86)\\Microsoft Visual Studio\\2017\\Enterprise\\Common7\\IDE\u3002"}),"\n"]}),"\n",(0,n.jsxs)(i.li,{children:["\n",(0,n.jsxs)(i.p,{children:["\u4f7f\u7528\u6587\u5b57\u7de8\u8f2f\u5de5\u5177\u958b\u555f ",(0,n.jsx)(i.code,{children:"devenv.exe.config"})," \u6a94(\u8a18\u5f97\u4f7f\u7528 Administrator \u6b0a\u9650\u958b\uff0c\u5426\u5247\u53ef\u80fd\u6703\u7121\u6cd5\u5b58\u6a94\u5594)\u3002"]}),"\n"]}),"\n",(0,n.jsxs)(i.li,{children:["\n",(0,n.jsxs)(i.p,{children:["\u627e\u5230 ",(0,n.jsx)(i.code,{children:"AppContextSwitchOverrides"}),' \u76f8\u95dc\u8a2d\u5b9a\uff0c\u4e26\u4e14\u52a0\u5165 "',(0,n.jsx)(i.code,{children:"Switch.System.Windows.Input.Stylus.DisableStylusAndTouchSupport=true"}),'"\u3002']}),"\n"]}),"\n"]}),"\n",(0,n.jsx)(i.p,{children:"\u4f9d\u7167\u6211\u81ea\u5df1\u7684\u4f8b\u5b50\uff0c\u6539\u5b8c\u4e4b\u5f8c AppContextSwitchOverrides \u9019\u4e00\u6bb5\u6703\u8b8a\u6210\u4e0b\u9762\u9019\u6a23"}),"\n",(0,n.jsx)(i.pre,{children:(0,n.jsx)(i.code,{className:"language-xml",metastring:'title="devenv.exe.config"',children:'\n    <AppContextSwitchOverrides value="Switch.System.Threading.ThrowExceptionIfDisposedCancellationTokenSource=false;Switch.System.Windows.Forms.DoNotSupportSelectAllShortcutInMultilineTextBox=false;Switch.UseLegacyAccessibilityFeatures=false;Switch.System.Windows.Input.Stylus.DisableStylusAndTouchSupport=true" />\n\n'})}),"\n",(0,n.jsx)(i.p,{children:"\u624b\u52d5\u628a\u89f8\u63a7\u548c\u624b\u5beb\u652f\u63f4\u95dc\u6389\u4e4b\u5f8c\uff0c\u76ee\u524d\u89c0\u67e5\u4e86\u534a\u5929\uff0c\u9084\u6c92\u6709\u51fa\u73fe\u81ea\u52d5\u91cd\u555f\u7684\u554f\u984c\u3002"}),"\n",(0,n.jsx)(i.p,{children:"\u4ee5\u4e0a\uff0c\u5e0c\u671b\u53ef\u4ee5\u5e6b\u52a9\u5230\u8ddf\u6211\u9047\u5230\u76f8\u540c\u72c0\u6cc1\u7684\u82e6\u4e3b\u3002"})]})}function c(e={}){const{wrapper:i}={...(0,s.R)(),...e.components};return i?(0,n.jsx)(i,{...e,children:(0,n.jsx)(d,{...e})}):d(e)}},4888:(e,i,t)=>{t.d(i,{A:()=>n});const n=t.p+"assets/images/03-my-pc-is-running-15063.502-6c9708d043eae21bdb6a311e9a55be79.png"},28453:(e,i,t)=>{t.d(i,{R:()=>l,x:()=>r});var n=t(96540);const s={},o=n.createContext(s);function l(e){const i=n.useContext(o);return n.useMemo((function(){return"function"==typeof e?e(i):{...i,...e}}),[i,e])}function r(e){let i;return i=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:l(e.components),n.createElement(o.Provider,{value:i},e.children)}}}]);