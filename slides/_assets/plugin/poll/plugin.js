window.RevealPoll=window.RevealPoll||{id:"RevealPoll",init:function(e){initPoll(e)}};const initPoll=function(e){e.getConfig().poll;var t=[];function n(e,t){var n=new CustomEvent("send");n.content={sender:"poll-plugin",recipient:!0,type:"vote",poll:e,choice:t},document.dispatchEvent(n)}return document.addEventListener("received",(function(e){if(e.content&&"poll-plugin"==e.content.sender)if("vote"==e.content.type){const n=e.content,o=t[(s=e.content.poll,t.findIndex((e=>e.id===s)))];o.voters++,(e=new CustomEvent("broadcast")).content={sender:"poll-plugin",copy:!0,type:"voters",poll:o.id,voters:o.voters},document.dispatchEvent(e),o.votes[n.choice]++,(e=new CustomEvent("broadcast")).content={sender:"poll-plugin",copy:!0,type:"results",poll:o.id,votes:o.votes},document.dispatchEvent(e)}else if("voters"==e.content.type)for(var n=document.querySelectorAll('.voters[data-poll="'+e.content.poll+'"]'),o=0;o<n.length;o++)n[o].innerHTML=e.content.voters;else if("results"==e.content.type){for(var l=document.querySelectorAll('.results[data-poll="'+e.content.poll+'"]'),r=0;r<l.length;r++)for(var c in e.content.votes){var a=l[r].querySelectorAll('[data-value="'+c+'"]');for(o=0;o<a.length;o++)a[o].innerHTML=e.content.votes[c]}if(RevealChart){var i=document.querySelectorAll('canvas[data-chart][data-poll="'+e.content.poll+'"]'),d=[];for(var c in e.content.votes)d.push(e.content.votes[c]);for(r=0;r<i.length;r++)RevealChart.update(i[r],0,d)}}var s})),e.addEventListener("ready",(function(){!function(){for(var e=document.querySelectorAll(".poll"),o=0;o<e.length;o++){for(var l=e[o].getAttribute("data-poll"),r={},c=e[o].querySelectorAll("button"),a=0;a<c.length;a++)r[c[a].getAttribute("data-value")]=0,c[a].addEventListener("click",(function(e){if(!RevealSeminar.connected())return void alert("You are currently not connected to the live poll. Your vote is ignored.");const t=e.target,o=t.parentElement;for(var l=o.querySelectorAll("button"),r=0;r<l.length;r++)l[r].disabled=!0;n(o.getAttribute("data-poll"),t.getAttribute("data-value")),t.classList.add("selected"),t.blur()}));t.push({id:l,voters:0,votes:r})}}()})),this};